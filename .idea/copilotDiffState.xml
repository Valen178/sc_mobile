<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/DEBUG_FOTOS_POSTS.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/DEBUG_FOTOS_POSTS.md" />
              <option name="updatedContent" value="# Debug: Problema con Fotos en &quot;Todas las Publicaciones&quot;&#10;&#10;## Problema Identificado&#10;&#10;Las fotos de perfil se cargan correctamente en &quot;Mis publicaciones&quot; pero no en &quot;Todas las publicaciones&quot;.&#10;&#10;## Causa Probable&#10;&#10;El endpoint `/profile/{userId}` que se usa para obtener los perfiles de otros usuarios tiene reglas de privacidad:&#10;- **Sin interacción**: Retorna perfil limitado (pero incluye name y photo_url)&#10;- **Con interacción**: Retorna perfil completo&#10;&#10;## Logs Agregados para Debug&#10;&#10;Se han agregado logs detallados para diagnosticar el problema. Para ver los logs:&#10;&#10;### En Android Studio:&#10;&#10;1. Abre la pestaña **Logcat**&#10;2. Filtra por tag: `PostsListFragment`&#10;3. Ejecuta la app y abre &quot;Todas las publicaciones&quot;&#10;&#10;### Logs que deberías ver:&#10;&#10;```&#10;D/PostsListFragment: Iniciando carga de perfiles. Total posts: X&#10;D/PostsListFragment: IDs únicos de usuarios: [1, 2, 3, ...]&#10;D/PostsListFragment: Cargando X perfiles únicos&#10;D/PostsListFragment: Perfil cargado para usuario 1 - Name: Juan, PhotoURL: https://...&#10;D/PostsListFragment: Progreso: 1/3&#10;...&#10;D/PostsListFragment: Todos los perfiles cargados. Actualizando posts...&#10;D/PostsListFragment: Actualizando posts con perfiles. Posts: X, Perfiles en cache: Y&#10;```&#10;&#10;### Posibles Errores:&#10;&#10;#### Error 1: 401 Unauthorized&#10;```&#10;E/PostsListFragment: Error al cargar perfil de usuario X - Code: 401&#10;```&#10;**Solución:** El token está expirado o inválido&#10;&#10;#### Error 2: 403 Forbidden&#10;```&#10;E/PostsListFragment: Error al cargar perfil de usuario X - Code: 403&#10;```&#10;**Solución:** No tienes permiso para ver ese perfil&#10;&#10;#### Error 3: 404 Not Found&#10;```&#10;E/PostsListFragment: Error al cargar perfil de usuario X - Code: 404&#10;```&#10;**Solución:** El perfil no existe o el usuario no completó su perfil&#10;&#10;#### Error 4: ProfileData es null&#10;```&#10;W/PostsListFragment: ProfileData es null para usuario X&#10;```&#10;**Solución:** La respuesta no incluye el objeto profile&#10;&#10;## Soluciones Alternativas&#10;&#10;### Opción 1: Usar solo email (temporal)&#10;Si los perfiles no se pueden cargar, el sistema ya tiene un fallback:&#10;- Extrae nombre del email&#10;- Muestra icono por defecto en lugar de foto&#10;&#10;### Opción 2: Backend devuelva name y photo_url en /posts&#10;Modificar el backend para incluir estos campos directamente en el endpoint de posts.&#10;&#10;### Opción 3: Cache local de perfiles&#10;Guardar perfiles en base de datos local para acceso rápido.&#10;&#10;## Próximos Pasos&#10;&#10;1. **Ejecuta la app y revisa los logs**&#10;2. **Comparte los logs que ves en Logcat**&#10;3. **Con esa información podremos diagnosticar el problema exacto**&#10;&#10;## Comandos para ver logs por terminal&#10;&#10;Si prefieres ver logs por terminal (PowerShell):&#10;&#10;```powershell&#10;# Conectar dispositivo/emulador y ejecutar:&#10;adb logcat -s PostsListFragment:D&#10;```&#10;&#10;Esto mostrará solo los logs relacionados con la carga de perfiles.&#10;&#10;---&#10;&#10;**Fecha:** 2025-11-17&#10;**Estado:** Logs de debug agregados, esperando información del usuario&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/AndroidManifest.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/AndroidManifest.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;&#10;&#10;    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;&#10;    &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;&#10;    &lt;!-- Permiso para leer imágenes en Android 12 y versiones anteriores --&gt;&#10;    &lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot;&#10;        android:maxSdkVersion=&quot;32&quot; /&gt;&#10;    &lt;!-- Para Android 13+ se usará el picker de fotos que no requiere permiso --&gt;&#10;&#10;    &lt;application&#10;        android:allowBackup=&quot;true&quot;&#10;        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;&#10;        android:fullBackupContent=&quot;@xml/backup_rules&quot;&#10;        android:icon=&quot;@mipmap/ic_launcher&quot;&#10;        android:label=&quot;@string/app_name&quot;&#10;        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;&#10;        android:supportsRtl=&quot;true&quot;&#10;        android:usesCleartextTraffic=&quot;true&quot;&#10;        android:theme=&quot;@style/Theme.SportConnection&quot;&gt;&#10;        &lt;activity&#10;            android:name=&quot;.MainActivity&quot;&#10;            android:exported=&quot;true&quot;&gt;&#10;            &lt;intent-filter&gt;&#10;                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;&#10;&#10;                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;&#10;            &lt;/intent-filter&gt;&#10;        &lt;/activity&gt;&#10;        &lt;activity&#10;            android:name=&quot;.LoginActivity&quot;&#10;            android:exported=&quot;false&quot;&#10;            android:windowSoftInputMode=&quot;adjustPan&quot; /&gt;&#10;        &lt;activity&#10;            android:name=&quot;.RegisterActivity&quot;&#10;            android:exported=&quot;false&quot;&#10;            android:windowSoftInputMode=&quot;adjustPan&quot; /&gt;&#10;        &lt;activity&#10;            android:name=&quot;.SelectProfileActivity&quot;&#10;            android:exported=&quot;false&quot; /&gt;&#10;        &lt;activity&#10;            android:name=&quot;.ProfileFormActivity&quot;&#10;            android:exported=&quot;false&quot;&#10;            android:windowSoftInputMode=&quot;adjustPan|stateHidden&quot; /&gt;&#10;        &lt;activity&#10;            android:name=&quot;.HomeActivity&quot;&#10;            android:exported=&quot;false&quot; /&gt;&#10;        &lt;activity&#10;            android:name=&quot;.CreatePostActivity&quot;&#10;            android:exported=&quot;false&quot;&#10;            android:windowSoftInputMode=&quot;adjustPan|stateHidden&quot; /&gt;&#10;        &lt;activity&#10;            android:name=&quot;.ViewProfileActivity&quot;&#10;            android:exported=&quot;false&quot; /&gt;&#10;    &lt;/application&gt;&#10;&#10;&lt;/manifest&gt;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;&#10;&#10;    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;&#10;    &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;&#10;    &lt;!-- Permiso para leer imágenes en Android 12 y versiones anteriores --&gt;&#10;    &lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot;&#10;        android:maxSdkVersion=&quot;32&quot; /&gt;&#10;    &lt;!-- Para Android 13+ se usará el picker de fotos que no requiere permiso --&gt;&#10;&#10;    &lt;application&#10;        android:allowBackup=&quot;true&quot;&#10;        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;&#10;        android:fullBackupContent=&quot;@xml/backup_rules&quot;&#10;        android:icon=&quot;@mipmap/ic_launcher&quot;&#10;        android:label=&quot;@string/app_name&quot;&#10;        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;&#10;        android:supportsRtl=&quot;true&quot;&#10;        android:usesCleartextTraffic=&quot;true&quot;&#10;        android:theme=&quot;@style/Theme.SportConnection&quot;&gt;&#10;        &lt;activity&#10;            android:name=&quot;.MainActivity&quot;&#10;            android:exported=&quot;true&quot;&gt;&#10;            &lt;intent-filter&gt;&#10;                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;&#10;&#10;                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;&#10;            &lt;/intent-filter&gt;&#10;        &lt;/activity&gt;&#10;        &lt;activity&#10;            android:name=&quot;.LoginActivity&quot;&#10;            android:exported=&quot;false&quot;&#10;            android:windowSoftInputMode=&quot;adjustPan&quot; /&gt;&#10;        &lt;activity&#10;            android:name=&quot;.RegisterActivity&quot;&#10;            android:exported=&quot;false&quot;&#10;            android:windowSoftInputMode=&quot;adjustPan&quot; /&gt;&#10;        &lt;activity&#10;            android:name=&quot;.SelectProfileActivity&quot;&#10;            android:exported=&quot;false&quot; /&gt;&#10;        &lt;activity&#10;            android:name=&quot;.ProfileFormActivity&quot;&#10;            android:exported=&quot;false&quot;&#10;            android:windowSoftInputMode=&quot;adjustPan|stateHidden&quot; /&gt;&#10;        &lt;activity&#10;            android:name=&quot;.HomeActivity&quot;&#10;            android:exported=&quot;false&quot; /&gt;&#10;        &lt;activity&#10;            android:name=&quot;.CreatePostActivity&quot;&#10;            android:exported=&quot;false&quot;&#10;            android:windowSoftInputMode=&quot;adjustPan|stateHidden&quot; /&gt;&#10;        &lt;activity&#10;            android:name=&quot;.ViewProfileActivity&quot;&#10;            android:exported=&quot;false&quot; /&gt;&#10;    &lt;/application&gt;&#10;&#10;&lt;/manifest&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/CreatePostActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/CreatePostActivity.java" />
              <option name="originalContent" value="package com.example.sportconnection;&#10;&#10;import android.os.Bundle;&#10;import android.widget.Button;&#10;import android.widget.ImageButton;&#10;import android.widget.Toast;&#10;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;&#10;import com.example.sportconnection.model.Post;&#10;import com.example.sportconnection.repository.PostRepository;&#10;import com.example.sportconnection.utils.LoadingDialog;&#10;import com.example.sportconnection.utils.SessionManager;&#10;import com.google.android.material.textfield.TextInputEditText;&#10;&#10;public class CreatePostActivity extends AppCompatActivity {&#10;    private TextInputEditText editTextContent;&#10;    private TextInputEditText editTextUrl;&#10;    private Button btnPublish;&#10;    private ImageButton btnClose;&#10;&#10;    private PostRepository postRepository;&#10;    private SessionManager sessionManager;&#10;    private LoadingDialog loadingDialog;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_create_post);&#10;&#10;        postRepository = new PostRepository();&#10;        sessionManager = new SessionManager(this);&#10;        loadingDialog = new LoadingDialog(this);&#10;&#10;        initViews();&#10;        setupListeners();&#10;    }&#10;&#10;    private void initViews() {&#10;        editTextContent = findViewById(R.id.editTextContent);&#10;        editTextUrl = findViewById(R.id.editTextUrl);&#10;        btnPublish = findViewById(R.id.btnPublish);&#10;        btnClose = findViewById(R.id.btnClose);&#10;    }&#10;&#10;    private void setupListeners() {&#10;        btnClose.setOnClickListener(v -&gt; finish());&#10;&#10;        btnPublish.setOnClickListener(v -&gt; publishPost());&#10;&#10;        // Configurar manejo del teclado&#10;        setupKeyboardHandling();&#10;    }&#10;&#10;    private void setupKeyboardHandling() {&#10;        // Asegurar que los campos sean visibles cuando se enfocan&#10;        if (editTextContent != null) {&#10;            editTextContent.setOnFocusChangeListener((v, hasFocus) -&gt; {&#10;                if (hasFocus) {&#10;                    v.postDelayed(() -&gt; {&#10;                        v.getParent().requestChildFocus(v, v);&#10;                    }, 200);&#10;                }&#10;            });&#10;        }&#10;&#10;        if (editTextUrl != null) {&#10;            editTextUrl.setOnFocusChangeListener((v, hasFocus) -&gt; {&#10;                if (hasFocus) {&#10;                    v.postDelayed(() -&gt; {&#10;                        v.getParent().requestChildFocus(v, v);&#10;                    }, 200);&#10;                }&#10;            });&#10;        }&#10;    }&#10;&#10;    private void publishPost() {&#10;        String content = editTextContent.getText() != null ?&#10;                editTextContent.getText().toString().trim() : &quot;&quot;;&#10;        String url = editTextUrl.getText() != null ?&#10;                editTextUrl.getText().toString().trim() : &quot;&quot;;&#10;&#10;        // Validar contenido&#10;        if (content.isEmpty()) {&#10;            Toast.makeText(this, &quot;Escribe algo para publicar&quot;, Toast.LENGTH_SHORT).show();&#10;            editTextContent.requestFocus();&#10;            return;&#10;        }&#10;&#10;        // Obtener token&#10;        String token = sessionManager.getToken();&#10;        if (token == null) {&#10;            Toast.makeText(this, &quot;Debes iniciar sesión&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        // Mostrar loading&#10;        loadingDialog.show(&quot;Publicando...&quot;);&#10;        btnPublish.setEnabled(false);&#10;&#10;        // Crear post&#10;        postRepository.createPost(token, content, url.isEmpty() ? null : url,&#10;                new PostRepository.CreatePostCallback() {&#10;            @Override&#10;            public void onSuccess(Post post) {&#10;                loadingDialog.dismiss();&#10;                Toast.makeText(CreatePostActivity.this,&#10;                        &quot;Publicación creada exitosamente&quot;, Toast.LENGTH_SHORT).show();&#10;                setResult(RESULT_OK);&#10;                finish();&#10;            }&#10;&#10;            @Override&#10;            public void onError(String message) {&#10;                loadingDialog.dismiss();&#10;                btnPublish.setEnabled(true);&#10;                Toast.makeText(CreatePostActivity.this, message, Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;    }&#10;&#10;    @Override&#10;    protected void onDestroy() {&#10;        super.onDestroy();&#10;        if (loadingDialog != null) {&#10;            loadingDialog.dismiss();&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.sportconnection;&#13;&#10;&#13;&#10;import android.os.Bundle;&#13;&#10;import android.widget.Button;&#13;&#10;import android.widget.ImageButton;&#13;&#10;import android.widget.Toast;&#13;&#10;&#13;&#10;import androidx.appcompat.app.AppCompatActivity;&#13;&#10;&#13;&#10;import com.example.sportconnection.model.Post;&#13;&#10;import com.example.sportconnection.repository.PostRepository;&#13;&#10;import com.example.sportconnection.utils.LoadingDialog;&#13;&#10;import com.example.sportconnection.utils.SessionManager;&#13;&#10;import com.google.android.material.textfield.TextInputEditText;&#13;&#10;&#13;&#10;public class CreatePostActivity extends AppCompatActivity {&#13;&#10;    private TextInputEditText editTextContent;&#13;&#10;    private TextInputEditText editTextUrl;&#13;&#10;    private Button btnPublish;&#13;&#10;    private ImageButton btnClose;&#13;&#10;&#13;&#10;    private PostRepository postRepository;&#13;&#10;    private SessionManager sessionManager;&#13;&#10;    private LoadingDialog loadingDialog;&#13;&#10;&#13;&#10;    @Override&#13;&#10;    protected void onCreate(Bundle savedInstanceState) {&#13;&#10;        super.onCreate(savedInstanceState);&#13;&#10;        setContentView(R.layout.activity_create_post);&#13;&#10;&#13;&#10;        postRepository = new PostRepository();&#13;&#10;        sessionManager = new SessionManager(this);&#13;&#10;        loadingDialog = new LoadingDialog(this);&#13;&#10;&#13;&#10;        initViews();&#13;&#10;        setupListeners();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void initViews() {&#13;&#10;        editTextContent = findViewById(R.id.editTextContent);&#13;&#10;        editTextUrl = findViewById(R.id.editTextUrl);&#13;&#10;        btnPublish = findViewById(R.id.btnPublish);&#13;&#10;        btnClose = findViewById(R.id.btnClose);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void setupListeners() {&#13;&#10;        btnClose.setOnClickListener(v -&gt; finish());&#13;&#10;&#13;&#10;        btnPublish.setOnClickListener(v -&gt; publishPost());&#13;&#10;&#13;&#10;        // Configurar manejo del teclado&#13;&#10;        setupKeyboardHandling();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void setupKeyboardHandling() {&#13;&#10;        // Asegurar que los campos sean visibles cuando se enfocan&#13;&#10;        if (editTextContent != null) {&#13;&#10;            editTextContent.setOnFocusChangeListener((v, hasFocus) -&gt; {&#13;&#10;                if (hasFocus) {&#13;&#10;                    v.postDelayed(() -&gt; {&#13;&#10;                        v.getParent().requestChildFocus(v, v);&#13;&#10;                    }, 200);&#13;&#10;                }&#13;&#10;            });&#13;&#10;        }&#13;&#10;&#13;&#10;        if (editTextUrl != null) {&#13;&#10;            editTextUrl.setOnFocusChangeListener((v, hasFocus) -&gt; {&#13;&#10;                if (hasFocus) {&#13;&#10;                    v.postDelayed(() -&gt; {&#13;&#10;                        v.getParent().requestChildFocus(v, v);&#13;&#10;                    }, 200);&#13;&#10;                }&#13;&#10;            });&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void publishPost() {&#13;&#10;        String content = editTextContent.getText() != null ?&#13;&#10;                editTextContent.getText().toString().trim() : &quot;&quot;;&#13;&#10;        String url = editTextUrl.getText() != null ?&#13;&#10;                editTextUrl.getText().toString().trim() : &quot;&quot;;&#13;&#10;&#13;&#10;        // Validar contenido&#13;&#10;        if (content.isEmpty()) {&#13;&#10;            Toast.makeText(this, &quot;Escribe algo para publicar&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            editTextContent.requestFocus();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        // Obtener token&#13;&#10;        String token = sessionManager.getToken();&#13;&#10;        if (token == null) {&#13;&#10;            Toast.makeText(this, &quot;Debes iniciar sesión&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            finish();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        // Mostrar loading&#13;&#10;        loadingDialog.show(&quot;Publicando...&quot;);&#13;&#10;        btnPublish.setEnabled(false);&#13;&#10;&#13;&#10;        // Crear post&#13;&#10;        postRepository.createPost(token, content, url.isEmpty() ? null : url,&#13;&#10;                new PostRepository.CreatePostCallback() {&#13;&#10;            @Override&#13;&#10;            public void onSuccess(Post post) {&#13;&#10;                loadingDialog.dismiss();&#13;&#10;                Toast.makeText(CreatePostActivity.this,&#13;&#10;                        &quot;Publicación creada exitosamente&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                setResult(RESULT_OK);&#13;&#10;                finish();&#13;&#10;            }&#13;&#10;&#13;&#10;            @Override&#13;&#10;            public void onError(String message) {&#13;&#10;                loadingDialog.dismiss();&#13;&#10;                btnPublish.setEnabled(true);&#13;&#10;                Toast.makeText(CreatePostActivity.this, message, Toast.LENGTH_SHORT).show();&#13;&#10;            }&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    protected void onDestroy() {&#13;&#10;        super.onDestroy();&#13;&#10;        if (loadingDialog != null) {&#13;&#10;            loadingDialog.dismiss();&#13;&#10;        }&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/HomeActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/HomeActivity.java" />
              <option name="originalContent" value="package com.example.sportconnection;&#10;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.ProgressBar;&#10;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.fragment.app.Fragment;&#10;import androidx.fragment.app.FragmentManager;&#10;import androidx.fragment.app.FragmentTransaction;&#10;&#10;import com.example.sportconnection.fragments.ConnectFragment;&#10;import com.example.sportconnection.fragments.ConnectionsFragment;&#10;import com.example.sportconnection.fragments.MapFragment;&#10;import com.example.sportconnection.fragments.PostsFragment;&#10;import com.example.sportconnection.fragments.ProfileFragment;&#10;import com.example.sportconnection.utils.Logger;&#10;import com.google.android.material.bottomnavigation.BottomNavigationView;&#10;&#10;public class HomeActivity extends AppCompatActivity {&#10;&#10;    private static final String TAG = &quot;HomeActivity&quot;;&#10;    private BottomNavigationView bottomNavigation;&#10;    private FragmentManager fragmentManager;&#10;    private ProgressBar loadingOverlay;&#10;    private boolean isFragmentLoading = false;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_home);&#10;&#10;        bottomNavigation = findViewById(R.id.bottomNavigation);&#10;        loadingOverlay = findViewById(R.id.loadingOverlay);&#10;        fragmentManager = getSupportFragmentManager();&#10;&#10;        // Cargar el fragmento inicial (Conectar)&#10;        if (savedInstanceState == null) {&#10;            loadFragment(new ConnectFragment());&#10;        }&#10;&#10;        // Configurar el listener para la barra de navegación&#10;        bottomNavigation.setOnItemSelectedListener(item -&gt; {&#10;            // Bloquear navegación si hay un fragmento cargando&#10;            if (isFragmentLoading) {&#10;                Logger.d(TAG, &quot;Navegación bloqueada - Fragmento en proceso de carga&quot;);&#10;                return false;&#10;            }&#10;&#10;            Fragment fragment = null;&#10;            int itemId = item.getItemId();&#10;&#10;            if (itemId == R.id.nav_connect) {&#10;                fragment = new ConnectFragment();&#10;            } else if (itemId == R.id.nav_connections) {&#10;                fragment = new ConnectionsFragment();&#10;            } else if (itemId == R.id.nav_posts) {&#10;                fragment = new PostsFragment();&#10;            } else if (itemId == R.id.nav_map) {&#10;                fragment = new MapFragment();&#10;            } else if (itemId == R.id.nav_profile) {&#10;                fragment = new ProfileFragment();&#10;            }&#10;&#10;            if (fragment != null) {&#10;                loadFragment(fragment);&#10;                return true;&#10;            }&#10;            return false;&#10;        });&#10;    }&#10;&#10;    private void loadFragment(Fragment fragment) {&#10;        Logger.d(TAG, &quot;Iniciando carga de fragmento: &quot; + fragment.getClass().getSimpleName());&#10;        setFragmentLoading(true);&#10;        &#10;        FragmentTransaction transaction = fragmentManager.beginTransaction();&#10;        transaction.replace(R.id.fragmentContainer, fragment);&#10;        transaction.commitNow(); // Usar commitNow para esperar a que termine&#10;        &#10;        // Dar un pequeño delay para que el fragmento se inicialice&#10;        bottomNavigation.postDelayed(() -&gt; {&#10;            setFragmentLoading(false);&#10;            Logger.d(TAG, &quot;Fragmento cargado: &quot; + fragment.getClass().getSimpleName());&#10;        }, 500);&#10;    }&#10;    &#10;    public void setFragmentLoading(boolean loading) {&#10;        isFragmentLoading = loading;&#10;        if (loadingOverlay != null) {&#10;            loadingOverlay.setVisibility(loading ? View.VISIBLE : View.GONE);&#10;        }&#10;        bottomNavigation.setEnabled(!loading);&#10;        Logger.d(TAG, &quot;Estado de carga: &quot; + (loading ? &quot;BLOQUEADO&quot; : &quot;DESBLOQUEADO&quot;));&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.sportconnection;&#10;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.ProgressBar;&#10;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.fragment.app.Fragment;&#10;import androidx.fragment.app.FragmentManager;&#10;import androidx.fragment.app.FragmentTransaction;&#10;&#10;import com.example.sportconnection.fragments.ConnectFragment;&#10;import com.example.sportconnection.fragments.ConnectionsFragment;&#10;import com.example.sportconnection.fragments.MapFragment;&#10;import com.example.sportconnection.fragments.PostsFragment;&#10;import com.example.sportconnection.fragments.ProfileFragment;&#10;import com.example.sportconnection.utils.Logger;&#10;import com.google.android.material.bottomnavigation.BottomNavigationView;&#10;&#10;public class HomeActivity extends AppCompatActivity {&#10;&#10;    private static final String TAG = &quot;HomeActivity&quot;;&#10;    private BottomNavigationView bottomNavigation;&#10;    private FragmentManager fragmentManager;&#10;    private ProgressBar loadingOverlay;&#10;    private boolean isFragmentLoading = false;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_home);&#10;&#10;        bottomNavigation = findViewById(R.id.bottomNavigation);&#10;        loadingOverlay = findViewById(R.id.loadingOverlay);&#10;        fragmentManager = getSupportFragmentManager();&#10;&#10;        // Cargar el fragmento inicial (Conectar)&#10;        if (savedInstanceState == null) {&#10;            loadFragment(new ConnectFragment());&#10;        }&#10;&#10;        // Configurar el listener para la barra de navegación&#10;        bottomNavigation.setOnItemSelectedListener(item -&gt; {&#10;            // Bloquear navegación si hay un fragmento cargando&#10;            if (isFragmentLoading) {&#10;                Logger.d(TAG, &quot;Navegación bloqueada - Fragmento en proceso de carga&quot;);&#10;                return false;&#10;            }&#10;&#10;            Fragment fragment = null;&#10;            int itemId = item.getItemId();&#10;&#10;            if (itemId == R.id.nav_connect) {&#10;                fragment = new ConnectFragment();&#10;            } else if (itemId == R.id.nav_connections) {&#10;                fragment = new ConnectionsFragment();&#10;            } else if (itemId == R.id.nav_posts) {&#10;                fragment = new PostsFragment();&#10;            } else if (itemId == R.id.nav_map) {&#10;                fragment = new MapFragment();&#10;            } else if (itemId == R.id.nav_profile) {&#10;                fragment = new ProfileFragment();&#10;            }&#10;&#10;            if (fragment != null) {&#10;                loadFragment(fragment);&#10;                return true;&#10;            }&#10;            return false;&#10;        });&#10;    }&#10;&#10;    private void loadFragment(Fragment fragment) {&#10;        Logger.d(TAG, &quot;Iniciando carga de fragmento: &quot; + fragment.getClass().getSimpleName());&#10;        setFragmentLoading(true);&#10;        &#10;        FragmentTransaction transaction = fragmentManager.beginTransaction();&#10;        transaction.replace(R.id.fragmentContainer, fragment);&#10;        transaction.commitNow(); // Usar commitNow para esperar a que termine&#10;        &#10;        // Dar un pequeño delay para que el fragmento se inicialice&#10;        bottomNavigation.postDelayed(() -&gt; {&#10;            setFragmentLoading(false);&#10;            Logger.d(TAG, &quot;Fragmento cargado: &quot; + fragment.getClass().getSimpleName());&#10;        }, 500);&#10;    }&#10;    &#10;    public void setFragmentLoading(boolean loading) {&#10;        isFragmentLoading = loading;&#10;        if (loadingOverlay != null) {&#10;            loadingOverlay.setVisibility(loading ? View.VISIBLE : View.GONE);&#10;        }&#10;        bottomNavigation.setEnabled(!loading);&#10;        Logger.d(TAG, &quot;Estado de carga: &quot; + (loading ? &quot;BLOQUEADO&quot; : &quot;DESBLOQUEADO&quot;));&#10;    }&#10;}&#13;&#10;&#13;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/LoginActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/LoginActivity.java" />
              <option name="originalContent" value="package com.example.sportconnection;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.EditText;&#10;import android.widget.Toast;&#10;&#10;import androidx.activity.EdgeToEdge;&#10;import androidx.activity.result.ActivityResultLauncher;&#10;import androidx.activity.result.contract.ActivityResultContracts;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.core.graphics.Insets;&#10;import androidx.core.view.ViewCompat;&#10;import androidx.core.view.WindowInsetsCompat;&#10;&#10;import com.google.android.gms.auth.api.signin.GoogleSignIn;&#10;import com.google.android.gms.auth.api.signin.GoogleSignInAccount;&#10;import com.google.android.gms.auth.api.signin.GoogleSignInClient;&#10;import com.google.android.gms.auth.api.signin.GoogleSignInOptions;&#10;import com.google.android.gms.common.api.ApiException;&#10;import com.google.android.gms.tasks.Task;&#10;&#10;import com.example.sportconnection.model.LoginResponse;&#10;import com.example.sportconnection.repository.AuthRepository;&#10;import com.example.sportconnection.utils.LoadingDialog;&#10;import com.example.sportconnection.utils.Logger;&#10;import com.example.sportconnection.utils.SessionManager;&#10;import com.example.sportconnection.utils.ThreadManager;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class LoginActivity extends AppCompatActivity {&#10;&#10;    private static final String TAG = &quot;LoginActivity&quot;;&#10;    private EditText editTextEmail;&#10;    private EditText editTextPassword;&#10;    private Button buttonLogin;&#10;    private Button buttonGoogleSignIn;&#10;&#10;    private AuthRepository authRepository;&#10;    private SessionManager sessionManager;&#10;    private LoadingDialog loadingDialog;&#10;    private ThreadManager threadManager;&#10;&#10;    private GoogleSignInClient googleSignInClient;&#10;    private ActivityResultLauncher&lt;Intent&gt; googleSignInLauncher;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;&#10;        Logger.forceLog(TAG, &quot;========== INICIANDO LOGINACTIVITY ==========&quot;);&#10;        Logger.d(TAG, &quot;onCreate() llamado&quot;);&#10;&#10;        setContentView(R.layout.activity_login);&#10;&#10;        // Inicializar vistas&#10;        editTextEmail = findViewById(R.id.editTextEmail);&#10;        editTextPassword = findViewById(R.id.editTextPassword);&#10;        buttonLogin = findViewById(R.id.buttonLogin);&#10;        buttonGoogleSignIn = findViewById(R.id.buttonGoogleSignIn);&#10;&#10;        // Inicializar repositorio, session manager y utilidades&#10;        authRepository = new AuthRepository();&#10;        sessionManager = new SessionManager(this);&#10;        loadingDialog = new LoadingDialog(this);&#10;        threadManager = ThreadManager.getInstance();&#10;&#10;        // Configurar Google Sign-In&#10;        GoogleSignInOptions gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)&#10;                .requestIdToken(getString(R.string.default_web_client_id))&#10;                .requestEmail()&#10;                .build();&#10;        googleSignInClient = GoogleSignIn.getClient(this, gso);&#10;&#10;        // Configurar el launcher para el resultado de Google Sign-In&#10;        googleSignInLauncher = registerForActivityResult(&#10;                new ActivityResultContracts.StartActivityForResult(),&#10;                result -&gt; {&#10;                    Logger.forceLog(TAG, &quot;========== GOOGLE SIGN-IN RESULT ==========&quot;);&#10;                    Logger.forceLog(TAG, &quot;Result code: &quot; + result.getResultCode());&#10;                    Logger.forceLog(TAG, &quot;RESULT_OK = &quot; + RESULT_OK + &quot; (-1)&quot;);&#10;                    Logger.forceLog(TAG, &quot;RESULT_CANCELED = &quot; + RESULT_CANCELED + &quot; (0)&quot;);&#10;&#10;                    Intent data = result.getData();&#10;                    Logger.forceLog(TAG, &quot;Intent data: &quot; + (data != null ? &quot;Present&quot; : &quot;NULL&quot;));&#10;&#10;                    if (data != null) {&#10;                        Logger.d(TAG, &quot;Processing intent data...&quot;);&#10;                        Task&lt;GoogleSignInAccount&gt; task = GoogleSignIn.getSignedInAccountFromIntent(data);&#10;                        handleGoogleSignInResult(task);&#10;                    } else {&#10;                        Logger.forceLog(TAG, &quot;No intent data received!&quot;);&#10;                        if (result.getResultCode() == RESULT_CANCELED) {&#10;                            Logger.d(TAG, &quot;User canceled the sign-in flow&quot;);&#10;                            Toast.makeText(LoginActivity.this, &quot;Inicio de sesión cancelado por el usuario&quot;, Toast.LENGTH_SHORT).show();&#10;                        } else if (result.getResultCode() == RESULT_OK) {&#10;                            Logger.forceLog(TAG, &quot;RESULT_OK but no data - This is unusual!&quot;);&#10;                            Toast.makeText(LoginActivity.this, &quot;Error: No se recibieron datos de Google&quot;, Toast.LENGTH_LONG).show();&#10;                        } else {&#10;                            Logger.forceLog(TAG, &quot;Unexpected result code with no data: &quot; + result.getResultCode());&#10;                            Toast.makeText(LoginActivity.this, &quot;Error inesperado al iniciar sesión&quot;, Toast.LENGTH_SHORT).show();&#10;                        }&#10;                    }&#10;                });&#10;&#10;        // Configurar el botón de login&#10;        buttonLogin.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                String email = editTextEmail.getText().toString().trim();&#10;                String password = editTextPassword.getText().toString().trim();&#10;&#10;                if (email.isEmpty() || password.isEmpty()) {&#10;                    Toast.makeText(LoginActivity.this, &quot;Por favor, completa todos los campos&quot;, Toast.LENGTH_SHORT).show();&#10;                } else {&#10;                    loginUser(email, password);&#10;                }&#10;            }&#10;        });&#10;&#10;        // Configurar el botón de Google Sign-In&#10;        buttonGoogleSignIn.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                signInWithGoogle();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void signInWithGoogle() {&#10;        Logger.forceLog(TAG, &quot;========== STARTING GOOGLE SIGN-IN ==========&quot;);&#10;        Logger.forceLog(TAG, &quot;Web Client ID: &quot; + getString(R.string.default_web_client_id));&#10;&#10;        // Verificar si el Web Client ID está configurado&#10;        String webClientId = getString(R.string.default_web_client_id);&#10;        if (webClientId.equals(&quot;YOUR_WEB_CLIENT_ID_HERE&quot;)) {&#10;            Logger.forceLog(TAG, &quot;ERROR: Web Client ID not configured!&quot;);&#10;            Toast.makeText(this, &quot;Error: Web Client ID no está configurado. Revisa strings.xml&quot;, Toast.LENGTH_LONG).show();&#10;            return;&#10;        }&#10;&#10;        // Cerrar sesión previa para forzar selección de cuenta&#10;        googleSignInClient.signOut().addOnCompleteListener(this, task -&gt; {&#10;            Logger.d(TAG, &quot;Previous session cleared&quot;);&#10;            Intent signInIntent = googleSignInClient.getSignInIntent();&#10;            Logger.d(TAG, &quot;Launching Google Sign-In intent...&quot;);&#10;            googleSignInLauncher.launch(signInIntent);&#10;        });&#10;    }&#10;&#10;    private void handleGoogleSignInResult(Task&lt;GoogleSignInAccount&gt; completedTask) {&#10;        Logger.d(TAG, &quot;handleGoogleSignInResult called&quot;);&#10;        try {&#10;            GoogleSignInAccount account = completedTask.getResult(ApiException.class);&#10;            Logger.d(TAG, &quot;Account obtained: &quot; + account.getEmail());&#10;&#10;            String idToken = account.getIdToken();&#10;            Logger.d(TAG, &quot;ID Token: &quot; + (idToken != null ? &quot;Present&quot; : &quot;NULL&quot;));&#10;&#10;            if (idToken != null) {&#10;                Logger.d(TAG, &quot;Calling loginWithGoogle...&quot;);&#10;                loginWithGoogle(idToken);&#10;            } else {&#10;                Logger.forceLog(TAG, &quot;ID Token is NULL!&quot;);&#10;                Toast.makeText(this, &quot;Error al obtener token de Google. Verifica la configuración del Web Client ID&quot;, Toast.LENGTH_LONG).show();&#10;            }&#10;        } catch (ApiException e) {&#10;            Logger.forceLog(TAG, &quot;ApiException in Google Sign-In&quot;);&#10;            Logger.forceLog(TAG, &quot;Status code: &quot; + e.getStatusCode());&#10;            Logger.forceLog(TAG, &quot;Status message: &quot; + e.getStatusMessage());&#10;&#10;            String errorMessage = &quot;Error al iniciar sesión con Google (código: &quot; + e.getStatusCode() + &quot;)&quot;;&#10;            if (e.getStatusCode() == 10) {&#10;                errorMessage = &quot;Error de configuración. Verifica el Web Client ID en strings.xml&quot;;&#10;            }&#10;            Toast.makeText(this, errorMessage, Toast.LENGTH_LONG).show();&#10;        }&#10;    }&#10;&#10;    private void loginWithGoogle(final String idToken) {&#10;        Logger.d(TAG, &quot;loginWithGoogle called&quot;);&#10;        loadingDialog.show(&quot;Iniciando sesión con Google...&quot;);&#10;        buttonGoogleSignIn.setEnabled(false);&#10;&#10;        threadManager.executeInBackground(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                Logger.d(TAG, &quot;Calling API googleSignIn...&quot;);&#10;                authRepository.googleSignIn(idToken, new Callback&lt;LoginResponse&gt;() {&#10;                    @Override&#10;                    public void onResponse(Call&lt;LoginResponse&gt; call, Response&lt;LoginResponse&gt; response) {&#10;                        Logger.d(TAG, &quot;Response received from server&quot;);&#10;                        Logger.d(TAG, &quot;Response code: &quot; + response.code());&#10;                        Logger.d(TAG, &quot;Response successful: &quot; + response.isSuccessful());&#10;&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonGoogleSignIn.setEnabled(true);&#10;&#10;                                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                                    LoginResponse loginResponse = response.body();&#10;&#10;                                    Logger.d(TAG, &quot;Login response success: &quot; + loginResponse.isSuccess());&#10;&#10;                                    if (loginResponse.isSuccess()) {&#10;                                        LoginResponse.UserData user = loginResponse.getUser();&#10;                                        String token = loginResponse.getToken();&#10;&#10;                                        Logger.d(TAG, &quot;User: &quot; + (user != null ? user.getEmail() : &quot;null&quot;));&#10;                                        Logger.d(TAG, &quot;Token: &quot; + (token != null ? &quot;present&quot; : &quot;null&quot;));&#10;&#10;                                        if (user != null &amp;&amp; token != null) {&#10;                                            sessionManager.saveSession(&#10;                                                token,&#10;                                                user.getId(),&#10;                                                user.getEmail(),&#10;                                                user.getProfileType() != null ? user.getProfileType() : &quot;user&quot;&#10;                                            );&#10;&#10;                                            Toast.makeText(LoginActivity.this, &quot;¡Bienvenido!&quot;, Toast.LENGTH_SHORT).show();&#10;&#10;                                            threadManager.executeWithDelay(new Runnable() {&#10;                                                @Override&#10;                                                public void run() {&#10;                                                    Logger.d(TAG, &quot;Navigating to HomeActivity&quot;);&#10;                                                    Intent intent = new Intent(LoginActivity.this, HomeActivity.class);&#10;                                                    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);&#10;                                                    startActivity(intent);&#10;                                                    finish();&#10;                                                }&#10;                                            }, 300);&#10;                                        }&#10;                                    } else {&#10;                                        Logger.d(TAG, &quot;Login not successful: &quot; + loginResponse.getMessage());&#10;                                        Toast.makeText(LoginActivity.this, loginResponse.getMessage(), Toast.LENGTH_LONG).show();&#10;                                    }&#10;                                } else {&#10;                                    Logger.forceLog(TAG, &quot;Response not successful or body is null&quot;);&#10;                                    Logger.forceLog(TAG, &quot;Response code: &quot; + response.code());&#10;                                    Toast.makeText(LoginActivity.this, &quot;Error en el login con Google&quot;, Toast.LENGTH_LONG).show();&#10;                                }&#10;                            }&#10;                        });&#10;                    }&#10;&#10;                    @Override&#10;                    public void onFailure(Call&lt;LoginResponse&gt; call, Throwable t) {&#10;                        Logger.forceLog(TAG, &quot;API call failed&quot;);&#10;                        Logger.forceLog(TAG, &quot;Error: &quot; + t.getMessage());&#10;                        t.printStackTrace();&#10;&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonGoogleSignIn.setEnabled(true);&#10;                                Toast.makeText(LoginActivity.this, &quot;Error de conexión: &quot; + t.getMessage(), Toast.LENGTH_LONG).show();&#10;                            }&#10;                        });&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void loginUser(final String email, final String password) {&#10;        // Mostrar diálogo de carga&#10;        loadingDialog.show(&quot;Iniciando sesión...&quot;);&#10;        buttonLogin.setEnabled(false);&#10;&#10;        // Ejecutar login en segundo plano&#10;        threadManager.executeInBackground(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                authRepository.login(email, password, new Callback&lt;LoginResponse&gt;() {&#10;                    @Override&#10;                    public void onResponse(Call&lt;LoginResponse&gt; call, Response&lt;LoginResponse&gt; response) {&#10;                        // Ejecutar en el hilo principal para actualizar la UI&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonLogin.setEnabled(true);&#10;&#10;                                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                                    LoginResponse loginResponse = response.body();&#10;&#10;                                    Logger.forceLog(TAG, &quot;Response recibida del servidor&quot;);&#10;                                    Logger.forceLog(TAG, &quot;Token presente: &quot; + (loginResponse.getToken() != null));&#10;                                    Logger.forceLog(TAG, &quot;User presente: &quot; + (loginResponse.getUser() != null));&#10;&#10;                                    if (loginResponse.isSuccess()) {&#10;                                        // Log para debug&#10;                                        Logger.forceLog(TAG, &quot;Login exitoso!&quot;);&#10;&#10;                                        LoginResponse.UserData user = loginResponse.getUser();&#10;&#10;                                        if (user == null) {&#10;                                            Logger.forceLog(TAG, &quot;ERROR: User data es NULL&quot;);&#10;                                            Toast.makeText(LoginActivity.this, &quot;Error: Datos de usuario no recibidos&quot;, Toast.LENGTH_LONG).show();&#10;                                            return;&#10;                                        }&#10;&#10;                                        String token = loginResponse.getToken();&#10;                                        if (token == null || token.isEmpty()) {&#10;                                            Logger.forceLog(TAG, &quot;ERROR: Token es NULL o vacío&quot;);&#10;                                            Toast.makeText(LoginActivity.this, &quot;Error: Token no recibido&quot;, Toast.LENGTH_LONG).show();&#10;                                            return;&#10;                                        }&#10;&#10;                                        // Log de datos del usuario&#10;                                        Logger.forceLog(TAG, &quot;Token: &quot; + token);&#10;                                        Logger.forceLog(TAG, &quot;UserId: &quot; + user.getId());&#10;                                        Logger.forceLog(TAG, &quot;Email: &quot; + user.getEmail());&#10;                                        Logger.forceLog(TAG, &quot;ProfileType/Role: &quot; + user.getProfileType());&#10;&#10;                                        // Guardar sesión SINCRÓNICAMENTE (no en segundo plano)&#10;                                        sessionManager.saveSession(&#10;                                            token,&#10;                                            user.getId(),&#10;                                            user.getEmail(),&#10;                                            user.getProfileType() != null ? user.getProfileType() : &quot;user&quot;&#10;                                        );&#10;&#10;                                        // Verificar que se guardó correctamente&#10;                                        boolean isLoggedIn = sessionManager.isLoggedIn();&#10;                                        Logger.forceLog(TAG, &quot;Sesión guardada. isLoggedIn: &quot; + isLoggedIn);&#10;&#10;                                        Toast.makeText(LoginActivity.this, &quot;¡Bienvenido!&quot;, Toast.LENGTH_SHORT).show();&#10;&#10;                                        // Navegar a HomeActivity con un pequeño delay&#10;                                        threadManager.executeWithDelay(new Runnable() {&#10;                                            @Override&#10;                                            public void run() {&#10;                                                Logger.forceLog(TAG, &quot;Navegando a HomeActivity...&quot;);&#10;                                                Intent intent = new Intent(LoginActivity.this, HomeActivity.class);&#10;                                                intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);&#10;                                                startActivity(intent);&#10;                                                finish();&#10;                                            }&#10;                                        }, 300);&#10;                                    } else {&#10;                                        // Manejar mensaje null&#10;                                        String errorMsg = loginResponse.getMessage();&#10;                                        if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                            errorMsg = &quot;Error en el inicio de sesión&quot;;&#10;                                        }&#10;                                        Toast.makeText(LoginActivity.this, errorMsg, Toast.LENGTH_LONG).show();&#10;                                    }&#10;                                } else {&#10;                                    String errorMsg = response.message();&#10;                                    if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                        errorMsg = &quot;Error en el servidor&quot;;&#10;                                    }&#10;                                    Toast.makeText(LoginActivity.this, &quot;Error en el login: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                                }&#10;                            }&#10;                        });&#10;                    }&#10;&#10;                    @Override&#10;                    public void onFailure(Call&lt;LoginResponse&gt; call, Throwable t) {&#10;                        // Ejecutar en el hilo principal para actualizar la UI&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonLogin.setEnabled(true);&#10;&#10;                                String errorMsg = t.getMessage();&#10;                                if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                    errorMsg = &quot;Error desconocido&quot;;&#10;                                }&#10;                                Toast.makeText(LoginActivity.this, &quot;Error de conexión: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                            }&#10;                        });&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    @Override&#10;    protected void onDestroy() {&#10;        super.onDestroy();&#10;        // Cerrar el diálogo si está abierto&#10;        if (loadingDialog != null &amp;&amp; loadingDialog.isShowing()) {&#10;            loadingDialog.dismiss();&#10;        }&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.sportconnection;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.EditText;&#10;import android.widget.Toast;&#10;&#10;import androidx.activity.EdgeToEdge;&#10;import androidx.activity.result.ActivityResultLauncher;&#10;import androidx.activity.result.contract.ActivityResultContracts;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.core.graphics.Insets;&#10;import androidx.core.view.ViewCompat;&#10;import androidx.core.view.WindowInsetsCompat;&#10;&#10;import com.google.android.gms.auth.api.signin.GoogleSignIn;&#10;import com.google.android.gms.auth.api.signin.GoogleSignInAccount;&#10;import com.google.android.gms.auth.api.signin.GoogleSignInClient;&#10;import com.google.android.gms.auth.api.signin.GoogleSignInOptions;&#10;import com.google.android.gms.common.api.ApiException;&#10;import com.google.android.gms.tasks.Task;&#10;&#10;import com.example.sportconnection.model.LoginResponse;&#10;import com.example.sportconnection.repository.AuthRepository;&#10;import com.example.sportconnection.utils.LoadingDialog;&#10;import com.example.sportconnection.utils.Logger;&#10;import com.example.sportconnection.utils.SessionManager;&#10;import com.example.sportconnection.utils.ThreadManager;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class LoginActivity extends AppCompatActivity {&#10;&#10;    private static final String TAG = &quot;LoginActivity&quot;;&#10;    private EditText editTextEmail;&#10;    private EditText editTextPassword;&#10;    private Button buttonLogin;&#10;    private Button buttonGoogleSignIn;&#10;&#10;    private AuthRepository authRepository;&#10;    private SessionManager sessionManager;&#10;    private LoadingDialog loadingDialog;&#10;    private ThreadManager threadManager;&#10;&#10;    private GoogleSignInClient googleSignInClient;&#10;    private ActivityResultLauncher&lt;Intent&gt; googleSignInLauncher;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;&#10;        Logger.forceLog(TAG, &quot;========== INICIANDO LOGINACTIVITY ==========&quot;);&#10;        Logger.d(TAG, &quot;onCreate() llamado&quot;);&#10;&#10;        setContentView(R.layout.activity_login);&#10;&#10;        // Inicializar vistas&#10;        editTextEmail = findViewById(R.id.editTextEmail);&#10;        editTextPassword = findViewById(R.id.editTextPassword);&#10;        buttonLogin = findViewById(R.id.buttonLogin);&#10;        buttonGoogleSignIn = findViewById(R.id.buttonGoogleSignIn);&#10;&#10;        // Inicializar repositorio, session manager y utilidades&#10;        authRepository = new AuthRepository();&#10;        sessionManager = new SessionManager(this);&#10;        loadingDialog = new LoadingDialog(this);&#10;        threadManager = ThreadManager.getInstance();&#10;&#10;        // Configurar Google Sign-In&#10;        GoogleSignInOptions gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)&#10;                .requestIdToken(getString(R.string.default_web_client_id))&#10;                .requestEmail()&#10;                .build();&#10;        googleSignInClient = GoogleSignIn.getClient(this, gso);&#10;&#10;        // Configurar el launcher para el resultado de Google Sign-In&#10;        googleSignInLauncher = registerForActivityResult(&#10;                new ActivityResultContracts.StartActivityForResult(),&#10;                result -&gt; {&#10;                    Logger.forceLog(TAG, &quot;========== GOOGLE SIGN-IN RESULT ==========&quot;);&#10;                    Logger.forceLog(TAG, &quot;Result code: &quot; + result.getResultCode());&#10;                    Logger.forceLog(TAG, &quot;RESULT_OK = &quot; + RESULT_OK + &quot; (-1)&quot;);&#10;                    Logger.forceLog(TAG, &quot;RESULT_CANCELED = &quot; + RESULT_CANCELED + &quot; (0)&quot;);&#10;&#10;                    Intent data = result.getData();&#10;                    Logger.forceLog(TAG, &quot;Intent data: &quot; + (data != null ? &quot;Present&quot; : &quot;NULL&quot;));&#10;&#10;                    if (data != null) {&#10;                        Logger.d(TAG, &quot;Processing intent data...&quot;);&#10;                        Task&lt;GoogleSignInAccount&gt; task = GoogleSignIn.getSignedInAccountFromIntent(data);&#10;                        handleGoogleSignInResult(task);&#10;                    } else {&#10;                        Logger.forceLog(TAG, &quot;No intent data received!&quot;);&#10;                        if (result.getResultCode() == RESULT_CANCELED) {&#10;                            Logger.d(TAG, &quot;User canceled the sign-in flow&quot;);&#10;                            Toast.makeText(LoginActivity.this, &quot;Inicio de sesión cancelado por el usuario&quot;, Toast.LENGTH_SHORT).show();&#10;                        } else if (result.getResultCode() == RESULT_OK) {&#10;                            Logger.forceLog(TAG, &quot;RESULT_OK but no data - This is unusual!&quot;);&#10;                            Toast.makeText(LoginActivity.this, &quot;Error: No se recibieron datos de Google&quot;, Toast.LENGTH_LONG).show();&#10;                        } else {&#10;                            Logger.forceLog(TAG, &quot;Unexpected result code with no data: &quot; + result.getResultCode());&#10;                            Toast.makeText(LoginActivity.this, &quot;Error inesperado al iniciar sesión&quot;, Toast.LENGTH_SHORT).show();&#10;                        }&#10;                    }&#10;                });&#10;&#10;        // Configurar el botón de login&#10;        buttonLogin.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                String email = editTextEmail.getText().toString().trim();&#10;                String password = editTextPassword.getText().toString().trim();&#10;&#10;                if (email.isEmpty() || password.isEmpty()) {&#10;                    Toast.makeText(LoginActivity.this, &quot;Por favor, completa todos los campos&quot;, Toast.LENGTH_SHORT).show();&#10;                } else {&#10;                    loginUser(email, password);&#10;                }&#10;            }&#10;        });&#10;&#10;        // Configurar el botón de Google Sign-In&#10;        buttonGoogleSignIn.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                signInWithGoogle();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void signInWithGoogle() {&#10;        Logger.forceLog(TAG, &quot;========== STARTING GOOGLE SIGN-IN ==========&quot;);&#10;        Logger.forceLog(TAG, &quot;Web Client ID: &quot; + getString(R.string.default_web_client_id));&#10;&#10;        // Verificar si el Web Client ID está configurado&#10;        String webClientId = getString(R.string.default_web_client_id);&#10;        if (webClientId.equals(&quot;YOUR_WEB_CLIENT_ID_HERE&quot;)) {&#10;            Logger.forceLog(TAG, &quot;ERROR: Web Client ID not configured!&quot;);&#10;            Toast.makeText(this, &quot;Error: Web Client ID no está configurado. Revisa strings.xml&quot;, Toast.LENGTH_LONG).show();&#10;            return;&#10;        }&#10;&#10;        // Cerrar sesión previa para forzar selección de cuenta&#10;        googleSignInClient.signOut().addOnCompleteListener(this, task -&gt; {&#10;            Logger.d(TAG, &quot;Previous session cleared&quot;);&#10;            Intent signInIntent = googleSignInClient.getSignInIntent();&#10;            Logger.d(TAG, &quot;Launching Google Sign-In intent...&quot;);&#10;            googleSignInLauncher.launch(signInIntent);&#10;        });&#10;    }&#10;&#10;    private void handleGoogleSignInResult(Task&lt;GoogleSignInAccount&gt; completedTask) {&#10;        Logger.d(TAG, &quot;handleGoogleSignInResult called&quot;);&#10;        try {&#10;            GoogleSignInAccount account = completedTask.getResult(ApiException.class);&#10;            Logger.d(TAG, &quot;Account obtained: &quot; + account.getEmail());&#10;&#10;            String idToken = account.getIdToken();&#10;            Logger.d(TAG, &quot;ID Token: &quot; + (idToken != null ? &quot;Present&quot; : &quot;NULL&quot;));&#10;&#10;            if (idToken != null) {&#10;                Logger.d(TAG, &quot;Calling loginWithGoogle...&quot;);&#10;                loginWithGoogle(idToken);&#10;            } else {&#10;                Logger.forceLog(TAG, &quot;ID Token is NULL!&quot;);&#10;                Toast.makeText(this, &quot;Error al obtener token de Google. Verifica la configuración del Web Client ID&quot;, Toast.LENGTH_LONG).show();&#10;            }&#10;        } catch (ApiException e) {&#10;            Logger.forceLog(TAG, &quot;ApiException in Google Sign-In&quot;);&#10;            Logger.forceLog(TAG, &quot;Status code: &quot; + e.getStatusCode());&#10;            Logger.forceLog(TAG, &quot;Status message: &quot; + e.getStatusMessage());&#10;&#10;            String errorMessage = &quot;Error al iniciar sesión con Google (código: &quot; + e.getStatusCode() + &quot;)&quot;;&#10;            if (e.getStatusCode() == 10) {&#10;                errorMessage = &quot;Error de configuración. Verifica el Web Client ID en strings.xml&quot;;&#10;            }&#10;            Toast.makeText(this, errorMessage, Toast.LENGTH_LONG).show();&#10;        }&#10;    }&#10;&#10;    private void loginWithGoogle(final String idToken) {&#10;        Logger.d(TAG, &quot;loginWithGoogle called&quot;);&#10;        loadingDialog.show(&quot;Iniciando sesión con Google...&quot;);&#10;        buttonGoogleSignIn.setEnabled(false);&#10;&#10;        threadManager.executeInBackground(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                Logger.d(TAG, &quot;Calling API googleSignIn...&quot;);&#10;                authRepository.googleSignIn(idToken, new Callback&lt;LoginResponse&gt;() {&#10;                    @Override&#10;                    public void onResponse(Call&lt;LoginResponse&gt; call, Response&lt;LoginResponse&gt; response) {&#10;                        Logger.d(TAG, &quot;Response received from server&quot;);&#10;                        Logger.d(TAG, &quot;Response code: &quot; + response.code());&#10;                        Logger.d(TAG, &quot;Response successful: &quot; + response.isSuccessful());&#10;&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonGoogleSignIn.setEnabled(true);&#10;&#10;                                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                                    LoginResponse loginResponse = response.body();&#10;&#10;                                    Logger.d(TAG, &quot;Login response success: &quot; + loginResponse.isSuccess());&#10;&#10;                                    if (loginResponse.isSuccess()) {&#10;                                        LoginResponse.UserData user = loginResponse.getUser();&#10;                                        String token = loginResponse.getToken();&#10;&#10;                                        Logger.d(TAG, &quot;User: &quot; + (user != null ? user.getEmail() : &quot;null&quot;));&#10;                                        Logger.d(TAG, &quot;Token: &quot; + (token != null ? &quot;present&quot; : &quot;null&quot;));&#10;&#10;                                        if (user != null &amp;&amp; token != null) {&#10;                                            sessionManager.saveSession(&#10;                                                token,&#10;                                                user.getId(),&#10;                                                user.getEmail(),&#10;                                                user.getProfileType() != null ? user.getProfileType() : &quot;user&quot;&#10;                                            );&#10;&#10;                                            Toast.makeText(LoginActivity.this, &quot;¡Bienvenido!&quot;, Toast.LENGTH_SHORT).show();&#10;&#10;                                            threadManager.executeWithDelay(new Runnable() {&#10;                                                @Override&#10;                                                public void run() {&#10;                                                    Logger.d(TAG, &quot;Navigating to HomeActivity&quot;);&#10;                                                    Intent intent = new Intent(LoginActivity.this, HomeActivity.class);&#10;                                                    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);&#10;                                                    startActivity(intent);&#10;                                                    finish();&#10;                                                }&#10;                                            }, 300);&#10;                                        }&#10;                                    } else {&#10;                                        Logger.d(TAG, &quot;Login not successful: &quot; + loginResponse.getMessage());&#10;                                        Toast.makeText(LoginActivity.this, loginResponse.getMessage(), Toast.LENGTH_LONG).show();&#10;                                    }&#10;                                } else {&#10;                                    Logger.forceLog(TAG, &quot;Response not successful or body is null&quot;);&#10;                                    Logger.forceLog(TAG, &quot;Response code: &quot; + response.code());&#10;                                    Toast.makeText(LoginActivity.this, &quot;Error en el login con Google&quot;, Toast.LENGTH_LONG).show();&#10;                                }&#10;                            }&#10;                        });&#10;                    }&#10;&#10;                    @Override&#10;                    public void onFailure(Call&lt;LoginResponse&gt; call, Throwable t) {&#10;                        Logger.forceLog(TAG, &quot;API call failed&quot;);&#10;                        Logger.forceLog(TAG, &quot;Error: &quot; + t.getMessage());&#10;                        t.printStackTrace();&#10;&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonGoogleSignIn.setEnabled(true);&#10;                                Toast.makeText(LoginActivity.this, &quot;Error de conexión: &quot; + t.getMessage(), Toast.LENGTH_LONG).show();&#10;                            }&#10;                        });&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void loginUser(final String email, final String password) {&#10;        // Mostrar diálogo de carga&#10;        loadingDialog.show(&quot;Iniciando sesión...&quot;);&#10;        buttonLogin.setEnabled(false);&#10;&#10;        // Ejecutar login en segundo plano&#10;        threadManager.executeInBackground(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                authRepository.login(email, password, new Callback&lt;LoginResponse&gt;() {&#10;                    @Override&#10;                    public void onResponse(Call&lt;LoginResponse&gt; call, Response&lt;LoginResponse&gt; response) {&#10;                        // Ejecutar en el hilo principal para actualizar la UI&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonLogin.setEnabled(true);&#10;&#10;                                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                                    LoginResponse loginResponse = response.body();&#10;&#10;                                    Logger.forceLog(TAG, &quot;Response recibida del servidor&quot;);&#10;                                    Logger.forceLog(TAG, &quot;Token presente: &quot; + (loginResponse.getToken() != null));&#10;                                    Logger.forceLog(TAG, &quot;User presente: &quot; + (loginResponse.getUser() != null));&#10;&#10;                                    if (loginResponse.isSuccess()) {&#10;                                        // Log para debug&#10;                                        Logger.forceLog(TAG, &quot;Login exitoso!&quot;);&#10;&#10;                                        LoginResponse.UserData user = loginResponse.getUser();&#10;&#10;                                        if (user == null) {&#10;                                            Logger.forceLog(TAG, &quot;ERROR: User data es NULL&quot;);&#10;                                            Toast.makeText(LoginActivity.this, &quot;Error: Datos de usuario no recibidos&quot;, Toast.LENGTH_LONG).show();&#10;                                            return;&#10;                                        }&#10;&#10;                                        String token = loginResponse.getToken();&#10;                                        if (token == null || token.isEmpty()) {&#10;                                            Logger.forceLog(TAG, &quot;ERROR: Token es NULL o vacío&quot;);&#10;                                            Toast.makeText(LoginActivity.this, &quot;Error: Token no recibido&quot;, Toast.LENGTH_LONG).show();&#10;                                            return;&#10;                                        }&#10;&#10;                                        // Log de datos del usuario&#10;                                        Logger.forceLog(TAG, &quot;Token: &quot; + token);&#10;                                        Logger.forceLog(TAG, &quot;UserId: &quot; + user.getId());&#10;                                        Logger.forceLog(TAG, &quot;Email: &quot; + user.getEmail());&#10;                                        Logger.forceLog(TAG, &quot;ProfileType/Role: &quot; + user.getProfileType());&#10;&#10;                                        // Guardar sesión SINCRÓNICAMENTE (no en segundo plano)&#10;                                        sessionManager.saveSession(&#10;                                            token,&#10;                                            user.getId(),&#10;                                            user.getEmail(),&#10;                                            user.getProfileType() != null ? user.getProfileType() : &quot;user&quot;&#10;                                        );&#10;&#10;                                        // Verificar que se guardó correctamente&#10;                                        boolean isLoggedIn = sessionManager.isLoggedIn();&#10;                                        Logger.forceLog(TAG, &quot;Sesión guardada. isLoggedIn: &quot; + isLoggedIn);&#10;&#10;                                        Toast.makeText(LoginActivity.this, &quot;¡Bienvenido!&quot;, Toast.LENGTH_SHORT).show();&#10;&#10;                                        // Navegar a HomeActivity con un pequeño delay&#10;                                        threadManager.executeWithDelay(new Runnable() {&#10;                                            @Override&#10;                                            public void run() {&#10;                                                Logger.forceLog(TAG, &quot;Navegando a HomeActivity...&quot;);&#10;                                                Intent intent = new Intent(LoginActivity.this, HomeActivity.class);&#10;                                                intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);&#10;                                                startActivity(intent);&#10;                                                finish();&#10;                                            }&#10;                                        }, 300);&#10;                                    } else {&#10;                                        // Manejar mensaje null&#10;                                        String errorMsg = loginResponse.getMessage();&#10;                                        if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                            errorMsg = &quot;Error en el inicio de sesión&quot;;&#10;                                        }&#10;                                        Toast.makeText(LoginActivity.this, errorMsg, Toast.LENGTH_LONG).show();&#10;                                    }&#10;                                } else {&#10;                                    String errorMsg = response.message();&#10;                                    if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                        errorMsg = &quot;Error en el servidor&quot;;&#10;                                    }&#10;                                    Toast.makeText(LoginActivity.this, &quot;Error en el login: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                                }&#10;                            }&#10;                        });&#10;                    }&#10;&#10;                    @Override&#10;                    public void onFailure(Call&lt;LoginResponse&gt; call, Throwable t) {&#10;                        // Ejecutar en el hilo principal para actualizar la UI&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonLogin.setEnabled(true);&#10;&#10;                                String errorMsg = t.getMessage();&#10;                                if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                    errorMsg = &quot;Error desconocido&quot;;&#10;                                }&#10;                                Toast.makeText(LoginActivity.this, &quot;Error de conexión: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                            }&#10;                        });&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    @Override&#10;    protected void onDestroy() {&#10;        super.onDestroy();&#10;        // Cerrar el diálogo si está abierto&#10;        if (loadingDialog != null &amp;&amp; loadingDialog.isShowing()) {&#10;            loadingDialog.dismiss();&#10;        }&#10;    }&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/ProfileFormActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/ProfileFormActivity.java" />
              <option name="originalContent" value="package com.example.sportconnection;&#10;&#10;import android.app.DatePickerDialog;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.util.Log;&#10;import android.view.View;&#10;import android.widget.AdapterView;&#10;import android.widget.ArrayAdapter;&#10;import android.widget.Button;&#10;import android.widget.DatePicker;&#10;import android.widget.EditText;&#10;import android.widget.Spinner;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;&#10;import java.text.SimpleDateFormat;&#10;import java.util.Calendar;&#10;import java.util.Locale;&#10;&#10;import com.example.sportconnection.model.Location;&#10;import com.example.sportconnection.model.ProfileRequest;&#10;import com.example.sportconnection.model.ProfileResponse;&#10;import com.example.sportconnection.model.GetProfileResponse;&#10;import com.example.sportconnection.model.UpdateProfileRequest;&#10;import com.example.sportconnection.model.Sport;&#10;import com.example.sportconnection.repository.AuthRepository;&#10;import com.example.sportconnection.repository.LookupRepository;&#10;import com.example.sportconnection.utils.LoadingDialog;&#10;import com.example.sportconnection.utils.SessionManager;&#10;import com.example.sportconnection.utils.ThreadManager;&#10;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class ProfileFormActivity extends AppCompatActivity {&#10;&#10;    private static final String TAG = &quot;ProfileFormActivity&quot;;&#10;&#10;    private TextView titleProfileForm;&#10;    private EditText editTextName, editTextLastName, editTextBirthdate;&#10;    private EditText editTextHeight, editTextWeight;&#10;    private Spinner spinnerLocation, spinnerSport;&#10;    private EditText editTextPhone, editTextInstagram;&#10;    private EditText editTextTwitter, editTextDescription, editTextAgency;&#10;    private Button buttonComplete;&#10;&#10;    private String email, password, profileType, token;&#10;    private int userId;&#10;&#10;    // Variables para modo edición&#10;    private boolean isEditMode = false;&#10;    private int profileId = -1;&#10;    private GetProfileResponse.ProfileData currentProfile;&#10;&#10;    private AuthRepository authRepository;&#10;    private LookupRepository lookupRepository;&#10;    private SessionManager sessionManager;&#10;    private LoadingDialog loadingDialog;&#10;    private ThreadManager threadManager;&#10;&#10;    private List&lt;Sport&gt; sportList = new ArrayList&lt;&gt;();&#10;    private List&lt;Location&gt; locationList = new ArrayList&lt;&gt;();&#10;    private int selectedSportId = -1;&#10;    private int selectedLocationId = -1;&#10;&#10;    private String selectedBirthdate = &quot;&quot;; // Formato ISO: YYYY-MM-DD&#10;    private Calendar birthdateCalendar = Calendar.getInstance();&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_profile_form);&#10;&#10;        // Obtener datos del Intent&#10;        isEditMode = getIntent().getBooleanExtra(&quot;isEditMode&quot;, false);&#10;&#10;        if (isEditMode) {&#10;            // Modo edición - obtener desde sesión o intent&#10;            sessionManager = new SessionManager(this);&#10;            token = sessionManager.getToken();&#10;            userId = sessionManager.getUserId();&#10;            email = sessionManager.getEmail();&#10;            &#10;            // Intentar obtener profileType del intent primero (más confiable), si no, de la sesión&#10;            profileType = getIntent().getStringExtra(&quot;profileType&quot;);&#10;            if (profileType == null) {&#10;                profileType = sessionManager.getProfileType();&#10;            }&#10;        } else {&#10;            // Modo creación - obtener desde intent&#10;            email = getIntent().getStringExtra(&quot;email&quot;);&#10;            password = getIntent().getStringExtra(&quot;password&quot;);&#10;            profileType = getIntent().getStringExtra(&quot;profileType&quot;);&#10;            token = getIntent().getStringExtra(&quot;token&quot;);&#10;            userId = getIntent().getIntExtra(&quot;userId&quot;, -1);&#10;        }&#10;&#10;        // Inicializar vistas&#10;        titleProfileForm = findViewById(R.id.titleProfileForm);&#10;        editTextName = findViewById(R.id.editTextName);&#10;        editTextLastName = findViewById(R.id.editTextLastName);&#10;        editTextBirthdate = findViewById(R.id.editTextBirthdate);&#10;        editTextHeight = findViewById(R.id.editTextHeight);&#10;        editTextWeight = findViewById(R.id.editTextWeight);&#10;        spinnerLocation = findViewById(R.id.spinnerLocation);&#10;        spinnerSport = findViewById(R.id.spinnerSport);&#10;        editTextPhone = findViewById(R.id.editTextPhone);&#10;        editTextInstagram = findViewById(R.id.editTextInstagram);&#10;        editTextTwitter = findViewById(R.id.editTextTwitter);&#10;        editTextDescription = findViewById(R.id.editTextDescription);&#10;        editTextAgency = findViewById(R.id.editTextAgency);&#10;        buttonComplete = findViewById(R.id.buttonComplete);&#10;&#10;        // Inicializar repositorios y utilidades&#10;        authRepository = new AuthRepository();&#10;        lookupRepository = new LookupRepository();&#10;        if (sessionManager == null) {&#10;            sessionManager = new SessionManager(this);&#10;        }&#10;        loadingDialog = new LoadingDialog(this);&#10;        threadManager = ThreadManager.getInstance();&#10;&#10;        // Configurar el formulario según el tipo de perfil&#10;        setupFormByProfileType();&#10;&#10;        // Cargar datos de sports y locations&#10;        loadSportsAndLocations();&#10;&#10;        // Configurar el selector de fecha de nacimiento&#10;        setupBirthdatePicker();&#10;&#10;        // Si es modo edición, cargar los datos actuales del perfil&#10;        if (isEditMode) {&#10;            buttonComplete.setText(&quot;Guardar Cambios&quot;);&#10;            loadCurrentProfile();&#10;        }&#10;&#10;        // Configurar el botón de completar/guardar&#10;        buttonComplete.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                if (validateForm()) {&#10;                    if (isEditMode) {&#10;                        updateProfile();&#10;                    } else {&#10;                        completeRegistration();&#10;                    }&#10;                }&#10;            }&#10;        });&#10;&#10;        // Configurar manejo del teclado&#10;        setupKeyboardHandling();&#10;    }&#10;&#10;    private void setupFormByProfileType() {&#10;        Log.d(TAG, &quot;setupFormByProfileType: &quot; + profileType);&#10;&#10;        switch (profileType.toLowerCase()) {&#10;            case &quot;athlete&quot;:&#10;                titleProfileForm.setText(&quot;Perfil de Atleta&quot;);&#10;                editTextName.setHint(&quot;Nombre&quot;);&#10;                editTextLastName.setVisibility(View.VISIBLE);&#10;                editTextLastName.setHint(&quot;Apellido&quot;);&#10;                editTextBirthdate.setVisibility(View.VISIBLE);&#10;                editTextHeight.setVisibility(View.VISIBLE);&#10;                editTextWeight.setVisibility(View.VISIBLE);&#10;                editTextAgency.setVisibility(View.GONE);&#10;                break;&#10;&#10;            case &quot;agent&quot;:&#10;                titleProfileForm.setText(&quot;Perfil de Agente&quot;);&#10;                editTextName.setHint(&quot;Nombre&quot;);&#10;                editTextLastName.setVisibility(View.VISIBLE);&#10;                editTextLastName.setHint(&quot;Apellido&quot;);&#10;                editTextBirthdate.setVisibility(View.GONE);&#10;                editTextHeight.setVisibility(View.GONE);&#10;                editTextWeight.setVisibility(View.GONE);&#10;                editTextDescription.setHint(&quot;Descripción&quot;);&#10;                editTextAgency.setVisibility(View.VISIBLE);&#10;                break;&#10;&#10;            case &quot;team&quot;:&#10;                titleProfileForm.setText(&quot;Perfil de Equipo&quot;);&#10;                editTextName.setHint(&quot;Nombre del equipo&quot;);&#10;                editTextLastName.setVisibility(View.VISIBLE);&#10;                editTextLastName.setHint(&quot;Puesto/Rol&quot;);&#10;                editTextBirthdate.setVisibility(View.GONE);&#10;                editTextHeight.setVisibility(View.GONE);&#10;                editTextWeight.setVisibility(View.GONE);&#10;                editTextAgency.setVisibility(View.GONE);&#10;                break;&#10;        }&#10;    }&#10;&#10;    private void setupBirthdatePicker() {&#10;        // Configurar fecha máxima (hoy)&#10;        final Calendar maxDate = Calendar.getInstance();&#10;&#10;        // Configurar fecha mínima (40 años atrás)&#10;        final Calendar minDate = Calendar.getInstance();&#10;        minDate.add(Calendar.YEAR, -40);&#10;&#10;        // Configurar fecha inicial (18 años atrás, edad mínima típica)&#10;        birthdateCalendar.add(Calendar.YEAR, -18);&#10;&#10;        editTextBirthdate.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                int year = birthdateCalendar.get(Calendar.YEAR);&#10;                int month = birthdateCalendar.get(Calendar.MONTH);&#10;                int day = birthdateCalendar.get(Calendar.DAY_OF_MONTH);&#10;&#10;                DatePickerDialog datePickerDialog = new DatePickerDialog(&#10;                    ProfileFormActivity.this,&#10;                    new DatePickerDialog.OnDateSetListener() {&#10;                        @Override&#10;                        public void onDateSet(DatePicker view, int year, int month, int dayOfMonth) {&#10;                            // Actualizar el calendario con la fecha seleccionada&#10;                            birthdateCalendar.set(Calendar.YEAR, year);&#10;                            birthdateCalendar.set(Calendar.MONTH, month);&#10;                            birthdateCalendar.set(Calendar.DAY_OF_MONTH, dayOfMonth);&#10;&#10;                            // Formato para mostrar al usuario (DD/MM/YYYY)&#10;                            SimpleDateFormat displayFormat = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;, Locale.getDefault());&#10;                            String displayDate = displayFormat.format(birthdateCalendar.getTime());&#10;                            editTextBirthdate.setText(displayDate);&#10;&#10;                            // Formato ISO para enviar al backend (YYYY-MM-DD)&#10;                            SimpleDateFormat isoFormat = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;, Locale.getDefault());&#10;                            selectedBirthdate = isoFormat.format(birthdateCalendar.getTime());&#10;&#10;                            Log.d(TAG, &quot;Fecha seleccionada - Display: &quot; + displayDate + &quot;, ISO: &quot; + selectedBirthdate);&#10;                        }&#10;                    },&#10;                    year, month, day&#10;                );&#10;&#10;                // Configurar fechas límite&#10;                datePickerDialog.getDatePicker().setMaxDate(maxDate.getTimeInMillis());&#10;                datePickerDialog.getDatePicker().setMinDate(minDate.getTimeInMillis());&#10;&#10;                datePickerDialog.show();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void loadSportsAndLocations() {&#10;        loadingDialog.show(&quot;Cargando datos...&quot;);&#10;&#10;        // Cargar deportes&#10;        lookupRepository.getSports(new Callback&lt;List&lt;Sport&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;List&lt;Sport&gt;&gt; call, Response&lt;List&lt;Sport&gt;&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    sportList = response.body();&#10;                    setupSportSpinner();&#10;                    checkIfDataLoaded();&#10;                } else {&#10;                    runOnUiThread(new Runnable() {&#10;                        @Override&#10;                        public void run() {&#10;                            loadingDialog.dismiss();&#10;                            Toast.makeText(ProfileFormActivity.this,&#10;                                &quot;Error al cargar deportes&quot;, Toast.LENGTH_SHORT).show();&#10;                        }&#10;                    });&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;List&lt;Sport&gt;&gt; call, Throwable t) {&#10;                runOnUiThread(new Runnable() {&#10;                    @Override&#10;                    public void run() {&#10;                        loadingDialog.dismiss();&#10;                        Toast.makeText(ProfileFormActivity.this,&#10;                            &quot;Error de conexión al cargar deportes&quot;, Toast.LENGTH_SHORT).show();&#10;                    }&#10;                });&#10;            }&#10;        });&#10;&#10;        // Cargar ubicaciones&#10;        lookupRepository.getLocations(new Callback&lt;List&lt;Location&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;List&lt;Location&gt;&gt; call, Response&lt;List&lt;Location&gt;&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    locationList = response.body();&#10;                    setupLocationSpinner();&#10;                    checkIfDataLoaded();&#10;                } else {&#10;                    runOnUiThread(new Runnable() {&#10;                        @Override&#10;                        public void run() {&#10;                            loadingDialog.dismiss();&#10;                            Toast.makeText(ProfileFormActivity.this,&#10;                                &quot;Error al cargar ubicaciones&quot;, Toast.LENGTH_SHORT).show();&#10;                        }&#10;                    });&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;List&lt;Location&gt;&gt; call, Throwable t) {&#10;                runOnUiThread(new Runnable() {&#10;                    @Override&#10;                    public void run() {&#10;                        loadingDialog.dismiss();&#10;                        Toast.makeText(ProfileFormActivity.this,&#10;                            &quot;Error de conexión al cargar ubicaciones&quot;, Toast.LENGTH_SHORT).show();&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void setupSportSpinner() {&#10;        ArrayAdapter&lt;Sport&gt; adapter = new ArrayAdapter&lt;&gt;(this,&#10;            android.R.layout.simple_spinner_item, sportList);&#10;        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;&#10;        runOnUiThread(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                spinnerSport.setAdapter(adapter);&#10;                spinnerSport.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {&#10;                    @Override&#10;                    public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {&#10;                        selectedSportId = sportList.get(position).getId();&#10;                        Log.d(TAG, &quot;Sport seleccionado: &quot; + sportList.get(position).getName() +&#10;                            &quot; (ID: &quot; + selectedSportId + &quot;)&quot;);&#10;                    }&#10;&#10;                    @Override&#10;                    public void onNothingSelected(AdapterView&lt;?&gt; parent) {&#10;                        selectedSportId = -1;&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void setupLocationSpinner() {&#10;        ArrayAdapter&lt;Location&gt; adapter = new ArrayAdapter&lt;&gt;(this,&#10;            android.R.layout.simple_spinner_item, locationList);&#10;        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;&#10;        runOnUiThread(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                spinnerLocation.setAdapter(adapter);&#10;                spinnerLocation.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {&#10;                    @Override&#10;                    public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {&#10;                        selectedLocationId = locationList.get(position).getId();&#10;                    }&#10;&#10;                    @Override&#10;                    public void onNothingSelected(AdapterView&lt;?&gt; parent) {&#10;                        selectedLocationId = -1;&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void checkIfDataLoaded() {&#10;        if (!sportList.isEmpty() &amp;&amp; !locationList.isEmpty()) {&#10;            runOnUiThread(new Runnable() {&#10;                @Override&#10;                public void run() {&#10;                    loadingDialog.dismiss();&#10;                    Log.d(TAG, &quot;Datos cargados completamente&quot;);&#10;&#10;                    // Si estamos en modo edición y ya tenemos el perfil, llenar el formulario&#10;                    if (isEditMode &amp;&amp; currentProfile != null) {&#10;                        populateFormWithProfileData();&#10;                    }&#10;                }&#10;            });&#10;        }&#10;    }&#10;&#10;    private boolean validateForm() {&#10;        String name = editTextName.getText().toString().trim();&#10;        String phone = editTextPhone.getText().toString().trim();&#10;&#10;        if (name.isEmpty()) {&#10;            Toast.makeText(this, &quot;Por favor, ingresa el nombre&quot;, Toast.LENGTH_SHORT).show();&#10;            return false;&#10;        }&#10;&#10;        if (profileType.equalsIgnoreCase(&quot;athlete&quot;) || profileType.equalsIgnoreCase(&quot;agent&quot;)) {&#10;            String lastName = editTextLastName.getText().toString().trim();&#10;            if (lastName.isEmpty()) {&#10;                Toast.makeText(this, &quot;Por favor, ingresa el apellido&quot;, Toast.LENGTH_SHORT).show();&#10;                return false;&#10;            }&#10;        }&#10;&#10;        if (profileType.equalsIgnoreCase(&quot;athlete&quot;)) {&#10;            String height = editTextHeight.getText().toString().trim();&#10;            String weight = editTextWeight.getText().toString().trim();&#10;&#10;            if (selectedBirthdate.isEmpty()) {&#10;                Toast.makeText(this, &quot;Por favor, selecciona tu fecha de nacimiento&quot;, Toast.LENGTH_SHORT).show();&#10;                return false;&#10;            }&#10;&#10;            if (height.isEmpty() || weight.isEmpty()) {&#10;                Toast.makeText(this, &quot;Por favor, completa todos los campos obligatorios&quot;, Toast.LENGTH_SHORT).show();&#10;                return false;&#10;            }&#10;        }&#10;&#10;        if (profileType.equalsIgnoreCase(&quot;team&quot;)) {&#10;            String job = editTextLastName.getText().toString().trim();&#10;            if (job.isEmpty()) {&#10;                Toast.makeText(this, &quot;Por favor, ingresa el puesto/rol&quot;, Toast.LENGTH_SHORT).show();&#10;                return false;&#10;            }&#10;        }&#10;&#10;        if (selectedLocationId == -1 || selectedSportId == -1) {&#10;            Toast.makeText(this, &quot;Por favor, selecciona ubicación y deporte&quot;, Toast.LENGTH_SHORT).show();&#10;            return false;&#10;        }&#10;&#10;        if (phone.isEmpty()) {&#10;            Toast.makeText(this, &quot;Por favor, ingresa el número de teléfono&quot;, Toast.LENGTH_SHORT).show();&#10;            return false;&#10;        }&#10;&#10;        return true;&#10;    }&#10;&#10;    private void completeRegistration() {&#10;        Log.d(TAG, &quot;completeRegistration: Iniciando&quot;);&#10;&#10;        // Mostrar diálogo de carga&#10;        loadingDialog.show(&quot;Creando perfil...&quot;);&#10;        buttonComplete.setEnabled(false);&#10;&#10;        // Crear el objeto ProfileRequest en segundo plano&#10;        threadManager.executeInBackground(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                final ProfileRequest profileRequest = new ProfileRequest();&#10;                profileRequest.setProfileType(profileType.toLowerCase());&#10;                profileRequest.setName(editTextName.getText().toString().trim());&#10;                profileRequest.setDescription(editTextDescription.getText().toString().trim());&#10;                profileRequest.setPhoneNumber(editTextPhone.getText().toString().trim());&#10;                profileRequest.setIgUser(editTextInstagram.getText().toString().trim());&#10;                profileRequest.setxUser(editTextTwitter.getText().toString().trim());&#10;                profileRequest.setLocationId(selectedLocationId);&#10;                profileRequest.setSportId(selectedSportId);&#10;&#10;                // Campos específicos según el tipo de perfil&#10;                if (profileType.equalsIgnoreCase(&quot;athlete&quot;)) {&#10;                    profileRequest.setLastName(editTextLastName.getText().toString().trim());&#10;                    // Usar la fecha en formato ISO (YYYY-MM-DD)&#10;                    profileRequest.setBirthdate(selectedBirthdate);&#10;                    profileRequest.setHeight(editTextHeight.getText().toString().trim());&#10;                    profileRequest.setWeight(editTextWeight.getText().toString().trim());&#10;                } else if (profileType.equalsIgnoreCase(&quot;agent&quot;)) {&#10;                    profileRequest.setLastName(editTextLastName.getText().toString().trim());&#10;                    profileRequest.setAgency(editTextAgency.getText().toString().trim());&#10;                } else if (profileType.equalsIgnoreCase(&quot;team&quot;)) {&#10;                    profileRequest.setJob(editTextLastName.getText().toString().trim());&#10;                }&#10;&#10;                // Enviar al backend&#10;                authRepository.createProfile(token, profileRequest, new Callback&lt;ProfileResponse&gt;() {&#10;                    @Override&#10;                    public void onResponse(Call&lt;ProfileResponse&gt; call, Response&lt;ProfileResponse&gt; response) {&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonComplete.setEnabled(true);&#10;&#10;                                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                                    // Si la respuesta HTTP es exitosa (200-299), el perfil se creó correctamente&#10;&#10;                                    // Guardar la sesión en segundo plano&#10;                                    threadManager.executeInBackground(new Runnable() {&#10;                                        @Override&#10;                                        public void run() {&#10;                                            sessionManager.saveSession(token, userId, email, profileType);&#10;&#10;                                            // Navegar en el hilo principal&#10;                                            threadManager.executeOnMainThread(new Runnable() {&#10;                                                @Override&#10;                                                public void run() {&#10;                                                    Toast.makeText(ProfileFormActivity.this,&#10;                                                        &quot;¡Perfil creado exitosamente!&quot;, Toast.LENGTH_SHORT).show();&#10;&#10;                                                    // Pequeño delay para mostrar el mensaje&#10;                                                    threadManager.executeWithDelay(new Runnable() {&#10;                                                        @Override&#10;                                                        public void run() {&#10;                                                            Log.d(TAG, &quot;Navegando a HomeActivity...&quot;);&#10;                                                            Intent intent = new Intent(ProfileFormActivity.this, HomeActivity.class);&#10;                                                            startActivity(intent);&#10;                                                            finish();&#10;                                                        }&#10;                                                    }, 500);&#10;                                                }&#10;                                            });&#10;                                        }&#10;                                    });&#10;                                } else {&#10;                                    // Manejar error del servidor&#10;                                    Log.e(TAG, &quot;Error al crear perfil - Status: &quot; + response.code());&#10;                                    String errorMsg = &quot;Error al crear perfil&quot;;&#10;&#10;                                    try {&#10;                                        if (response.errorBody() != null) {&#10;                                            String errorBody = response.errorBody().string();&#10;                                            Log.e(TAG, &quot;Error body: &quot; + errorBody);&#10;                                            // Intentar extraer el mensaje de error del JSON&#10;                                            if (errorBody.contains(&quot;message&quot;)) {&#10;                                                int start = errorBody.indexOf(&quot;\&quot;message\&quot;:\&quot;&quot;) + 11;&#10;                                                int end = errorBody.indexOf(&quot;\&quot;&quot;, start);&#10;                                                if (start &gt; 10 &amp;&amp; end &gt; start) {&#10;                                                    errorMsg = errorBody.substring(start, end);&#10;                                                }&#10;                                            }&#10;                                        }&#10;                                    } catch (Exception e) {&#10;                                        Log.e(TAG, &quot;Error al parsear error body: &quot; + e.getMessage());&#10;                                    }&#10;&#10;                                    Toast.makeText(ProfileFormActivity.this,&#10;                                        errorMsg, Toast.LENGTH_LONG).show();&#10;                                }&#10;                            }&#10;                        });&#10;                    }&#10;&#10;                    @Override&#10;                    public void onFailure(Call&lt;ProfileResponse&gt; call, Throwable t) {&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonComplete.setEnabled(true);&#10;&#10;                                String errorMsg = t.getMessage();&#10;                                if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                    errorMsg = &quot;Error desconocido&quot;;&#10;                                }&#10;                                Toast.makeText(ProfileFormActivity.this,&#10;                                    &quot;Error de conexión: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                            }&#10;                        });&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void loadCurrentProfile() {&#10;        Log.d(TAG, &quot;loadCurrentProfile: Cargando perfil del usuario autenticado&quot;);&#10;        loadingDialog.show(&quot;Cargando perfil...&quot;);&#10;&#10;        authRepository.getProfile(token, new Callback&lt;GetProfileResponse&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;GetProfileResponse&gt; call, Response&lt;GetProfileResponse&gt; response) {&#10;                loadingDialog.dismiss();&#10;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    GetProfileResponse profileResponse = response.body();&#10;                    if (profileResponse.getProfile() != null) {&#10;                        currentProfile = profileResponse.getProfile();&#10;                        profileId = currentProfile.getId(); // Guardar el ID del perfil para la actualización&#10;&#10;                        // Intentar obtener el profileType del nivel superior primero, si no, del objeto profile&#10;                        profileType = profileResponse.getProfileType();&#10;                        if (profileType == null || profileType.isEmpty()) {&#10;                            profileType = currentProfile.getProfileType();&#10;                        }&#10;&#10;                        Log.d(TAG, &quot;loadCurrentProfile: profileType cargado = &quot; + profileType);&#10;&#10;                        // Reconfigurar el formulario con el tipo de perfil correcto&#10;                        setupFormByProfileType();&#10;&#10;                        populateFormWithProfileData();&#10;                    } else {&#10;                        Toast.makeText(ProfileFormActivity.this,&#10;                            &quot;Error: Perfil no encontrado&quot;,&#10;                            Toast.LENGTH_SHORT).show();&#10;                        finish();&#10;                    }&#10;                } else {&#10;                    Log.e(TAG, &quot;Error al cargar perfil: &quot; + response.code());&#10;                    Toast.makeText(ProfileFormActivity.this,&#10;                        &quot;Error al cargar el perfil&quot;,&#10;                        Toast.LENGTH_SHORT).show();&#10;                    finish();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;GetProfileResponse&gt; call, Throwable t) {&#10;                loadingDialog.dismiss();&#10;                Log.e(TAG, &quot;Error de conexión: &quot; + t.getMessage());&#10;                Toast.makeText(ProfileFormActivity.this,&#10;                    &quot;Error de conexión&quot;,&#10;                    Toast.LENGTH_SHORT).show();&#10;                finish();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void populateFormWithProfileData() {&#10;        if (currentProfile == null) return;&#10;&#10;        Log.d(TAG, &quot;populateFormWithProfileData: Llenando formulario con datos&quot;);&#10;&#10;        // Llenar campos comunes&#10;        editTextName.setText(currentProfile.getName());&#10;        editTextDescription.setText(currentProfile.getDescription());&#10;        editTextPhone.setText(currentProfile.getPhoneNumber());&#10;        editTextInstagram.setText(currentProfile.getIgUser());&#10;        editTextTwitter.setText(currentProfile.getxUser());&#10;&#10;        // Seleccionar ubicación en el spinner&#10;        if (currentProfile.getLocationId() != null &amp;&amp; !locationList.isEmpty()) {&#10;            for (int i = 0; i &lt; locationList.size(); i++) {&#10;                if (locationList.get(i).getId() == currentProfile.getLocationId()) {&#10;                    spinnerLocation.setSelection(i);&#10;                    selectedLocationId = currentProfile.getLocationId();&#10;                    break;&#10;                }&#10;            }&#10;        }&#10;&#10;        // Seleccionar deporte en el spinner&#10;        if (currentProfile.getSportId() != null &amp;&amp; !sportList.isEmpty()) {&#10;            for (int i = 0; i &lt; sportList.size(); i++) {&#10;                if (sportList.get(i).getId() == currentProfile.getSportId()) {&#10;                    spinnerSport.setSelection(i);&#10;                    selectedSportId = currentProfile.getSportId();&#10;                    break;&#10;                }&#10;            }&#10;        }&#10;&#10;        // Llenar campos específicos por tipo de perfil&#10;        if (&quot;athlete&quot;.equalsIgnoreCase(profileType)) {&#10;            editTextLastName.setText(currentProfile.getLastName());&#10;            editTextHeight.setText(currentProfile.getHeight());&#10;            editTextWeight.setText(currentProfile.getWeight());&#10;&#10;            // Convertir fecha de ISO (YYYY-MM-DD) a formato display (DD/MM/YYYY)&#10;            if (currentProfile.getBirthdate() != null &amp;&amp; !currentProfile.getBirthdate().isEmpty()) {&#10;                selectedBirthdate = currentProfile.getBirthdate();&#10;                String displayDate = formatDateForDisplay(currentProfile.getBirthdate());&#10;                editTextBirthdate.setText(displayDate);&#10;&#10;                // Actualizar el calendario&#10;                try {&#10;                    String[] parts = currentProfile.getBirthdate().split(&quot;-&quot;);&#10;                    if (parts.length == 3) {&#10;                        birthdateCalendar.set(Calendar.YEAR, Integer.parseInt(parts[0]));&#10;                        birthdateCalendar.set(Calendar.MONTH, Integer.parseInt(parts[1]) - 1);&#10;                        birthdateCalendar.set(Calendar.DAY_OF_MONTH, Integer.parseInt(parts[2]));&#10;                    }&#10;                } catch (Exception e) {&#10;                    Log.e(TAG, &quot;Error al parsear fecha: &quot; + e.getMessage());&#10;                }&#10;            }&#10;        } else if (&quot;agent&quot;.equalsIgnoreCase(profileType)) {&#10;            editTextLastName.setText(currentProfile.getLastName());&#10;            editTextAgency.setText(currentProfile.getAgency());&#10;        } else if (&quot;team&quot;.equalsIgnoreCase(profileType)) {&#10;            editTextLastName.setText(currentProfile.getJob());&#10;        }&#10;    }&#10;&#10;    private String formatDateForDisplay(String isoDate) {&#10;        // Convertir de YYYY-MM-DD a DD/MM/YYYY&#10;        if (isoDate != null &amp;&amp; isoDate.length() == 10) {&#10;            String[] parts = isoDate.split(&quot;-&quot;);&#10;            if (parts.length == 3) {&#10;                return parts[2] + &quot;/&quot; + parts[1] + &quot;/&quot; + parts[0];&#10;            }&#10;        }&#10;        return isoDate;&#10;    }&#10;&#10;    private void updateProfile() {&#10;        Log.d(TAG, &quot;updateProfile: Actualizando perfil&quot;);&#10;&#10;        loadingDialog.show(&quot;Actualizando perfil...&quot;);&#10;        buttonComplete.setEnabled(false);&#10;&#10;        threadManager.executeInBackground(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                // Crear el objeto UpdateProfileRequest con la estructura correcta&#10;                final UpdateProfileRequest updateRequest = new UpdateProfileRequest();&#10;&#10;                // Crear el objeto profileUpdates&#10;                UpdateProfileRequest.ProfileUpdates profileUpdates = new UpdateProfileRequest.ProfileUpdates();&#10;                profileUpdates.setName(editTextName.getText().toString().trim());&#10;                profileUpdates.setDescription(editTextDescription.getText().toString().trim());&#10;                profileUpdates.setPhoneNumber(editTextPhone.getText().toString().trim());&#10;                profileUpdates.setIgUser(editTextInstagram.getText().toString().trim());&#10;                profileUpdates.setxUser(editTextTwitter.getText().toString().trim());&#10;                profileUpdates.setLocationId(selectedLocationId);&#10;                profileUpdates.setSportId(selectedSportId);&#10;&#10;                // Campos específicos según el tipo de perfil&#10;                if (profileType.equalsIgnoreCase(&quot;athlete&quot;)) {&#10;                    profileUpdates.setLastName(editTextLastName.getText().toString().trim());&#10;                    profileUpdates.setBirthdate(selectedBirthdate);&#10;                    profileUpdates.setHeight(editTextHeight.getText().toString().trim());&#10;                    profileUpdates.setWeight(editTextWeight.getText().toString().trim());&#10;                } else if (profileType.equalsIgnoreCase(&quot;agent&quot;)) {&#10;                    profileUpdates.setLastName(editTextLastName.getText().toString().trim());&#10;                    profileUpdates.setAgency(editTextAgency.getText().toString().trim());&#10;                } else if (profileType.equalsIgnoreCase(&quot;team&quot;)) {&#10;                    profileUpdates.setJob(editTextLastName.getText().toString().trim());&#10;                }&#10;&#10;                // Establecer profileUpdates en el request&#10;                updateRequest.setProfileUpdates(profileUpdates);&#10;&#10;                Log.d(TAG, &quot;updateProfile: Enviando actualización al backend&quot;);&#10;&#10;                // Enviar al backend&#10;                authRepository.updateProfile(token, updateRequest, new Callback&lt;ProfileResponse&gt;() {&#10;                    @Override&#10;                    public void onResponse(Call&lt;ProfileResponse&gt; call, Response&lt;ProfileResponse&gt; response) {&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonComplete.setEnabled(true);&#10;&#10;                                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                                    Log.d(TAG, &quot;Perfil actualizado exitosamente&quot;);&#10;                                    Toast.makeText(ProfileFormActivity.this,&#10;                                        &quot;Perfil actualizado exitosamente&quot;, Toast.LENGTH_SHORT).show();&#10;&#10;                                    // Volver a la pantalla anterior&#10;                                    finish();&#10;                                } else {&#10;                                    Log.e(TAG, &quot;Error al actualizar perfil - Status: &quot; + response.code());&#10;                                    String errorMsg = &quot;Error al actualizar perfil&quot;;&#10;&#10;                                    try {&#10;                                        if (response.errorBody() != null) {&#10;                                            String errorBody = response.errorBody().string();&#10;                                            Log.e(TAG, &quot;Error body: &quot; + errorBody);&#10;                                            if (errorBody.contains(&quot;message&quot;)) {&#10;                                                int start = errorBody.indexOf(&quot;\&quot;message\&quot;:\&quot;&quot;) + 11;&#10;                                                int end = errorBody.indexOf(&quot;\&quot;&quot;, start);&#10;                                                if (start &gt; 10 &amp;&amp; end &gt; start) {&#10;                                                    errorMsg = errorBody.substring(start, end);&#10;                                                }&#10;                                            }&#10;                                        }&#10;                                    } catch (Exception e) {&#10;                                        Log.e(TAG, &quot;Error al parsear error body: &quot; + e.getMessage());&#10;                                    }&#10;&#10;                                    Toast.makeText(ProfileFormActivity.this,&#10;                                        errorMsg, Toast.LENGTH_LONG).show();&#10;                                }&#10;                            }&#10;                        });&#10;                    }&#10;&#10;                    @Override&#10;                    public void onFailure(Call&lt;ProfileResponse&gt; call, Throwable t) {&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonComplete.setEnabled(true);&#10;&#10;                                String errorMsg = t.getMessage();&#10;                                if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                    errorMsg = &quot;Error desconocido&quot;;&#10;                                }&#10;                                Toast.makeText(ProfileFormActivity.this,&#10;                                    &quot;Error de conexión: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                            }&#10;                        });&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void setupKeyboardHandling() {&#10;        // Lista de todos los EditText que necesitan scroll automático&#10;        EditText[] editTexts = {&#10;            editTextName, editTextLastName, editTextBirthdate,&#10;            editTextHeight, editTextWeight, editTextPhone,&#10;            editTextInstagram, editTextTwitter, editTextDescription, editTextAgency&#10;        };&#10;&#10;        for (EditText editText : editTexts) {&#10;            if (editText != null) {&#10;                editText.setOnFocusChangeListener((v, hasFocus) -&gt; {&#10;                    if (hasFocus) {&#10;                        // Desplazar después de un pequeño delay para asegurar que el teclado esté visible&#10;                        v.postDelayed(() -&gt; {&#10;                            v.getParent().requestChildFocus(v, v);&#10;                        }, 200);&#10;                    }&#10;                });&#10;            }&#10;        }&#10;    }&#10;&#10;    @Override&#10;    protected void onDestroy() {&#10;        super.onDestroy();&#10;        // Cerrar el diálogo si está abierto&#10;        if (loadingDialog != null &amp;&amp; loadingDialog.isShowing()) {&#10;            loadingDialog.dismiss();&#10;        }&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.sportconnection;&#10;&#10;import android.app.DatePickerDialog;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.util.Log;&#10;import android.view.View;&#10;import android.widget.AdapterView;&#10;import android.widget.ArrayAdapter;&#10;import android.widget.Button;&#10;import android.widget.DatePicker;&#10;import android.widget.EditText;&#10;import android.widget.Spinner;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;&#10;import java.text.SimpleDateFormat;&#10;import java.util.Calendar;&#10;import java.util.Locale;&#10;&#10;import com.example.sportconnection.model.Location;&#10;import com.example.sportconnection.model.ProfileRequest;&#10;import com.example.sportconnection.model.ProfileResponse;&#10;import com.example.sportconnection.model.GetProfileResponse;&#10;import com.example.sportconnection.model.UpdateProfileRequest;&#10;import com.example.sportconnection.model.Sport;&#10;import com.example.sportconnection.repository.AuthRepository;&#10;import com.example.sportconnection.repository.LookupRepository;&#10;import com.example.sportconnection.utils.LoadingDialog;&#10;import com.example.sportconnection.utils.SessionManager;&#10;import com.example.sportconnection.utils.ThreadManager;&#10;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class ProfileFormActivity extends AppCompatActivity {&#10;&#10;    private static final String TAG = &quot;ProfileFormActivity&quot;;&#10;&#10;    private TextView titleProfileForm;&#10;    private EditText editTextName, editTextLastName, editTextBirthdate;&#10;    private EditText editTextHeight, editTextWeight;&#10;    private Spinner spinnerLocation, spinnerSport;&#10;    private EditText editTextPhone, editTextInstagram;&#10;    private EditText editTextTwitter, editTextDescription, editTextAgency;&#10;    private Button buttonComplete;&#10;&#10;    private String email, password, profileType, token;&#10;    private int userId;&#10;&#10;    // Variables para modo edición&#10;    private boolean isEditMode = false;&#10;    private int profileId = -1;&#10;    private GetProfileResponse.ProfileData currentProfile;&#10;&#10;    private AuthRepository authRepository;&#10;    private LookupRepository lookupRepository;&#10;    private SessionManager sessionManager;&#10;    private LoadingDialog loadingDialog;&#10;    private ThreadManager threadManager;&#10;&#10;    private List&lt;Sport&gt; sportList = new ArrayList&lt;&gt;();&#10;    private List&lt;Location&gt; locationList = new ArrayList&lt;&gt;();&#10;    private int selectedSportId = -1;&#10;    private int selectedLocationId = -1;&#10;&#10;    private String selectedBirthdate = &quot;&quot;; // Formato ISO: YYYY-MM-DD&#10;    private Calendar birthdateCalendar = Calendar.getInstance();&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_profile_form);&#10;&#10;        // Obtener datos del Intent&#10;        isEditMode = getIntent().getBooleanExtra(&quot;isEditMode&quot;, false);&#10;&#10;        if (isEditMode) {&#10;            // Modo edición - obtener desde sesión o intent&#10;            sessionManager = new SessionManager(this);&#10;            token = sessionManager.getToken();&#10;            userId = sessionManager.getUserId();&#10;            email = sessionManager.getEmail();&#10;            &#10;            // Intentar obtener profileType del intent primero (más confiable), si no, de la sesión&#10;            profileType = getIntent().getStringExtra(&quot;profileType&quot;);&#10;            if (profileType == null) {&#10;                profileType = sessionManager.getProfileType();&#10;            }&#10;        } else {&#10;            // Modo creación - obtener desde intent&#10;            email = getIntent().getStringExtra(&quot;email&quot;);&#10;            password = getIntent().getStringExtra(&quot;password&quot;);&#10;            profileType = getIntent().getStringExtra(&quot;profileType&quot;);&#10;            token = getIntent().getStringExtra(&quot;token&quot;);&#10;            userId = getIntent().getIntExtra(&quot;userId&quot;, -1);&#10;        }&#10;&#10;        // Inicializar vistas&#10;        titleProfileForm = findViewById(R.id.titleProfileForm);&#10;        editTextName = findViewById(R.id.editTextName);&#10;        editTextLastName = findViewById(R.id.editTextLastName);&#10;        editTextBirthdate = findViewById(R.id.editTextBirthdate);&#10;        editTextHeight = findViewById(R.id.editTextHeight);&#10;        editTextWeight = findViewById(R.id.editTextWeight);&#10;        spinnerLocation = findViewById(R.id.spinnerLocation);&#10;        spinnerSport = findViewById(R.id.spinnerSport);&#10;        editTextPhone = findViewById(R.id.editTextPhone);&#10;        editTextInstagram = findViewById(R.id.editTextInstagram);&#10;        editTextTwitter = findViewById(R.id.editTextTwitter);&#10;        editTextDescription = findViewById(R.id.editTextDescription);&#10;        editTextAgency = findViewById(R.id.editTextAgency);&#10;        buttonComplete = findViewById(R.id.buttonComplete);&#10;&#10;        // Inicializar repositorios y utilidades&#10;        authRepository = new AuthRepository();&#10;        lookupRepository = new LookupRepository();&#10;        if (sessionManager == null) {&#10;            sessionManager = new SessionManager(this);&#10;        }&#10;        loadingDialog = new LoadingDialog(this);&#10;        threadManager = ThreadManager.getInstance();&#10;&#10;        // Configurar el formulario según el tipo de perfil&#10;        setupFormByProfileType();&#10;&#10;        // Cargar datos de sports y locations&#10;        loadSportsAndLocations();&#10;&#10;        // Configurar el selector de fecha de nacimiento&#10;        setupBirthdatePicker();&#10;&#10;        // Si es modo edición, cargar los datos actuales del perfil&#10;        if (isEditMode) {&#10;            buttonComplete.setText(&quot;Guardar Cambios&quot;);&#10;            loadCurrentProfile();&#10;        }&#10;&#10;        // Configurar el botón de completar/guardar&#10;        buttonComplete.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                if (validateForm()) {&#10;                    if (isEditMode) {&#10;                        updateProfile();&#10;                    } else {&#10;                        completeRegistration();&#10;                    }&#10;                }&#10;            }&#10;        });&#10;&#10;        // Configurar manejo del teclado&#10;        setupKeyboardHandling();&#10;    }&#10;&#10;    private void setupFormByProfileType() {&#10;        Log.d(TAG, &quot;setupFormByProfileType: &quot; + profileType);&#10;&#10;        switch (profileType.toLowerCase()) {&#10;            case &quot;athlete&quot;:&#10;                titleProfileForm.setText(&quot;Perfil de Atleta&quot;);&#10;                editTextName.setHint(&quot;Nombre&quot;);&#10;                editTextLastName.setVisibility(View.VISIBLE);&#10;                editTextLastName.setHint(&quot;Apellido&quot;);&#10;                editTextBirthdate.setVisibility(View.VISIBLE);&#10;                editTextHeight.setVisibility(View.VISIBLE);&#10;                editTextWeight.setVisibility(View.VISIBLE);&#10;                editTextAgency.setVisibility(View.GONE);&#10;                break;&#10;&#10;            case &quot;agent&quot;:&#10;                titleProfileForm.setText(&quot;Perfil de Agente&quot;);&#10;                editTextName.setHint(&quot;Nombre&quot;);&#10;                editTextLastName.setVisibility(View.VISIBLE);&#10;                editTextLastName.setHint(&quot;Apellido&quot;);&#10;                editTextBirthdate.setVisibility(View.GONE);&#10;                editTextHeight.setVisibility(View.GONE);&#10;                editTextWeight.setVisibility(View.GONE);&#10;                editTextDescription.setHint(&quot;Descripción&quot;);&#10;                editTextAgency.setVisibility(View.VISIBLE);&#10;                break;&#10;&#10;            case &quot;team&quot;:&#10;                titleProfileForm.setText(&quot;Perfil de Equipo&quot;);&#10;                editTextName.setHint(&quot;Nombre del equipo&quot;);&#10;                editTextLastName.setVisibility(View.VISIBLE);&#10;                editTextLastName.setHint(&quot;Puesto/Rol&quot;);&#10;                editTextBirthdate.setVisibility(View.GONE);&#10;                editTextHeight.setVisibility(View.GONE);&#10;                editTextWeight.setVisibility(View.GONE);&#10;                editTextAgency.setVisibility(View.GONE);&#10;                break;&#10;        }&#10;    }&#10;&#10;    private void setupBirthdatePicker() {&#10;        // Configurar fecha máxima (hoy)&#10;        final Calendar maxDate = Calendar.getInstance();&#10;&#10;        // Configurar fecha mínima (40 años atrás)&#10;        final Calendar minDate = Calendar.getInstance();&#10;        minDate.add(Calendar.YEAR, -40);&#10;&#10;        // Configurar fecha inicial (18 años atrás, edad mínima típica)&#10;        birthdateCalendar.add(Calendar.YEAR, -18);&#10;&#10;        editTextBirthdate.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                int year = birthdateCalendar.get(Calendar.YEAR);&#10;                int month = birthdateCalendar.get(Calendar.MONTH);&#10;                int day = birthdateCalendar.get(Calendar.DAY_OF_MONTH);&#10;&#10;                DatePickerDialog datePickerDialog = new DatePickerDialog(&#10;                    ProfileFormActivity.this,&#10;                    new DatePickerDialog.OnDateSetListener() {&#10;                        @Override&#10;                        public void onDateSet(DatePicker view, int year, int month, int dayOfMonth) {&#10;                            // Actualizar el calendario con la fecha seleccionada&#10;                            birthdateCalendar.set(Calendar.YEAR, year);&#10;                            birthdateCalendar.set(Calendar.MONTH, month);&#10;                            birthdateCalendar.set(Calendar.DAY_OF_MONTH, dayOfMonth);&#10;&#10;                            // Formato para mostrar al usuario (DD/MM/YYYY)&#10;                            SimpleDateFormat displayFormat = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;, Locale.getDefault());&#10;                            String displayDate = displayFormat.format(birthdateCalendar.getTime());&#10;                            editTextBirthdate.setText(displayDate);&#10;&#10;                            // Formato ISO para enviar al backend (YYYY-MM-DD)&#10;                            SimpleDateFormat isoFormat = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;, Locale.getDefault());&#10;                            selectedBirthdate = isoFormat.format(birthdateCalendar.getTime());&#10;&#10;                            Log.d(TAG, &quot;Fecha seleccionada - Display: &quot; + displayDate + &quot;, ISO: &quot; + selectedBirthdate);&#10;                        }&#10;                    },&#10;                    year, month, day&#10;                );&#10;&#10;                // Configurar fechas límite&#10;                datePickerDialog.getDatePicker().setMaxDate(maxDate.getTimeInMillis());&#10;                datePickerDialog.getDatePicker().setMinDate(minDate.getTimeInMillis());&#10;&#10;                datePickerDialog.show();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void loadSportsAndLocations() {&#10;        loadingDialog.show(&quot;Cargando datos...&quot;);&#10;&#10;        // Cargar deportes&#10;        lookupRepository.getSports(new Callback&lt;List&lt;Sport&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;List&lt;Sport&gt;&gt; call, Response&lt;List&lt;Sport&gt;&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    sportList = response.body();&#10;                    setupSportSpinner();&#10;                    checkIfDataLoaded();&#10;                } else {&#10;                    runOnUiThread(new Runnable() {&#10;                        @Override&#10;                        public void run() {&#10;                            loadingDialog.dismiss();&#10;                            Toast.makeText(ProfileFormActivity.this,&#10;                                &quot;Error al cargar deportes&quot;, Toast.LENGTH_SHORT).show();&#10;                        }&#10;                    });&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;List&lt;Sport&gt;&gt; call, Throwable t) {&#10;                runOnUiThread(new Runnable() {&#10;                    @Override&#10;                    public void run() {&#10;                        loadingDialog.dismiss();&#10;                        Toast.makeText(ProfileFormActivity.this,&#10;                            &quot;Error de conexión al cargar deportes&quot;, Toast.LENGTH_SHORT).show();&#10;                    }&#10;                });&#10;            }&#10;        });&#10;&#10;        // Cargar ubicaciones&#10;        lookupRepository.getLocations(new Callback&lt;List&lt;Location&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;List&lt;Location&gt;&gt; call, Response&lt;List&lt;Location&gt;&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    locationList = response.body();&#10;                    setupLocationSpinner();&#10;                    checkIfDataLoaded();&#10;                } else {&#10;                    runOnUiThread(new Runnable() {&#10;                        @Override&#10;                        public void run() {&#10;                            loadingDialog.dismiss();&#10;                            Toast.makeText(ProfileFormActivity.this,&#10;                                &quot;Error al cargar ubicaciones&quot;, Toast.LENGTH_SHORT).show();&#10;                        }&#10;                    });&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;List&lt;Location&gt;&gt; call, Throwable t) {&#10;                runOnUiThread(new Runnable() {&#10;                    @Override&#10;                    public void run() {&#10;                        loadingDialog.dismiss();&#10;                        Toast.makeText(ProfileFormActivity.this,&#10;                            &quot;Error de conexión al cargar ubicaciones&quot;, Toast.LENGTH_SHORT).show();&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void setupSportSpinner() {&#10;        ArrayAdapter&lt;Sport&gt; adapter = new ArrayAdapter&lt;&gt;(this,&#10;            android.R.layout.simple_spinner_item, sportList);&#10;        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;&#10;        runOnUiThread(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                spinnerSport.setAdapter(adapter);&#10;                spinnerSport.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {&#10;                    @Override&#10;                    public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {&#10;                        selectedSportId = sportList.get(position).getId();&#10;                        Log.d(TAG, &quot;Sport seleccionado: &quot; + sportList.get(position).getName() +&#10;                            &quot; (ID: &quot; + selectedSportId + &quot;)&quot;);&#10;                    }&#10;&#10;                    @Override&#10;                    public void onNothingSelected(AdapterView&lt;?&gt; parent) {&#10;                        selectedSportId = -1;&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void setupLocationSpinner() {&#10;        ArrayAdapter&lt;Location&gt; adapter = new ArrayAdapter&lt;&gt;(this,&#10;            android.R.layout.simple_spinner_item, locationList);&#10;        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;&#10;        runOnUiThread(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                spinnerLocation.setAdapter(adapter);&#10;                spinnerLocation.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {&#10;                    @Override&#10;                    public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {&#10;                        selectedLocationId = locationList.get(position).getId();&#10;                    }&#10;&#10;                    @Override&#10;                    public void onNothingSelected(AdapterView&lt;?&gt; parent) {&#10;                        selectedLocationId = -1;&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void checkIfDataLoaded() {&#10;        if (!sportList.isEmpty() &amp;&amp; !locationList.isEmpty()) {&#10;            runOnUiThread(new Runnable() {&#10;                @Override&#10;                public void run() {&#10;                    loadingDialog.dismiss();&#10;                    Log.d(TAG, &quot;Datos cargados completamente&quot;);&#10;&#10;                    // Si estamos en modo edición y ya tenemos el perfil, llenar el formulario&#10;                    if (isEditMode &amp;&amp; currentProfile != null) {&#10;                        populateFormWithProfileData();&#10;                    }&#10;                }&#10;            });&#10;        }&#10;    }&#10;&#10;    private boolean validateForm() {&#10;        String name = editTextName.getText().toString().trim();&#10;        String phone = editTextPhone.getText().toString().trim();&#10;&#10;        if (name.isEmpty()) {&#10;            Toast.makeText(this, &quot;Por favor, ingresa el nombre&quot;, Toast.LENGTH_SHORT).show();&#10;            return false;&#10;        }&#10;&#10;        if (profileType.equalsIgnoreCase(&quot;athlete&quot;) || profileType.equalsIgnoreCase(&quot;agent&quot;)) {&#10;            String lastName = editTextLastName.getText().toString().trim();&#10;            if (lastName.isEmpty()) {&#10;                Toast.makeText(this, &quot;Por favor, ingresa el apellido&quot;, Toast.LENGTH_SHORT).show();&#10;                return false;&#10;            }&#10;        }&#10;&#10;        if (profileType.equalsIgnoreCase(&quot;athlete&quot;)) {&#10;            String height = editTextHeight.getText().toString().trim();&#10;            String weight = editTextWeight.getText().toString().trim();&#10;&#10;            if (selectedBirthdate.isEmpty()) {&#10;                Toast.makeText(this, &quot;Por favor, selecciona tu fecha de nacimiento&quot;, Toast.LENGTH_SHORT).show();&#10;                return false;&#10;            }&#10;&#10;            if (height.isEmpty() || weight.isEmpty()) {&#10;                Toast.makeText(this, &quot;Por favor, completa todos los campos obligatorios&quot;, Toast.LENGTH_SHORT).show();&#10;                return false;&#10;            }&#10;        }&#10;&#10;        if (profileType.equalsIgnoreCase(&quot;team&quot;)) {&#10;            String job = editTextLastName.getText().toString().trim();&#10;            if (job.isEmpty()) {&#10;                Toast.makeText(this, &quot;Por favor, ingresa el puesto/rol&quot;, Toast.LENGTH_SHORT).show();&#10;                return false;&#10;            }&#10;        }&#10;&#10;        if (selectedLocationId == -1 || selectedSportId == -1) {&#10;            Toast.makeText(this, &quot;Por favor, selecciona ubicación y deporte&quot;, Toast.LENGTH_SHORT).show();&#10;            return false;&#10;        }&#10;&#10;        if (phone.isEmpty()) {&#10;            Toast.makeText(this, &quot;Por favor, ingresa el número de teléfono&quot;, Toast.LENGTH_SHORT).show();&#10;            return false;&#10;        }&#10;&#10;        return true;&#10;    }&#10;&#10;    private void completeRegistration() {&#10;        Log.d(TAG, &quot;completeRegistration: Iniciando&quot;);&#10;&#10;        // Mostrar diálogo de carga&#10;        loadingDialog.show(&quot;Creando perfil...&quot;);&#10;        buttonComplete.setEnabled(false);&#10;&#10;        // Crear el objeto ProfileRequest en segundo plano&#10;        threadManager.executeInBackground(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                final ProfileRequest profileRequest = new ProfileRequest();&#10;                profileRequest.setProfileType(profileType.toLowerCase());&#10;                profileRequest.setName(editTextName.getText().toString().trim());&#10;                profileRequest.setDescription(editTextDescription.getText().toString().trim());&#10;                profileRequest.setPhoneNumber(editTextPhone.getText().toString().trim());&#10;                profileRequest.setIgUser(editTextInstagram.getText().toString().trim());&#10;                profileRequest.setxUser(editTextTwitter.getText().toString().trim());&#10;                profileRequest.setLocationId(selectedLocationId);&#10;                profileRequest.setSportId(selectedSportId);&#10;&#10;                // Campos específicos según el tipo de perfil&#10;                if (profileType.equalsIgnoreCase(&quot;athlete&quot;)) {&#10;                    profileRequest.setLastName(editTextLastName.getText().toString().trim());&#10;                    // Usar la fecha en formato ISO (YYYY-MM-DD)&#10;                    profileRequest.setBirthdate(selectedBirthdate);&#10;                    profileRequest.setHeight(editTextHeight.getText().toString().trim());&#10;                    profileRequest.setWeight(editTextWeight.getText().toString().trim());&#10;                } else if (profileType.equalsIgnoreCase(&quot;agent&quot;)) {&#10;                    profileRequest.setLastName(editTextLastName.getText().toString().trim());&#10;                    profileRequest.setAgency(editTextAgency.getText().toString().trim());&#10;                } else if (profileType.equalsIgnoreCase(&quot;team&quot;)) {&#10;                    profileRequest.setJob(editTextLastName.getText().toString().trim());&#10;                }&#10;&#10;                // Enviar al backend&#10;                authRepository.createProfile(token, profileRequest, new Callback&lt;ProfileResponse&gt;() {&#10;                    @Override&#10;                    public void onResponse(Call&lt;ProfileResponse&gt; call, Response&lt;ProfileResponse&gt; response) {&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonComplete.setEnabled(true);&#10;&#10;                                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                                    // Si la respuesta HTTP es exitosa (200-299), el perfil se creó correctamente&#10;&#10;                                    // Guardar la sesión en segundo plano&#10;                                    threadManager.executeInBackground(new Runnable() {&#10;                                        @Override&#10;                                        public void run() {&#10;                                            sessionManager.saveSession(token, userId, email, profileType);&#10;&#10;                                            // Navegar en el hilo principal&#10;                                            threadManager.executeOnMainThread(new Runnable() {&#10;                                                @Override&#10;                                                public void run() {&#10;                                                    Toast.makeText(ProfileFormActivity.this,&#10;                                                        &quot;¡Perfil creado exitosamente!&quot;, Toast.LENGTH_SHORT).show();&#10;&#10;                                                    // Pequeño delay para mostrar el mensaje&#10;                                                    threadManager.executeWithDelay(new Runnable() {&#10;                                                        @Override&#10;                                                        public void run() {&#10;                                                            Log.d(TAG, &quot;Navegando a HomeActivity...&quot;);&#10;                                                            Intent intent = new Intent(ProfileFormActivity.this, HomeActivity.class);&#10;                                                            startActivity(intent);&#10;                                                            finish();&#10;                                                        }&#10;                                                    }, 500);&#10;                                                }&#10;                                            });&#10;                                        }&#10;                                    });&#10;                                } else {&#10;                                    // Manejar error del servidor&#10;                                    Log.e(TAG, &quot;Error al crear perfil - Status: &quot; + response.code());&#10;                                    String errorMsg = &quot;Error al crear perfil&quot;;&#10;&#10;                                    try {&#10;                                        if (response.errorBody() != null) {&#10;                                            String errorBody = response.errorBody().string();&#10;                                            Log.e(TAG, &quot;Error body: &quot; + errorBody);&#10;                                            // Intentar extraer el mensaje de error del JSON&#10;                                            if (errorBody.contains(&quot;message&quot;)) {&#10;                                                int start = errorBody.indexOf(&quot;\&quot;message\&quot;:\&quot;&quot;) + 11;&#10;                                                int end = errorBody.indexOf(&quot;\&quot;&quot;, start);&#10;                                                if (start &gt; 10 &amp;&amp; end &gt; start) {&#10;                                                    errorMsg = errorBody.substring(start, end);&#10;                                                }&#10;                                            }&#10;                                        }&#10;                                    } catch (Exception e) {&#10;                                        Log.e(TAG, &quot;Error al parsear error body: &quot; + e.getMessage());&#10;                                    }&#10;&#10;                                    Toast.makeText(ProfileFormActivity.this,&#10;                                        errorMsg, Toast.LENGTH_LONG).show();&#10;                                }&#10;                            }&#10;                        });&#10;                    }&#10;&#10;                    @Override&#10;                    public void onFailure(Call&lt;ProfileResponse&gt; call, Throwable t) {&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonComplete.setEnabled(true);&#10;&#10;                                String errorMsg = t.getMessage();&#10;                                if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                    errorMsg = &quot;Error desconocido&quot;;&#10;                                }&#10;                                Toast.makeText(ProfileFormActivity.this,&#10;                                    &quot;Error de conexión: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                            }&#10;                        });&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void loadCurrentProfile() {&#10;        Log.d(TAG, &quot;loadCurrentProfile: Cargando perfil del usuario autenticado&quot;);&#10;        loadingDialog.show(&quot;Cargando perfil...&quot;);&#10;&#10;        authRepository.getProfile(token, new Callback&lt;GetProfileResponse&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;GetProfileResponse&gt; call, Response&lt;GetProfileResponse&gt; response) {&#10;                loadingDialog.dismiss();&#10;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    GetProfileResponse profileResponse = response.body();&#10;                    if (profileResponse.getProfile() != null) {&#10;                        currentProfile = profileResponse.getProfile();&#10;                        profileId = currentProfile.getId(); // Guardar el ID del perfil para la actualización&#10;&#10;                        // Intentar obtener el profileType del nivel superior primero, si no, del objeto profile&#10;                        profileType = profileResponse.getProfileType();&#10;                        if (profileType == null || profileType.isEmpty()) {&#10;                            profileType = currentProfile.getProfileType();&#10;                        }&#10;&#10;                        Log.d(TAG, &quot;loadCurrentProfile: profileType cargado = &quot; + profileType);&#10;&#10;                        // Reconfigurar el formulario con el tipo de perfil correcto&#10;                        setupFormByProfileType();&#10;&#10;                        populateFormWithProfileData();&#10;                    } else {&#10;                        Toast.makeText(ProfileFormActivity.this,&#10;                            &quot;Error: Perfil no encontrado&quot;,&#10;                            Toast.LENGTH_SHORT).show();&#10;                        finish();&#10;                    }&#10;                } else {&#10;                    Log.e(TAG, &quot;Error al cargar perfil: &quot; + response.code());&#10;                    Toast.makeText(ProfileFormActivity.this,&#10;                        &quot;Error al cargar el perfil&quot;,&#10;                        Toast.LENGTH_SHORT).show();&#10;                    finish();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;GetProfileResponse&gt; call, Throwable t) {&#10;                loadingDialog.dismiss();&#10;                Log.e(TAG, &quot;Error de conexión: &quot; + t.getMessage());&#10;                Toast.makeText(ProfileFormActivity.this,&#10;                    &quot;Error de conexión&quot;,&#10;                    Toast.LENGTH_SHORT).show();&#10;                finish();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void populateFormWithProfileData() {&#10;        if (currentProfile == null) return;&#10;&#10;        Log.d(TAG, &quot;populateFormWithProfileData: Llenando formulario con datos&quot;);&#10;&#10;        // Llenar campos comunes&#10;        editTextName.setText(currentProfile.getName());&#10;        editTextDescription.setText(currentProfile.getDescription());&#10;        editTextPhone.setText(currentProfile.getPhoneNumber());&#10;        editTextInstagram.setText(currentProfile.getIgUser());&#10;        editTextTwitter.setText(currentProfile.getxUser());&#10;&#10;        // Seleccionar ubicación en el spinner&#10;        if (currentProfile.getLocationId() != null &amp;&amp; !locationList.isEmpty()) {&#10;            for (int i = 0; i &lt; locationList.size(); i++) {&#10;                if (locationList.get(i).getId() == currentProfile.getLocationId()) {&#10;                    spinnerLocation.setSelection(i);&#10;                    selectedLocationId = currentProfile.getLocationId();&#10;                    break;&#10;                }&#10;            }&#10;        }&#10;&#10;        // Seleccionar deporte en el spinner&#10;        if (currentProfile.getSportId() != null &amp;&amp; !sportList.isEmpty()) {&#10;            for (int i = 0; i &lt; sportList.size(); i++) {&#10;                if (sportList.get(i).getId() == currentProfile.getSportId()) {&#10;                    spinnerSport.setSelection(i);&#10;                    selectedSportId = currentProfile.getSportId();&#10;                    break;&#10;                }&#10;            }&#10;        }&#10;&#10;        // Llenar campos específicos por tipo de perfil&#10;        if (&quot;athlete&quot;.equalsIgnoreCase(profileType)) {&#10;            editTextLastName.setText(currentProfile.getLastName());&#10;            editTextHeight.setText(currentProfile.getHeight());&#10;            editTextWeight.setText(currentProfile.getWeight());&#10;&#10;            // Convertir fecha de ISO (YYYY-MM-DD) a formato display (DD/MM/YYYY)&#10;            if (currentProfile.getBirthdate() != null &amp;&amp; !currentProfile.getBirthdate().isEmpty()) {&#10;                selectedBirthdate = currentProfile.getBirthdate();&#10;                String displayDate = formatDateForDisplay(currentProfile.getBirthdate());&#10;                editTextBirthdate.setText(displayDate);&#10;&#10;                // Actualizar el calendario&#10;                try {&#10;                    String[] parts = currentProfile.getBirthdate().split(&quot;-&quot;);&#10;                    if (parts.length == 3) {&#10;                        birthdateCalendar.set(Calendar.YEAR, Integer.parseInt(parts[0]));&#10;                        birthdateCalendar.set(Calendar.MONTH, Integer.parseInt(parts[1]) - 1);&#10;                        birthdateCalendar.set(Calendar.DAY_OF_MONTH, Integer.parseInt(parts[2]));&#10;                    }&#10;                } catch (Exception e) {&#10;                    Log.e(TAG, &quot;Error al parsear fecha: &quot; + e.getMessage());&#10;                }&#10;            }&#10;        } else if (&quot;agent&quot;.equalsIgnoreCase(profileType)) {&#10;            editTextLastName.setText(currentProfile.getLastName());&#10;            editTextAgency.setText(currentProfile.getAgency());&#10;        } else if (&quot;team&quot;.equalsIgnoreCase(profileType)) {&#10;            editTextLastName.setText(currentProfile.getJob());&#10;        }&#10;    }&#10;&#10;    private String formatDateForDisplay(String isoDate) {&#10;        // Convertir de YYYY-MM-DD a DD/MM/YYYY&#10;        if (isoDate != null &amp;&amp; isoDate.length() == 10) {&#10;            String[] parts = isoDate.split(&quot;-&quot;);&#10;            if (parts.length == 3) {&#10;                return parts[2] + &quot;/&quot; + parts[1] + &quot;/&quot; + parts[0];&#10;            }&#10;        }&#10;        return isoDate;&#10;    }&#10;&#10;    private void updateProfile() {&#10;        Log.d(TAG, &quot;updateProfile: Actualizando perfil&quot;);&#10;&#10;        loadingDialog.show(&quot;Actualizando perfil...&quot;);&#10;        buttonComplete.setEnabled(false);&#10;&#10;        threadManager.executeInBackground(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                // Crear el objeto UpdateProfileRequest con la estructura correcta&#10;                final UpdateProfileRequest updateRequest = new UpdateProfileRequest();&#10;&#10;                // Crear el objeto profileUpdates&#10;                UpdateProfileRequest.ProfileUpdates profileUpdates = new UpdateProfileRequest.ProfileUpdates();&#10;                profileUpdates.setName(editTextName.getText().toString().trim());&#10;                profileUpdates.setDescription(editTextDescription.getText().toString().trim());&#10;                profileUpdates.setPhoneNumber(editTextPhone.getText().toString().trim());&#10;                profileUpdates.setIgUser(editTextInstagram.getText().toString().trim());&#10;                profileUpdates.setxUser(editTextTwitter.getText().toString().trim());&#10;                profileUpdates.setLocationId(selectedLocationId);&#10;                profileUpdates.setSportId(selectedSportId);&#10;&#10;                // Campos específicos según el tipo de perfil&#10;                if (profileType.equalsIgnoreCase(&quot;athlete&quot;)) {&#10;                    profileUpdates.setLastName(editTextLastName.getText().toString().trim());&#10;                    profileUpdates.setBirthdate(selectedBirthdate);&#10;                    profileUpdates.setHeight(editTextHeight.getText().toString().trim());&#10;                    profileUpdates.setWeight(editTextWeight.getText().toString().trim());&#10;                } else if (profileType.equalsIgnoreCase(&quot;agent&quot;)) {&#10;                    profileUpdates.setLastName(editTextLastName.getText().toString().trim());&#10;                    profileUpdates.setAgency(editTextAgency.getText().toString().trim());&#10;                } else if (profileType.equalsIgnoreCase(&quot;team&quot;)) {&#10;                    profileUpdates.setJob(editTextLastName.getText().toString().trim());&#10;                }&#10;&#10;                // Establecer profileUpdates en el request&#10;                updateRequest.setProfileUpdates(profileUpdates);&#10;&#10;                Log.d(TAG, &quot;updateProfile: Enviando actualización al backend&quot;);&#10;&#10;                // Enviar al backend&#10;                authRepository.updateProfile(token, updateRequest, new Callback&lt;ProfileResponse&gt;() {&#10;                    @Override&#10;                    public void onResponse(Call&lt;ProfileResponse&gt; call, Response&lt;ProfileResponse&gt; response) {&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonComplete.setEnabled(true);&#10;&#10;                                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                                    Log.d(TAG, &quot;Perfil actualizado exitosamente&quot;);&#10;                                    Toast.makeText(ProfileFormActivity.this,&#10;                                        &quot;Perfil actualizado exitosamente&quot;, Toast.LENGTH_SHORT).show();&#10;&#10;                                    // Volver a la pantalla anterior&#10;                                    finish();&#10;                                } else {&#10;                                    Log.e(TAG, &quot;Error al actualizar perfil - Status: &quot; + response.code());&#10;                                    String errorMsg = &quot;Error al actualizar perfil&quot;;&#10;&#10;                                    try {&#10;                                        if (response.errorBody() != null) {&#10;                                            String errorBody = response.errorBody().string();&#10;                                            Log.e(TAG, &quot;Error body: &quot; + errorBody);&#10;                                            if (errorBody.contains(&quot;message&quot;)) {&#10;                                                int start = errorBody.indexOf(&quot;\&quot;message\&quot;:\&quot;&quot;) + 11;&#10;                                                int end = errorBody.indexOf(&quot;\&quot;&quot;, start);&#10;                                                if (start &gt; 10 &amp;&amp; end &gt; start) {&#10;                                                    errorMsg = errorBody.substring(start, end);&#10;                                                }&#10;                                            }&#10;                                        }&#10;                                    } catch (Exception e) {&#10;                                        Log.e(TAG, &quot;Error al parsear error body: &quot; + e.getMessage());&#10;                                    }&#10;&#10;                                    Toast.makeText(ProfileFormActivity.this,&#10;                                        errorMsg, Toast.LENGTH_LONG).show();&#10;                                }&#10;                            }&#10;                        });&#10;                    }&#10;&#10;                    @Override&#10;                    public void onFailure(Call&lt;ProfileResponse&gt; call, Throwable t) {&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonComplete.setEnabled(true);&#10;&#10;                                String errorMsg = t.getMessage();&#10;                                if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                    errorMsg = &quot;Error desconocido&quot;;&#10;                                }&#10;                                Toast.makeText(ProfileFormActivity.this,&#10;                                    &quot;Error de conexión: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                            }&#10;                        });&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void setupKeyboardHandling() {&#10;        // Lista de todos los EditText que necesitan scroll automático&#10;        EditText[] editTexts = {&#10;            editTextName, editTextLastName, editTextBirthdate,&#10;            editTextHeight, editTextWeight, editTextPhone,&#10;            editTextInstagram, editTextTwitter, editTextDescription, editTextAgency&#10;        };&#10;&#10;        for (EditText editText : editTexts) {&#10;            if (editText != null) {&#10;                editText.setOnFocusChangeListener((v, hasFocus) -&gt; {&#10;                    if (hasFocus) {&#10;                        // Desplazar después de un pequeño delay para asegurar que el teclado esté visible&#10;                        v.postDelayed(() -&gt; {&#10;                            v.getParent().requestChildFocus(v, v);&#10;                        }, 200);&#10;                    }&#10;                });&#10;            }&#10;        }&#10;    }&#10;&#10;    @Override&#10;    protected void onDestroy() {&#10;        super.onDestroy();&#10;        // Cerrar el diálogo si está abierto&#10;        if (loadingDialog != null &amp;&amp; loadingDialog.isShowing()) {&#10;            loadingDialog.dismiss();&#10;        }&#10;    }&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/RegisterActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/RegisterActivity.java" />
              <option name="originalContent" value="package com.example.sportconnection;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.EditText;&#10;import android.widget.Toast;&#10;&#10;import androidx.activity.EdgeToEdge;&#10;import androidx.activity.result.ActivityResultLauncher;&#10;import androidx.activity.result.contract.ActivityResultContracts;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.core.graphics.Insets;&#10;import androidx.core.view.ViewCompat;&#10;import androidx.core.view.WindowInsetsCompat;&#10;&#10;import com.google.android.gms.auth.api.signin.GoogleSignIn;&#10;import com.google.android.gms.auth.api.signin.GoogleSignInAccount;&#10;import com.google.android.gms.auth.api.signin.GoogleSignInClient;&#10;import com.google.android.gms.auth.api.signin.GoogleSignInOptions;&#10;import com.google.android.gms.common.api.ApiException;&#10;import com.google.android.gms.tasks.Task;&#10;&#10;import com.example.sportconnection.model.SignupResponse;&#10;import com.example.sportconnection.model.LoginResponse;&#10;import com.example.sportconnection.repository.AuthRepository;&#10;import com.example.sportconnection.utils.LoadingDialog;&#10;import com.example.sportconnection.utils.SessionManager;&#10;import com.example.sportconnection.utils.ThreadManager;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class RegisterActivity extends AppCompatActivity {&#10;&#10;    private EditText editTextEmail;&#10;    private EditText editTextPassword;&#10;    private EditText editTextConfirmPassword;&#10;    private Button buttonContinue;&#10;    private Button buttonGoogleSignUp;&#10;&#10;    private AuthRepository authRepository;&#10;    private SessionManager sessionManager;&#10;    private LoadingDialog loadingDialog;&#10;    private ThreadManager threadManager;&#10;&#10;    private GoogleSignInClient googleSignInClient;&#10;    private ActivityResultLauncher&lt;Intent&gt; googleSignInLauncher;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_register);&#10;&#10;        // Inicializar vistas&#10;        editTextEmail = findViewById(R.id.editTextEmailRegister);&#10;        editTextPassword = findViewById(R.id.editTextPasswordRegister);&#10;        editTextConfirmPassword = findViewById(R.id.editTextConfirmPassword);&#10;        buttonContinue = findViewById(R.id.buttonContinue);&#10;        buttonGoogleSignUp = findViewById(R.id.buttonGoogleSignUp);&#10;&#10;        // Inicializar repositorio, session manager y utilidades&#10;        authRepository = new AuthRepository();&#10;        sessionManager = new SessionManager(this);&#10;        loadingDialog = new LoadingDialog(this);&#10;        threadManager = ThreadManager.getInstance();&#10;&#10;        // Configurar Google Sign-In&#10;        GoogleSignInOptions gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)&#10;                .requestIdToken(getString(R.string.default_web_client_id))&#10;                .requestEmail()&#10;                .build();&#10;        googleSignInClient = GoogleSignIn.getClient(this, gso);&#10;&#10;        // Configurar el launcher para el resultado de Google Sign-In&#10;        googleSignInLauncher = registerForActivityResult(&#10;                new ActivityResultContracts.StartActivityForResult(),&#10;                result -&gt; {&#10;                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;========== GOOGLE SIGN-IN RESULT ==========&quot;);&#10;                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Result code: &quot; + result.getResultCode());&#10;                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;RESULT_OK = &quot; + RESULT_OK + &quot; (-1)&quot;);&#10;                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;RESULT_CANCELED = &quot; + RESULT_CANCELED + &quot; (0)&quot;);&#10;&#10;                    Intent data = result.getData();&#10;                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Intent data: &quot; + (data != null ? &quot;Present&quot; : &quot;NULL&quot;));&#10;&#10;                    // Intentar procesar el resultado incluso si no es RESULT_OK&#10;                    // A veces Google devuelve datos útiles con otros códigos&#10;                    if (data != null) {&#10;                        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Processing intent data...&quot;);&#10;                        Task&lt;GoogleSignInAccount&gt; task = GoogleSignIn.getSignedInAccountFromIntent(data);&#10;                        handleGoogleSignInResult(task);&#10;                    } else {&#10;                        android.util.Log.e(&quot;RegisterActivity&quot;, &quot;No intent data received!&quot;);&#10;                        if (result.getResultCode() == RESULT_CANCELED) {&#10;                            android.util.Log.w(&quot;RegisterActivity&quot;, &quot;User canceled the sign-in flow&quot;);&#10;                            Toast.makeText(RegisterActivity.this, &quot;Inicio de sesión cancelado por el usuario&quot;, Toast.LENGTH_SHORT).show();&#10;                        } else if (result.getResultCode() == RESULT_OK) {&#10;                            android.util.Log.e(&quot;RegisterActivity&quot;, &quot;RESULT_OK but no data - This is unusual!&quot;);&#10;                            Toast.makeText(RegisterActivity.this, &quot;Error: No se recibieron datos de Google&quot;, Toast.LENGTH_LONG).show();&#10;                        } else {&#10;                            android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Unexpected result code with no data: &quot; + result.getResultCode());&#10;                            Toast.makeText(RegisterActivity.this, &quot;Error inesperado al iniciar sesión&quot;, Toast.LENGTH_SHORT).show();&#10;                        }&#10;                    }&#10;                });&#10;&#10;        // Configurar el botón de continuar&#10;        buttonContinue.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                String email = editTextEmail.getText().toString().trim();&#10;                String password = editTextPassword.getText().toString().trim();&#10;                String confirmPassword = editTextConfirmPassword.getText().toString().trim();&#10;&#10;                if (email.isEmpty() || password.isEmpty() || confirmPassword.isEmpty()) {&#10;                    Toast.makeText(RegisterActivity.this, &quot;Por favor, completa todos los campos&quot;, Toast.LENGTH_SHORT).show();&#10;                } else if (!password.equals(confirmPassword)) {&#10;                    Toast.makeText(RegisterActivity.this, &quot;Las contraseñas no coinciden&quot;, Toast.LENGTH_SHORT).show();&#10;                } else if (password.length() &lt; 6) {&#10;                    Toast.makeText(RegisterActivity.this, &quot;La contraseña debe tener al menos 6 caracteres&quot;, Toast.LENGTH_SHORT).show();&#10;                } else {&#10;                    // Registrar usuario en el backend&#10;                    registerUser(email, password);&#10;                }&#10;            }&#10;        });&#10;&#10;        // Configurar el botón de Google Sign-Up&#10;        buttonGoogleSignUp.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                signUpWithGoogle();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void signUpWithGoogle() {&#10;        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;========== STARTING GOOGLE SIGN-IN ==========&quot;);&#10;        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Web Client ID: &quot; + getString(R.string.default_web_client_id));&#10;&#10;        // Verificar si el Web Client ID está configurado&#10;        String webClientId = getString(R.string.default_web_client_id);&#10;        if (webClientId.equals(&quot;YOUR_WEB_CLIENT_ID_HERE&quot;)) {&#10;            android.util.Log.e(&quot;RegisterActivity&quot;, &quot;ERROR: Web Client ID not configured!&quot;);&#10;            Toast.makeText(this, &quot;Error: Web Client ID no está configurado. Revisa strings.xml&quot;, Toast.LENGTH_LONG).show();&#10;            return;&#10;        }&#10;&#10;        // Cerrar sesión previa para forzar selección de cuenta&#10;        googleSignInClient.signOut().addOnCompleteListener(this, task -&gt; {&#10;            android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Previous session cleared&quot;);&#10;            Intent signInIntent = googleSignInClient.getSignInIntent();&#10;            android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Launching Google Sign-In intent...&quot;);&#10;            googleSignInLauncher.launch(signInIntent);&#10;        });&#10;    }&#10;&#10;    private void handleGoogleSignInResult(Task&lt;GoogleSignInAccount&gt; completedTask) {&#10;        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;handleGoogleSignInResult called&quot;);&#10;        try {&#10;            GoogleSignInAccount account = completedTask.getResult(ApiException.class);&#10;            android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Account obtained: &quot; + account.getEmail());&#10;&#10;            String idToken = account.getIdToken();&#10;            android.util.Log.d(&quot;RegisterActivity&quot;, &quot;ID Token: &quot; + (idToken != null ? &quot;Present&quot; : &quot;NULL&quot;));&#10;&#10;            if (idToken != null) {&#10;                android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Calling registerWithGoogle...&quot;);&#10;                registerWithGoogle(idToken);&#10;            } else {&#10;                android.util.Log.e(&quot;RegisterActivity&quot;, &quot;ID Token is NULL!&quot;);&#10;                Toast.makeText(this, &quot;Error al obtener token de Google. Verifica la configuración del Web Client ID&quot;, Toast.LENGTH_LONG).show();&#10;            }&#10;        } catch (ApiException e) {&#10;            android.util.Log.e(&quot;RegisterActivity&quot;, &quot;ApiException in Google Sign-In&quot;);&#10;            android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Status code: &quot; + e.getStatusCode());&#10;            android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Status message: &quot; + e.getStatusMessage());&#10;&#10;            String errorMessage = &quot;Error al registrarse con Google (código: &quot; + e.getStatusCode() + &quot;)&quot;;&#10;            if (e.getStatusCode() == 10) {&#10;                errorMessage = &quot;Error de configuración. Verifica el Web Client ID en strings.xml&quot;;&#10;            }&#10;            Toast.makeText(this, errorMessage, Toast.LENGTH_LONG).show();&#10;        }&#10;    }&#10;&#10;    private void registerWithGoogle(final String idToken) {&#10;        loadingDialog.show(&quot;Registrando con Google...&quot;);&#10;        buttonGoogleSignUp.setEnabled(false);&#10;&#10;        threadManager.executeInBackground(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Calling API googleSignIn...&quot;);&#10;                authRepository.googleSignIn(idToken, new Callback&lt;LoginResponse&gt;() {&#10;                    @Override&#10;                    public void onResponse(Call&lt;LoginResponse&gt; call, Response&lt;LoginResponse&gt; response) {&#10;                        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Response received from server&quot;);&#10;                        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Response code: &quot; + response.code());&#10;                        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Response successful: &quot; + response.isSuccessful());&#10;&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonGoogleSignUp.setEnabled(true);&#10;&#10;                                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                                    LoginResponse loginResponse = response.body();&#10;&#10;                                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Google Sign-In successful&quot;);&#10;                                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Token: &quot; + loginResponse.getToken());&#10;                                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;UserId: &quot; + loginResponse.getUserId());&#10;&#10;                                    final String token = loginResponse.getToken();&#10;                                    final int userId = loginResponse.getUserId();&#10;&#10;                                    // Verificar si requiere completar el perfil&#10;                                    if (loginResponse.isRequiresProfile()) {&#10;                                        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;User requires profile. Navigating to SelectProfileActivity&quot;);&#10;&#10;                                        threadManager.executeWithDelay(new Runnable() {&#10;                                            @Override&#10;                                            public void run() {&#10;                                                Intent intent = new Intent(RegisterActivity.this, SelectProfileActivity.class);&#10;                                                intent.putExtra(&quot;token&quot;, token);&#10;                                                intent.putExtra(&quot;userId&quot;, userId);&#10;                                                intent.putExtra(&quot;isGoogleSignUp&quot;, true);&#10;                                                startActivity(intent);&#10;                                                finish();&#10;                                            }&#10;                                        }, 500);&#10;                                    } else {&#10;                                        // Usuario ya tiene perfil, ir directamente a Home&#10;                                        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;User already has profile. Navigating to HomeActivity&quot;);&#10;&#10;                                        LoginResponse.UserData user = loginResponse.getUser();&#10;                                        String email = user != null ? user.getEmail() : &quot;&quot;;&#10;                                        String profileType = user != null ? user.getProfileType() : &quot;user&quot;;&#10;&#10;                                        sessionManager.saveSession(token, userId, email, profileType);&#10;&#10;                                        threadManager.executeWithDelay(new Runnable() {&#10;                                            @Override&#10;                                            public void run() {&#10;                                                Intent intent = new Intent(RegisterActivity.this, HomeActivity.class);&#10;                                                startActivity(intent);&#10;                                                finish();&#10;                                            }&#10;                                        }, 500);&#10;                                    }&#10;                                } else {&#10;                                    android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Response not successful&quot;);&#10;                                    android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Response code: &quot; + response.code());&#10;                                    android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Response message: &quot; + response.message());&#10;&#10;                                    String errorMsg = response.message();&#10;                                    if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                        errorMsg = &quot;Error desconocido en el servidor&quot;;&#10;                                    }&#10;                                    Toast.makeText(RegisterActivity.this, &quot;Error en el registro: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                                }&#10;                            }&#10;                        });&#10;                    }&#10;&#10;                    @Override&#10;                    public void onFailure(Call&lt;LoginResponse&gt; call, Throwable t) {&#10;                        android.util.Log.e(&quot;RegisterActivity&quot;, &quot;API call failed&quot;);&#10;                        android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Error: &quot; + t.getMessage());&#10;                        t.printStackTrace();&#10;&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonGoogleSignUp.setEnabled(true);&#10;                                String errorMsg = t.getMessage();&#10;                                if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                    errorMsg = &quot;Error desconocido&quot;;&#10;                                }&#10;                                Toast.makeText(RegisterActivity.this, &quot;Error de conexión: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                            }&#10;                        });&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void registerUser(final String email, final String password) {&#10;        // Mostrar diálogo de carga&#10;        loadingDialog.show(&quot;Registrando usuario...&quot;);&#10;        buttonContinue.setEnabled(false);&#10;&#10;        // Ejecutar registro en segundo plano&#10;        threadManager.executeInBackground(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                authRepository.signup(email, password, new Callback&lt;SignupResponse&gt;() {&#10;                    @Override&#10;                    public void onResponse(Call&lt;SignupResponse&gt; call, Response&lt;SignupResponse&gt; response) {&#10;                        // Ejecutar en el hilo principal para actualizar la UI&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonContinue.setEnabled(true);&#10;&#10;                                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                                    SignupResponse signupResponse = response.body();&#10;&#10;                                    // Log para debug&#10;                                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Success: &quot; + signupResponse.isSuccess());&#10;                                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Message: &quot; + signupResponse.getMessage());&#10;                                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Token: &quot; + signupResponse.getToken());&#10;                                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;UserId: &quot; + signupResponse.getUserId());&#10;&#10;                                    // Mostrar mensaje del backend&#10;                                    if (signupResponse.getMessage() != null &amp;&amp; !signupResponse.getMessage().isEmpty()) {&#10;                                        Toast.makeText(RegisterActivity.this, signupResponse.getMessage(), Toast.LENGTH_SHORT).show();&#10;                                    }&#10;&#10;                                    // Si la respuesta es exitosa, navegar a la siguiente pantalla&#10;                                    final String token = signupResponse.getToken();&#10;                                    final int userId = signupResponse.getUserId();&#10;&#10;                                    // Pequeño delay para que el usuario vea el mensaje antes de cambiar de pantalla&#10;                                    threadManager.executeWithDelay(new Runnable() {&#10;                                        @Override&#10;                                        public void run() {&#10;                                            Intent intent = new Intent(RegisterActivity.this, SelectProfileActivity.class);&#10;                                            intent.putExtra(&quot;email&quot;, email);&#10;                                            intent.putExtra(&quot;password&quot;, password);&#10;                                            intent.putExtra(&quot;token&quot;, token);&#10;                                            intent.putExtra(&quot;userId&quot;, userId);&#10;                                            startActivity(intent);&#10;                                            finish();&#10;                                        }&#10;                                    }, 500); // 500ms delay&#10;                                } else {&#10;                                    android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Response code: &quot; + response.code());&#10;                                    android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Response message: &quot; + response.message());&#10;&#10;                                    String errorMsg = response.message();&#10;                                    if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                        errorMsg = &quot;Error desconocido en el servidor&quot;;&#10;                                    }&#10;                                    Toast.makeText(RegisterActivity.this, &quot;Error en el registro: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                                }&#10;                            }&#10;                        });&#10;                    }&#10;&#10;                    @Override&#10;                    public void onFailure(Call&lt;SignupResponse&gt; call, Throwable t) {&#10;                        // Ejecutar en el hilo principal para actualizar la UI&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonContinue.setEnabled(true);&#10;                                android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Error de conexión&quot;, t);&#10;&#10;                                String errorMsg = t.getMessage();&#10;                                if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                    errorMsg = &quot;Error desconocido&quot;;&#10;                                }&#10;                                Toast.makeText(RegisterActivity.this, &quot;Error de conexión: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                            }&#10;                        });&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    @Override&#10;    protected void onDestroy() {&#10;        super.onDestroy();&#10;        // Cerrar el diálogo si está abierto&#10;        if (loadingDialog != null &amp;&amp; loadingDialog.isShowing()) {&#10;            loadingDialog.dismiss();&#10;        }&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.sportconnection;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.EditText;&#10;import android.widget.Toast;&#10;&#10;import androidx.activity.EdgeToEdge;&#10;import androidx.activity.result.ActivityResultLauncher;&#10;import androidx.activity.result.contract.ActivityResultContracts;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.core.graphics.Insets;&#10;import androidx.core.view.ViewCompat;&#10;import androidx.core.view.WindowInsetsCompat;&#10;&#10;import com.google.android.gms.auth.api.signin.GoogleSignIn;&#10;import com.google.android.gms.auth.api.signin.GoogleSignInAccount;&#10;import com.google.android.gms.auth.api.signin.GoogleSignInClient;&#10;import com.google.android.gms.auth.api.signin.GoogleSignInOptions;&#10;import com.google.android.gms.common.api.ApiException;&#10;import com.google.android.gms.tasks.Task;&#10;&#10;import com.example.sportconnection.model.SignupResponse;&#10;import com.example.sportconnection.model.LoginResponse;&#10;import com.example.sportconnection.repository.AuthRepository;&#10;import com.example.sportconnection.utils.LoadingDialog;&#10;import com.example.sportconnection.utils.SessionManager;&#10;import com.example.sportconnection.utils.ThreadManager;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class RegisterActivity extends AppCompatActivity {&#10;&#10;    private EditText editTextEmail;&#10;    private EditText editTextPassword;&#10;    private EditText editTextConfirmPassword;&#10;    private Button buttonContinue;&#10;    private Button buttonGoogleSignUp;&#10;&#10;    private AuthRepository authRepository;&#10;    private SessionManager sessionManager;&#10;    private LoadingDialog loadingDialog;&#10;    private ThreadManager threadManager;&#10;&#10;    private GoogleSignInClient googleSignInClient;&#10;    private ActivityResultLauncher&lt;Intent&gt; googleSignInLauncher;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_register);&#10;&#10;        // Inicializar vistas&#10;        editTextEmail = findViewById(R.id.editTextEmailRegister);&#10;        editTextPassword = findViewById(R.id.editTextPasswordRegister);&#10;        editTextConfirmPassword = findViewById(R.id.editTextConfirmPassword);&#10;        buttonContinue = findViewById(R.id.buttonContinue);&#10;        buttonGoogleSignUp = findViewById(R.id.buttonGoogleSignUp);&#10;&#10;        // Inicializar repositorio, session manager y utilidades&#10;        authRepository = new AuthRepository();&#10;        sessionManager = new SessionManager(this);&#10;        loadingDialog = new LoadingDialog(this);&#10;        threadManager = ThreadManager.getInstance();&#10;&#10;        // Configurar Google Sign-In&#10;        GoogleSignInOptions gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)&#10;                .requestIdToken(getString(R.string.default_web_client_id))&#10;                .requestEmail()&#10;                .build();&#10;        googleSignInClient = GoogleSignIn.getClient(this, gso);&#10;&#10;        // Configurar el launcher para el resultado de Google Sign-In&#10;        googleSignInLauncher = registerForActivityResult(&#10;                new ActivityResultContracts.StartActivityForResult(),&#10;                result -&gt; {&#10;                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;========== GOOGLE SIGN-IN RESULT ==========&quot;);&#10;                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Result code: &quot; + result.getResultCode());&#10;                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;RESULT_OK = &quot; + RESULT_OK + &quot; (-1)&quot;);&#10;                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;RESULT_CANCELED = &quot; + RESULT_CANCELED + &quot; (0)&quot;);&#10;&#10;                    Intent data = result.getData();&#10;                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Intent data: &quot; + (data != null ? &quot;Present&quot; : &quot;NULL&quot;));&#10;&#10;                    // Intentar procesar el resultado incluso si no es RESULT_OK&#10;                    // A veces Google devuelve datos útiles con otros códigos&#10;                    if (data != null) {&#10;                        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Processing intent data...&quot;);&#10;                        Task&lt;GoogleSignInAccount&gt; task = GoogleSignIn.getSignedInAccountFromIntent(data);&#10;                        handleGoogleSignInResult(task);&#10;                    } else {&#10;                        android.util.Log.e(&quot;RegisterActivity&quot;, &quot;No intent data received!&quot;);&#10;                        if (result.getResultCode() == RESULT_CANCELED) {&#10;                            android.util.Log.w(&quot;RegisterActivity&quot;, &quot;User canceled the sign-in flow&quot;);&#10;                            Toast.makeText(RegisterActivity.this, &quot;Inicio de sesión cancelado por el usuario&quot;, Toast.LENGTH_SHORT).show();&#10;                        } else if (result.getResultCode() == RESULT_OK) {&#10;                            android.util.Log.e(&quot;RegisterActivity&quot;, &quot;RESULT_OK but no data - This is unusual!&quot;);&#10;                            Toast.makeText(RegisterActivity.this, &quot;Error: No se recibieron datos de Google&quot;, Toast.LENGTH_LONG).show();&#10;                        } else {&#10;                            android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Unexpected result code with no data: &quot; + result.getResultCode());&#10;                            Toast.makeText(RegisterActivity.this, &quot;Error inesperado al iniciar sesión&quot;, Toast.LENGTH_SHORT).show();&#10;                        }&#10;                    }&#10;                });&#10;&#10;        // Configurar el botón de continuar&#10;        buttonContinue.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                String email = editTextEmail.getText().toString().trim();&#10;                String password = editTextPassword.getText().toString().trim();&#10;                String confirmPassword = editTextConfirmPassword.getText().toString().trim();&#10;&#10;                if (email.isEmpty() || password.isEmpty() || confirmPassword.isEmpty()) {&#10;                    Toast.makeText(RegisterActivity.this, &quot;Por favor, completa todos los campos&quot;, Toast.LENGTH_SHORT).show();&#10;                } else if (!password.equals(confirmPassword)) {&#10;                    Toast.makeText(RegisterActivity.this, &quot;Las contraseñas no coinciden&quot;, Toast.LENGTH_SHORT).show();&#10;                } else if (password.length() &lt; 6) {&#10;                    Toast.makeText(RegisterActivity.this, &quot;La contraseña debe tener al menos 6 caracteres&quot;, Toast.LENGTH_SHORT).show();&#10;                } else {&#10;                    // Registrar usuario en el backend&#10;                    registerUser(email, password);&#10;                }&#10;            }&#10;        });&#10;&#10;        // Configurar el botón de Google Sign-Up&#10;        buttonGoogleSignUp.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                signUpWithGoogle();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void signUpWithGoogle() {&#10;        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;========== STARTING GOOGLE SIGN-IN ==========&quot;);&#10;        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Web Client ID: &quot; + getString(R.string.default_web_client_id));&#10;&#10;        // Verificar si el Web Client ID está configurado&#10;        String webClientId = getString(R.string.default_web_client_id);&#10;        if (webClientId.equals(&quot;YOUR_WEB_CLIENT_ID_HERE&quot;)) {&#10;            android.util.Log.e(&quot;RegisterActivity&quot;, &quot;ERROR: Web Client ID not configured!&quot;);&#10;            Toast.makeText(this, &quot;Error: Web Client ID no está configurado. Revisa strings.xml&quot;, Toast.LENGTH_LONG).show();&#10;            return;&#10;        }&#10;&#10;        // Cerrar sesión previa para forzar selección de cuenta&#10;        googleSignInClient.signOut().addOnCompleteListener(this, task -&gt; {&#10;            android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Previous session cleared&quot;);&#10;            Intent signInIntent = googleSignInClient.getSignInIntent();&#10;            android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Launching Google Sign-In intent...&quot;);&#10;            googleSignInLauncher.launch(signInIntent);&#10;        });&#10;    }&#10;&#10;    private void handleGoogleSignInResult(Task&lt;GoogleSignInAccount&gt; completedTask) {&#10;        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;handleGoogleSignInResult called&quot;);&#10;        try {&#10;            GoogleSignInAccount account = completedTask.getResult(ApiException.class);&#10;            android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Account obtained: &quot; + account.getEmail());&#10;&#10;            String idToken = account.getIdToken();&#10;            android.util.Log.d(&quot;RegisterActivity&quot;, &quot;ID Token: &quot; + (idToken != null ? &quot;Present&quot; : &quot;NULL&quot;));&#10;&#10;            if (idToken != null) {&#10;                android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Calling registerWithGoogle...&quot;);&#10;                registerWithGoogle(idToken);&#10;            } else {&#10;                android.util.Log.e(&quot;RegisterActivity&quot;, &quot;ID Token is NULL!&quot;);&#10;                Toast.makeText(this, &quot;Error al obtener token de Google. Verifica la configuración del Web Client ID&quot;, Toast.LENGTH_LONG).show();&#10;            }&#10;        } catch (ApiException e) {&#10;            android.util.Log.e(&quot;RegisterActivity&quot;, &quot;ApiException in Google Sign-In&quot;);&#10;            android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Status code: &quot; + e.getStatusCode());&#10;            android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Status message: &quot; + e.getStatusMessage());&#10;&#10;            String errorMessage = &quot;Error al registrarse con Google (código: &quot; + e.getStatusCode() + &quot;)&quot;;&#10;            if (e.getStatusCode() == 10) {&#10;                errorMessage = &quot;Error de configuración. Verifica el Web Client ID en strings.xml&quot;;&#10;            }&#10;            Toast.makeText(this, errorMessage, Toast.LENGTH_LONG).show();&#10;        }&#10;    }&#10;&#10;    private void registerWithGoogle(final String idToken) {&#10;        loadingDialog.show(&quot;Registrando con Google...&quot;);&#10;        buttonGoogleSignUp.setEnabled(false);&#10;&#10;        threadManager.executeInBackground(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Calling API googleSignIn...&quot;);&#10;                authRepository.googleSignIn(idToken, new Callback&lt;LoginResponse&gt;() {&#10;                    @Override&#10;                    public void onResponse(Call&lt;LoginResponse&gt; call, Response&lt;LoginResponse&gt; response) {&#10;                        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Response received from server&quot;);&#10;                        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Response code: &quot; + response.code());&#10;                        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Response successful: &quot; + response.isSuccessful());&#10;&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonGoogleSignUp.setEnabled(true);&#10;&#10;                                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                                    LoginResponse loginResponse = response.body();&#10;&#10;                                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Google Sign-In successful&quot;);&#10;                                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Token: &quot; + loginResponse.getToken());&#10;                                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;UserId: &quot; + loginResponse.getUserId());&#10;&#10;                                    final String token = loginResponse.getToken();&#10;                                    final int userId = loginResponse.getUserId();&#10;&#10;                                    // Verificar si requiere completar el perfil&#10;                                    if (loginResponse.isRequiresProfile()) {&#10;                                        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;User requires profile. Navigating to SelectProfileActivity&quot;);&#10;&#10;                                        threadManager.executeWithDelay(new Runnable() {&#10;                                            @Override&#10;                                            public void run() {&#10;                                                Intent intent = new Intent(RegisterActivity.this, SelectProfileActivity.class);&#10;                                                intent.putExtra(&quot;token&quot;, token);&#10;                                                intent.putExtra(&quot;userId&quot;, userId);&#10;                                                intent.putExtra(&quot;isGoogleSignUp&quot;, true);&#10;                                                startActivity(intent);&#10;                                                finish();&#10;                                            }&#10;                                        }, 500);&#10;                                    } else {&#10;                                        // Usuario ya tiene perfil, ir directamente a Home&#10;                                        android.util.Log.d(&quot;RegisterActivity&quot;, &quot;User already has profile. Navigating to HomeActivity&quot;);&#10;&#10;                                        LoginResponse.UserData user = loginResponse.getUser();&#10;                                        String email = user != null ? user.getEmail() : &quot;&quot;;&#10;                                        String profileType = user != null ? user.getProfileType() : &quot;user&quot;;&#10;&#10;                                        sessionManager.saveSession(token, userId, email, profileType);&#10;&#10;                                        threadManager.executeWithDelay(new Runnable() {&#10;                                            @Override&#10;                                            public void run() {&#10;                                                Intent intent = new Intent(RegisterActivity.this, HomeActivity.class);&#10;                                                startActivity(intent);&#10;                                                finish();&#10;                                            }&#10;                                        }, 500);&#10;                                    }&#10;                                } else {&#10;                                    android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Response not successful&quot;);&#10;                                    android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Response code: &quot; + response.code());&#10;                                    android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Response message: &quot; + response.message());&#10;&#10;                                    String errorMsg = response.message();&#10;                                    if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                        errorMsg = &quot;Error desconocido en el servidor&quot;;&#10;                                    }&#10;                                    Toast.makeText(RegisterActivity.this, &quot;Error en el registro: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                                }&#10;                            }&#10;                        });&#10;                    }&#10;&#10;                    @Override&#10;                    public void onFailure(Call&lt;LoginResponse&gt; call, Throwable t) {&#10;                        android.util.Log.e(&quot;RegisterActivity&quot;, &quot;API call failed&quot;);&#10;                        android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Error: &quot; + t.getMessage());&#10;                        t.printStackTrace();&#10;&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonGoogleSignUp.setEnabled(true);&#10;                                String errorMsg = t.getMessage();&#10;                                if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                    errorMsg = &quot;Error desconocido&quot;;&#10;                                }&#10;                                Toast.makeText(RegisterActivity.this, &quot;Error de conexión: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                            }&#10;                        });&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void registerUser(final String email, final String password) {&#10;        // Mostrar diálogo de carga&#10;        loadingDialog.show(&quot;Registrando usuario...&quot;);&#10;        buttonContinue.setEnabled(false);&#10;&#10;        // Ejecutar registro en segundo plano&#10;        threadManager.executeInBackground(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                authRepository.signup(email, password, new Callback&lt;SignupResponse&gt;() {&#10;                    @Override&#10;                    public void onResponse(Call&lt;SignupResponse&gt; call, Response&lt;SignupResponse&gt; response) {&#10;                        // Ejecutar en el hilo principal para actualizar la UI&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonContinue.setEnabled(true);&#10;&#10;                                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                                    SignupResponse signupResponse = response.body();&#10;&#10;                                    // Log para debug&#10;                                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Success: &quot; + signupResponse.isSuccess());&#10;                                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Message: &quot; + signupResponse.getMessage());&#10;                                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;Token: &quot; + signupResponse.getToken());&#10;                                    android.util.Log.d(&quot;RegisterActivity&quot;, &quot;UserId: &quot; + signupResponse.getUserId());&#10;&#10;                                    // Mostrar mensaje del backend&#10;                                    if (signupResponse.getMessage() != null &amp;&amp; !signupResponse.getMessage().isEmpty()) {&#10;                                        Toast.makeText(RegisterActivity.this, signupResponse.getMessage(), Toast.LENGTH_SHORT).show();&#10;                                    }&#10;&#10;                                    // Si la respuesta es exitosa, navegar a la siguiente pantalla&#10;                                    final String token = signupResponse.getToken();&#10;                                    final int userId = signupResponse.getUserId();&#10;&#10;                                    // Pequeño delay para que el usuario vea el mensaje antes de cambiar de pantalla&#10;                                    threadManager.executeWithDelay(new Runnable() {&#10;                                        @Override&#10;                                        public void run() {&#10;                                            Intent intent = new Intent(RegisterActivity.this, SelectProfileActivity.class);&#10;                                            intent.putExtra(&quot;email&quot;, email);&#10;                                            intent.putExtra(&quot;password&quot;, password);&#10;                                            intent.putExtra(&quot;token&quot;, token);&#10;                                            intent.putExtra(&quot;userId&quot;, userId);&#10;                                            startActivity(intent);&#10;                                            finish();&#10;                                        }&#10;                                    }, 500); // 500ms delay&#10;                                } else {&#10;                                    android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Response code: &quot; + response.code());&#10;                                    android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Response message: &quot; + response.message());&#10;&#10;                                    String errorMsg = response.message();&#10;                                    if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                        errorMsg = &quot;Error desconocido en el servidor&quot;;&#10;                                    }&#10;                                    Toast.makeText(RegisterActivity.this, &quot;Error en el registro: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                                }&#10;                            }&#10;                        });&#10;                    }&#10;&#10;                    @Override&#10;                    public void onFailure(Call&lt;SignupResponse&gt; call, Throwable t) {&#10;                        // Ejecutar en el hilo principal para actualizar la UI&#10;                        threadManager.executeOnMainThread(new Runnable() {&#10;                            @Override&#10;                            public void run() {&#10;                                loadingDialog.dismiss();&#10;                                buttonContinue.setEnabled(true);&#10;                                android.util.Log.e(&quot;RegisterActivity&quot;, &quot;Error de conexión&quot;, t);&#10;&#10;                                String errorMsg = t.getMessage();&#10;                                if (errorMsg == null || errorMsg.isEmpty()) {&#10;                                    errorMsg = &quot;Error desconocido&quot;;&#10;                                }&#10;                                Toast.makeText(RegisterActivity.this, &quot;Error de conexión: &quot; + errorMsg, Toast.LENGTH_LONG).show();&#10;                            }&#10;                        });&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    @Override&#10;    protected void onDestroy() {&#10;        super.onDestroy();&#10;        // Cerrar el diálogo si está abierto&#10;        if (loadingDialog != null &amp;&amp; loadingDialog.isShowing()) {&#10;            loadingDialog.dismiss();&#10;        }&#10;    }&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/adapters/PostsAdapter.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/adapters/PostsAdapter.java" />
              <option name="originalContent" value="package com.example.sportconnection.adapters;&#10;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import android.widget.ImageButton;&#10;import android.widget.TextView;&#10;&#10;import androidx.annotation.NonNull;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;&#10;import com.bumptech.glide.Glide;&#10;import com.example.sportconnection.R;&#10;import com.example.sportconnection.model.Post;&#10;import com.google.android.material.imageview.ShapeableImageView;&#10;&#10;import java.text.ParseException;&#10;import java.text.SimpleDateFormat;&#10;import java.util.ArrayList;&#10;import java.util.Date;&#10;import java.util.List;&#10;import java.util.Locale;&#10;import java.util.TimeZone;&#10;&#10;public class PostsAdapter extends RecyclerView.Adapter&lt;PostsAdapter.PostViewHolder&gt; {&#10;    private List&lt;Post&gt; posts;&#10;    private OnPostActionListener listener;&#10;    private int currentUserId;&#10;    private boolean showDeleteButton;&#10;&#10;    public interface OnPostActionListener {&#10;        void onDeletePost(Post post);&#10;    }&#10;&#10;    public PostsAdapter(int currentUserId, boolean showDeleteButton, OnPostActionListener listener) {&#10;        this.posts = new ArrayList&lt;&gt;();&#10;        this.currentUserId = currentUserId;&#10;        this.showDeleteButton = showDeleteButton;&#10;        this.listener = listener;&#10;    }&#10;&#10;    @NonNull&#10;    @Override&#10;    public PostViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {&#10;        View view = LayoutInflater.from(parent.getContext())&#10;                .inflate(R.layout.item_post, parent, false);&#10;        return new PostViewHolder(view);&#10;    }&#10;&#10;    @Override&#10;    public void onBindViewHolder(@NonNull PostViewHolder holder, int position) {&#10;        Post post = posts.get(position);&#10;        holder.bind(post);&#10;    }&#10;&#10;    @Override&#10;    public int getItemCount() {&#10;        return posts.size();&#10;    }&#10;&#10;    public void setPosts(List&lt;Post&gt; posts) {&#10;        this.posts = posts != null ? posts : new ArrayList&lt;&gt;();&#10;        notifyDataSetChanged();&#10;    }&#10;&#10;    public void addPost(Post post) {&#10;        this.posts.add(0, post);&#10;        notifyItemInserted(0);&#10;    }&#10;&#10;    public void removePost(int postId) {&#10;        for (int i = 0; i &lt; posts.size(); i++) {&#10;            if (posts.get(i).getId() == postId) {&#10;                posts.remove(i);&#10;                notifyItemRemoved(i);&#10;                break;&#10;            }&#10;        }&#10;    }&#10;&#10;    class PostViewHolder extends RecyclerView.ViewHolder {&#10;        private ShapeableImageView userAvatar;&#10;        private TextView userName;&#10;        private TextView postDate;&#10;        private TextView postText;&#10;        private TextView postUrl;&#10;        private ImageButton btnDelete;&#10;&#10;        public PostViewHolder(@NonNull View itemView) {&#10;            super(itemView);&#10;            userAvatar = itemView.findViewById(R.id.userAvatar);&#10;            userName = itemView.findViewById(R.id.userName);&#10;            postDate = itemView.findViewById(R.id.postDate);&#10;            postText = itemView.findViewById(R.id.postText);&#10;            postUrl = itemView.findViewById(R.id.postUrl);&#10;            btnDelete = itemView.findViewById(R.id.btnDeletePost);&#10;        }&#10;&#10;        public void bind(Post post) {&#10;            // Configurar foto de perfil&#10;            if (post.getUser() != null &amp;&amp; post.getUser().getPhotoUrl() != null &amp;&amp; !post.getUser().getPhotoUrl().isEmpty()) {&#10;                // Cargar foto de perfil con Glide&#10;                Glide.with(itemView.getContext())&#10;                        .load(post.getUser().getPhotoUrl())&#10;                        .placeholder(R.drawable.ic_profile)&#10;                        .error(R.drawable.ic_profile)&#10;                        .into(userAvatar);&#10;            } else {&#10;                // Mostrar icono por defecto&#10;                userAvatar.setImageResource(R.drawable.ic_profile);&#10;            }&#10;            &#10;            // Configurar nombre de usuario&#10;            if (post.getUser() != null) {&#10;                userName.setText(post.getUser().getFullName());&#10;            } else {&#10;                userName.setText(&quot;Usuario desconocido&quot;);&#10;            }&#10;&#10;            // Configurar texto del post&#10;            postText.setText(post.getText());&#10;&#10;            // Configurar URL si existe&#10;            if (post.getUrl() != null &amp;&amp; !post.getUrl().isEmpty()) {&#10;                postUrl.setText(post.getUrl());&#10;                postUrl.setVisibility(View.VISIBLE);&#10;            } else {&#10;                postUrl.setVisibility(View.GONE);&#10;            }&#10;&#10;            // Configurar fecha&#10;            postDate.setText(formatDate(post.getCreatedAt()));&#10;&#10;            // Configurar botón de eliminar&#10;            if (showDeleteButton &amp;&amp; post.getUserId() == currentUserId) {&#10;                btnDelete.setVisibility(View.VISIBLE);&#10;                btnDelete.setOnClickListener(v -&gt; {&#10;                    if (listener != null) {&#10;                        listener.onDeletePost(post);&#10;                    }&#10;                });&#10;            } else {&#10;                btnDelete.setVisibility(View.GONE);&#10;            }&#10;        }&#10;&#10;        private String formatDate(String dateString) {&#10;            if (dateString == null || dateString.isEmpty()) {&#10;                return &quot;&quot;;&#10;            }&#10;&#10;            try {&#10;                // Normalizar la fecha: remover microsegundos si existen y convertir +00:00 a Z&#10;                String normalizedDate = dateString;&#10;&#10;                // Si tiene microsegundos (más de 3 dígitos después del punto), recortarlos&#10;                if (normalizedDate.contains(&quot;.&quot;)) {&#10;                    int dotIndex = normalizedDate.indexOf(&quot;.&quot;);&#10;                    int endIndex = dotIndex + 1;&#10;&#10;                    // Encontrar el final de los dígitos&#10;                    while (endIndex &lt; normalizedDate.length() &amp;&amp;&#10;                           Character.isDigit(normalizedDate.charAt(endIndex))) {&#10;                        endIndex++;&#10;                    }&#10;&#10;                    // Si hay más de 3 dígitos de fracción, recortar a 3&#10;                    int fractionDigits = endIndex - dotIndex - 1;&#10;                    if (fractionDigits &gt; 3) {&#10;                        String beforeDot = normalizedDate.substring(0, dotIndex);&#10;                        String milliseconds = normalizedDate.substring(dotIndex + 1, dotIndex + 4);&#10;                        String afterMillis = normalizedDate.substring(endIndex);&#10;                        normalizedDate = beforeDot + &quot;.&quot; + milliseconds + afterMillis;&#10;                    }&#10;                }&#10;&#10;                // Intentar múltiples formatos de fecha&#10;                SimpleDateFormat sdf;&#10;                Date date = null;&#10;&#10;                // Formato con milisegundos y zona horaria +/-HH:MM&#10;                try {&#10;                    sdf = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss.SSSXXX&quot;, Locale.getDefault());&#10;                    date = sdf.parse(normalizedDate);&#10;                } catch (ParseException e) {&#10;                    // Formato sin milisegundos con zona horaria +/-HH:MM&#10;                    try {&#10;                        sdf = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ssXXX&quot;, Locale.getDefault());&#10;                        date = sdf.parse(normalizedDate);&#10;                    } catch (ParseException e2) {&#10;                        // Formato con milisegundos y Z&#10;                        try {&#10;                            sdf = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z'&quot;, Locale.getDefault());&#10;                            sdf.setTimeZone(TimeZone.getTimeZone(&quot;UTC&quot;));&#10;                            date = sdf.parse(normalizedDate);&#10;                        } catch (ParseException e3) {&#10;                            // Formato sin milisegundos y Z&#10;                            try {&#10;                                sdf = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss'Z'&quot;, Locale.getDefault());&#10;                                sdf.setTimeZone(TimeZone.getTimeZone(&quot;UTC&quot;));&#10;                                date = sdf.parse(normalizedDate);&#10;                            } catch (ParseException e4) {&#10;                                // Si todo falla, devolver la cadena original&#10;                                return dateString;&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;&#10;                if (date == null) {&#10;                    return dateString;&#10;                }&#10;&#10;                long diff = System.currentTimeMillis() - date.getTime();&#10;                long seconds = diff / 1000;&#10;                long minutes = seconds / 60;&#10;                long hours = minutes / 60;&#10;                long days = hours / 24;&#10;&#10;                if (seconds &lt; 0) {&#10;                    // Fecha en el futuro, mostrar fecha completa&#10;                    SimpleDateFormat outputFormat = new SimpleDateFormat(&quot;dd/MM/yyyy HH:mm&quot;, Locale.getDefault());&#10;                    return outputFormat.format(date);&#10;                } else if (seconds &lt; 60) {&#10;                    return &quot;Hace &quot; + seconds + &quot;s&quot;;&#10;                } else if (minutes &lt; 60) {&#10;                    return &quot;Hace &quot; + minutes + &quot;m&quot;;&#10;                } else if (hours &lt; 24) {&#10;                    return &quot;Hace &quot; + hours + &quot;h&quot;;&#10;                } else if (days &lt; 7) {&#10;                    return &quot;Hace &quot; + days + &quot;d&quot;;&#10;                } else if (days &lt; 30) {&#10;                    long weeks = days / 7;&#10;                    return &quot;Hace &quot; + weeks + &quot; sem&quot;;&#10;                } else {&#10;                    SimpleDateFormat outputFormat = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;, Locale.getDefault());&#10;                    return outputFormat.format(date);&#10;                }&#10;            } catch (Exception e) {&#10;                e.printStackTrace();&#10;                return dateString;&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.sportconnection.adapters;&#10;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import android.widget.ImageButton;&#10;import android.widget.TextView;&#10;&#10;import androidx.annotation.NonNull;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;&#10;import com.bumptech.glide.Glide;&#10;import com.example.sportconnection.R;&#10;import com.example.sportconnection.model.Post;&#10;import com.google.android.material.imageview.ShapeableImageView;&#10;&#10;import java.text.ParseException;&#10;import java.text.SimpleDateFormat;&#10;import java.util.ArrayList;&#10;import java.util.Date;&#10;import java.util.List;&#10;import java.util.Locale;&#10;import java.util.TimeZone;&#10;&#10;public class PostsAdapter extends RecyclerView.Adapter&lt;PostsAdapter.PostViewHolder&gt; {&#10;    private List&lt;Post&gt; posts;&#10;    private OnPostActionListener listener;&#10;    private int currentUserId;&#10;    private boolean showDeleteButton;&#10;&#10;    public interface OnPostActionListener {&#10;        void onDeletePost(Post post);&#10;    }&#10;&#10;    public PostsAdapter(int currentUserId, boolean showDeleteButton, OnPostActionListener listener) {&#10;        this.posts = new ArrayList&lt;&gt;();&#10;        this.currentUserId = currentUserId;&#10;        this.showDeleteButton = showDeleteButton;&#10;        this.listener = listener;&#10;    }&#10;&#10;    @NonNull&#10;    @Override&#10;    public PostViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {&#10;        View view = LayoutInflater.from(parent.getContext())&#10;                .inflate(R.layout.item_post, parent, false);&#10;        return new PostViewHolder(view);&#10;    }&#10;&#10;    @Override&#10;    public void onBindViewHolder(@NonNull PostViewHolder holder, int position) {&#10;        Post post = posts.get(position);&#10;        holder.bind(post);&#10;    }&#10;&#10;    @Override&#10;    public int getItemCount() {&#10;        return posts.size();&#10;    }&#10;&#10;    public void setPosts(List&lt;Post&gt; posts) {&#10;        this.posts = posts != null ? posts : new ArrayList&lt;&gt;();&#10;        notifyDataSetChanged();&#10;    }&#10;&#10;    public void addPost(Post post) {&#10;        this.posts.add(0, post);&#10;        notifyItemInserted(0);&#10;    }&#10;&#10;    public void removePost(int postId) {&#10;        for (int i = 0; i &lt; posts.size(); i++) {&#10;            if (posts.get(i).getId() == postId) {&#10;                posts.remove(i);&#10;                notifyItemRemoved(i);&#10;                break;&#10;            }&#10;        }&#10;    }&#10;&#10;    class PostViewHolder extends RecyclerView.ViewHolder {&#10;        private ShapeableImageView userAvatar;&#10;        private TextView userName;&#10;        private TextView postDate;&#10;        private TextView postText;&#10;        private TextView postUrl;&#10;        private ImageButton btnDelete;&#10;&#10;        public PostViewHolder(@NonNull View itemView) {&#10;            super(itemView);&#10;            userAvatar = itemView.findViewById(R.id.userAvatar);&#10;            userName = itemView.findViewById(R.id.userName);&#10;            postDate = itemView.findViewById(R.id.postDate);&#10;            postText = itemView.findViewById(R.id.postText);&#10;            postUrl = itemView.findViewById(R.id.postUrl);&#10;            btnDelete = itemView.findViewById(R.id.btnDeletePost);&#10;        }&#10;&#10;        public void bind(Post post) {&#10;            // Configurar foto de perfil&#10;            if (post.getUser() != null &amp;&amp; post.getUser().getPhotoUrl() != null &amp;&amp; !post.getUser().getPhotoUrl().isEmpty()) {&#10;                // Cargar foto de perfil con Glide&#10;                Glide.with(itemView.getContext())&#10;                        .load(post.getUser().getPhotoUrl())&#10;                        .placeholder(R.drawable.ic_profile)&#10;                        .error(R.drawable.ic_profile)&#10;                        .into(userAvatar);&#10;            } else {&#10;                // Mostrar icono por defecto&#10;                userAvatar.setImageResource(R.drawable.ic_profile);&#10;            }&#10;            &#10;            // Configurar nombre de usuario&#10;            if (post.getUser() != null) {&#10;                userName.setText(post.getUser().getFullName());&#10;            } else {&#10;                userName.setText(&quot;Usuario desconocido&quot;);&#10;            }&#10;&#10;            // Configurar texto del post&#10;            postText.setText(post.getText());&#10;&#10;            // Configurar URL si existe&#10;            if (post.getUrl() != null &amp;&amp; !post.getUrl().isEmpty()) {&#10;                postUrl.setText(post.getUrl());&#10;                postUrl.setVisibility(View.VISIBLE);&#10;            } else {&#10;                postUrl.setVisibility(View.GONE);&#10;            }&#10;&#10;            // Configurar fecha&#10;            postDate.setText(formatDate(post.getCreatedAt()));&#10;&#10;            // Configurar botón de eliminar&#10;            if (showDeleteButton &amp;&amp; post.getUserId() == currentUserId) {&#10;                btnDelete.setVisibility(View.VISIBLE);&#10;                btnDelete.setOnClickListener(v -&gt; {&#10;                    if (listener != null) {&#10;                        listener.onDeletePost(post);&#10;                    }&#10;                });&#10;            } else {&#10;                btnDelete.setVisibility(View.GONE);&#10;            }&#10;        }&#10;&#10;        private String formatDate(String dateString) {&#10;            if (dateString == null || dateString.isEmpty()) {&#10;                return &quot;&quot;;&#10;            }&#10;&#10;            try {&#10;                // Normalizar la fecha: remover microsegundos si existen y convertir +00:00 a Z&#10;                String normalizedDate = dateString;&#10;&#10;                // Si tiene microsegundos (más de 3 dígitos después del punto), recortarlos&#10;                if (normalizedDate.contains(&quot;.&quot;)) {&#10;                    int dotIndex = normalizedDate.indexOf(&quot;.&quot;);&#10;                    int endIndex = dotIndex + 1;&#10;&#10;                    // Encontrar el final de los dígitos&#10;                    while (endIndex &lt; normalizedDate.length() &amp;&amp;&#10;                           Character.isDigit(normalizedDate.charAt(endIndex))) {&#10;                        endIndex++;&#10;                    }&#10;&#10;                    // Si hay más de 3 dígitos de fracción, recortar a 3&#10;                    int fractionDigits = endIndex - dotIndex - 1;&#10;                    if (fractionDigits &gt; 3) {&#10;                        String beforeDot = normalizedDate.substring(0, dotIndex);&#10;                        String milliseconds = normalizedDate.substring(dotIndex + 1, dotIndex + 4);&#10;                        String afterMillis = normalizedDate.substring(endIndex);&#10;                        normalizedDate = beforeDot + &quot;.&quot; + milliseconds + afterMillis;&#10;                    }&#10;                }&#10;&#10;                // Intentar múltiples formatos de fecha&#10;                SimpleDateFormat sdf;&#10;                Date date = null;&#10;&#10;                // Formato con milisegundos y zona horaria +/-HH:MM&#10;                try {&#10;                    sdf = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss.SSSXXX&quot;, Locale.getDefault());&#10;                    date = sdf.parse(normalizedDate);&#10;                } catch (ParseException e) {&#10;                    // Formato sin milisegundos con zona horaria +/-HH:MM&#10;                    try {&#10;                        sdf = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ssXXX&quot;, Locale.getDefault());&#10;                        date = sdf.parse(normalizedDate);&#10;                    } catch (ParseException e2) {&#10;                        // Formato con milisegundos y Z&#10;                        try {&#10;                            sdf = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z'&quot;, Locale.getDefault());&#10;                            sdf.setTimeZone(TimeZone.getTimeZone(&quot;UTC&quot;));&#10;                            date = sdf.parse(normalizedDate);&#10;                        } catch (ParseException e3) {&#10;                            // Formato sin milisegundos y Z&#10;                            try {&#10;                                sdf = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss'Z'&quot;, Locale.getDefault());&#10;                                sdf.setTimeZone(TimeZone.getTimeZone(&quot;UTC&quot;));&#10;                                date = sdf.parse(normalizedDate);&#10;                            } catch (ParseException e4) {&#10;                                // Si todo falla, devolver la cadena original&#10;                                return dateString;&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;&#10;                if (date == null) {&#10;                    return dateString;&#10;                }&#10;&#10;                long diff = System.currentTimeMillis() - date.getTime();&#10;                long seconds = diff / 1000;&#10;                long minutes = seconds / 60;&#10;                long hours = minutes / 60;&#10;                long days = hours / 24;&#10;&#10;                if (seconds &lt; 0) {&#10;                    // Fecha en el futuro, mostrar fecha completa&#10;                    SimpleDateFormat outputFormat = new SimpleDateFormat(&quot;dd/MM/yyyy HH:mm&quot;, Locale.getDefault());&#10;                    return outputFormat.format(date);&#10;                } else if (seconds &lt; 60) {&#10;                    return &quot;Hace &quot; + seconds + &quot;s&quot;;&#10;                } else if (minutes &lt; 60) {&#10;                    return &quot;Hace &quot; + minutes + &quot;m&quot;;&#10;                } else if (hours &lt; 24) {&#10;                    return &quot;Hace &quot; + hours + &quot;h&quot;;&#10;                } else if (days &lt; 7) {&#10;                    return &quot;Hace &quot; + days + &quot;d&quot;;&#10;                } else if (days &lt; 30) {&#10;                    long weeks = days / 7;&#10;                    return &quot;Hace &quot; + weeks + &quot; sem&quot;;&#10;                } else {&#10;                    SimpleDateFormat outputFormat = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;, Locale.getDefault());&#10;                    return outputFormat.format(date);&#10;                }&#10;            } catch (Exception e) {&#10;                e.printStackTrace();&#10;                return dateString;&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/fragments/ProfileFragment.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/fragments/ProfileFragment.java" />
              <option name="originalContent" value="package com.example.sportconnection.fragments;&#10;&#10;import android.Manifest;&#10;import android.app.Activity;&#10;import android.content.Intent;&#10;import android.content.pm.PackageManager;&#10;import android.net.Uri;&#10;import android.os.Build;&#10;import android.os.Bundle;&#10;import android.provider.MediaStore;&#10;import android.util.Log;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import android.widget.Button;&#10;import android.widget.ImageView;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;&#10;import androidx.activity.result.ActivityResultLauncher;&#10;import androidx.activity.result.contract.ActivityResultContracts;&#10;import androidx.annotation.NonNull;&#10;import androidx.annotation.Nullable;&#10;import androidx.core.content.ContextCompat;&#10;import androidx.fragment.app.Fragment;&#10;&#10;import com.bumptech.glide.Glide;&#10;import com.bumptech.glide.load.engine.DiskCacheStrategy;&#10;import com.example.sportconnection.HomeActivity;&#10;import com.example.sportconnection.MainActivity;&#10;import com.example.sportconnection.ProfileFormActivity;&#10;import com.example.sportconnection.R;&#10;import com.example.sportconnection.model.DeletePhotoResponse;&#10;import com.example.sportconnection.model.Location;&#10;import com.example.sportconnection.model.GetProfileResponse;&#10;import com.example.sportconnection.model.Sport;&#10;import com.example.sportconnection.model.UploadPhotoResponse;&#10;import com.example.sportconnection.repository.AuthRepository;&#10;import com.example.sportconnection.repository.LookupRepository;&#10;import com.example.sportconnection.repository.SubscriptionRepository;&#10;import com.example.sportconnection.utils.LoadingDialog;&#10;import com.example.sportconnection.utils.SessionManager;&#10;import com.example.sportconnection.utils.ThreadManager;&#10;&#10;import java.io.File;&#10;import java.io.FileOutputStream;&#10;import java.io.InputStream;&#10;import java.util.List;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class ProfileFragment extends Fragment {&#10;    private static final String TAG = &quot;ProfileFragment&quot;;&#10;    private static final int REQUEST_PERMISSION_READ_STORAGE = 100;&#10;&#10;    private ImageView imageProfilePhoto;&#10;    private Button buttonChangePhoto;&#10;    private TextView textUserEmail;&#10;    private TextView textUserType;&#10;    private TextView textUserName;&#10;    private TextView textUserLastName;&#10;    private TextView textUserBirthdate;&#10;    private TextView textUserHeight;&#10;    private TextView textUserWeight;&#10;    private TextView textUserLocation;&#10;    private TextView textUserSport;&#10;    private TextView textUserPhone;&#10;    private TextView textUserInstagram;&#10;    private TextView textUserTwitter;&#10;    private TextView textUserAgency;&#10;    private TextView textUserJob;&#10;    private TextView textUserDescription;&#10;    private Button buttonEditProfile;&#10;    private Button buttonLogout;&#10;    private Button btnSubscribe;&#10;&#10;    private SessionManager sessionManager;&#10;    private AuthRepository authRepository;&#10;    private LookupRepository lookupRepository;&#10;    private SubscriptionRepository subscriptionRepository;&#10;    private LoadingDialog loadingDialog;&#10;    private ThreadManager threadManager;&#10;&#10;    private GetProfileResponse.ProfileData currentProfile;&#10;    private String currentProfileType; // Tipo de perfil del nivel superior de la respuesta&#10;    private List&lt;Sport&gt; sportList;&#10;    private List&lt;Location&gt; locationList;&#10;&#10;    // API Calls tracking&#10;    private Call&lt;GetProfileResponse&gt; currentProfileCall;&#10;    private Call&lt;UploadPhotoResponse&gt; currentUploadCall;&#10;    private Call&lt;DeletePhotoResponse&gt; currentDeleteCall;&#10;    private Call&lt;List&lt;Sport&gt;&gt; currentSportsCall;&#10;    private Call&lt;List&lt;Location&gt;&gt; currentLocationsCall;&#10;&#10;    // Launcher para seleccionar imagen&#10;    private ActivityResultLauncher&lt;Intent&gt; pickImageLauncher;&#10;    // Launcher para permisos&#10;    private ActivityResultLauncher&lt;String&gt; requestPermissionLauncher;&#10;&#10;    @Nullable&#10;    @Override&#10;    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {&#10;        View view = inflater.inflate(R.layout.fragment_profile, container, false);&#10;&#10;        // Inicializar launchers&#10;        initializeLaunchers();&#10;&#10;        // Inicializar vistas&#10;        imageProfilePhoto = view.findViewById(R.id.imageProfilePhoto);&#10;        buttonChangePhoto = view.findViewById(R.id.buttonChangePhoto);&#10;        textUserEmail = view.findViewById(R.id.textUserEmail);&#10;        textUserType = view.findViewById(R.id.textUserType);&#10;        textUserName = view.findViewById(R.id.textUserName);&#10;        textUserLastName = view.findViewById(R.id.textUserLastName);&#10;        textUserBirthdate = view.findViewById(R.id.textUserBirthdate);&#10;        textUserHeight = view.findViewById(R.id.textUserHeight);&#10;        textUserWeight = view.findViewById(R.id.textUserWeight);&#10;        textUserLocation = view.findViewById(R.id.textUserLocation);&#10;        textUserSport = view.findViewById(R.id.textUserSport);&#10;        textUserPhone = view.findViewById(R.id.textUserPhone);&#10;        textUserInstagram = view.findViewById(R.id.textUserInstagram);&#10;        textUserTwitter = view.findViewById(R.id.textUserTwitter);&#10;        textUserAgency = view.findViewById(R.id.textUserAgency);&#10;        textUserJob = view.findViewById(R.id.textUserJob);&#10;        textUserDescription = view.findViewById(R.id.textUserDescription);&#10;        buttonEditProfile = view.findViewById(R.id.buttonEditProfile);&#10;        buttonLogout = view.findViewById(R.id.buttonLogout);&#10;        btnSubscribe = view.findViewById(R.id.btnSubscribe);&#10;&#10;        // Inicializar utilidades&#10;        sessionManager = new SessionManager(requireContext());&#10;        authRepository = new AuthRepository();&#10;        lookupRepository = new LookupRepository();&#10;        subscriptionRepository = new SubscriptionRepository();&#10;        loadingDialog = new LoadingDialog(requireContext());&#10;        threadManager = ThreadManager.getInstance();&#10;&#10;        // Cargar información del usuario&#10;        loadUserProfile();&#10;&#10;        // Cargar estado de suscripción para actualizar el botón&#10;        updateSubscriptionButton();&#10;&#10;        // Configurar botón de cambiar foto&#10;        buttonChangePhoto.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                showPhotoOptions();&#10;            }&#10;        });&#10;&#10;        // Configurar botón de editar perfil&#10;        buttonEditProfile.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                if (currentProfile != null) {&#10;                    openEditProfile();&#10;                } else {&#10;                    Toast.makeText(requireContext(), &quot;Cargando información del perfil...&quot;, Toast.LENGTH_SHORT).show();&#10;                }&#10;            }&#10;        });&#10;&#10;        // Configurar botón de cerrar sesión&#10;        buttonLogout.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                logoutUser();&#10;            }&#10;        });&#10;&#10;        // Configurar botón de suscripción&#10;        btnSubscribe.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                // Acción para el botón de suscripción&#10;                handleSubscription();&#10;            }&#10;        });&#10;&#10;        return view;&#10;    }&#10;&#10;&#10;    private void initializeLaunchers() {&#10;        // Launcher para seleccionar imagen&#10;        pickImageLauncher = registerForActivityResult(&#10;                new ActivityResultContracts.StartActivityForResult(),&#10;                result -&gt; {&#10;                    if (result.getResultCode() == Activity.RESULT_OK &amp;&amp; result.getData() != null) {&#10;                        Uri imageUri = result.getData().getData();&#10;                        if (imageUri != null) {&#10;                            uploadPhotoFromUri(imageUri);&#10;                        }&#10;                    }&#10;                }&#10;        );&#10;&#10;        // Launcher para permisos&#10;        requestPermissionLauncher = registerForActivityResult(&#10;                new ActivityResultContracts.RequestPermission(),&#10;                isGranted -&gt; {&#10;                    if (isGranted) {&#10;                        openImagePicker();&#10;                    } else {&#10;                        Toast.makeText(requireContext(), &quot;Permiso denegado&quot;, Toast.LENGTH_SHORT).show();&#10;                    }&#10;                }&#10;        );&#10;    }&#10;&#10;    private void showPhotoOptions() {&#10;        // Mostrar opciones para cambiar o eliminar foto&#10;        androidx.appcompat.app.AlertDialog.Builder builder = new androidx.appcompat.app.AlertDialog.Builder(requireContext());&#10;        builder.setTitle(&quot;Foto de perfil&quot;);&#10;&#10;        String[] options;&#10;        if (currentProfile != null &amp;&amp; currentProfile.getPhotoUrl() != null &amp;&amp; !currentProfile.getPhotoUrl().isEmpty()) {&#10;            options = new String[]{&quot;Cambiar foto&quot;, &quot;Eliminar foto&quot;, &quot;Cancelar&quot;};&#10;        } else {&#10;            options = new String[]{&quot;Subir foto&quot;, &quot;Cancelar&quot;};&#10;        }&#10;&#10;        builder.setItems(options, (dialog, which) -&gt; {&#10;            if (options[which].equals(&quot;Cambiar foto&quot;) || options[which].equals(&quot;Subir foto&quot;)) {&#10;                checkPermissionAndOpenPicker();&#10;            } else if (options[which].equals(&quot;Eliminar foto&quot;)) {&#10;                deleteProfilePhoto();&#10;            }&#10;        });&#10;&#10;        builder.show();&#10;    }&#10;&#10;    private void checkPermissionAndOpenPicker() {&#10;        // En Android 13+ (API 33+) no se necesita permiso para leer imágenes seleccionadas por el usuario&#10;        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.TIRAMISU) {&#10;            openImagePicker();&#10;        } else {&#10;            // Para versiones anteriores, verificar permiso de lectura&#10;            if (ContextCompat.checkSelfPermission(requireContext(), Manifest.permission.READ_EXTERNAL_STORAGE)&#10;                    == PackageManager.PERMISSION_GRANTED) {&#10;                openImagePicker();&#10;            } else {&#10;                requestPermissionLauncher.launch(Manifest.permission.READ_EXTERNAL_STORAGE);&#10;            }&#10;        }&#10;    }&#10;&#10;    private void openImagePicker() {&#10;        Intent intent = new Intent(Intent.ACTION_PICK, MediaStore.Images.Media.EXTERNAL_CONTENT_URI);&#10;        intent.setType(&quot;image/*&quot;);&#10;        pickImageLauncher.launch(intent);&#10;    }&#10;&#10;    private void uploadPhotoFromUri(Uri imageUri) {&#10;        loadingDialog.show(&quot;Subiendo foto...&quot;);&#10;&#10;        threadManager.executeInBackground(() -&gt; {&#10;            try {&#10;                // Copiar el archivo a la caché de la app&#10;                File cacheDir = requireContext().getCacheDir();&#10;                File photoFile = new File(cacheDir, &quot;profile_photo_&quot; + System.currentTimeMillis() + &quot;.jpg&quot;);&#10;&#10;                InputStream inputStream = requireContext().getContentResolver().openInputStream(imageUri);&#10;                FileOutputStream outputStream = new FileOutputStream(photoFile);&#10;&#10;                byte[] buffer = new byte[4096];&#10;                int bytesRead;&#10;                while ((bytesRead = inputStream.read(buffer)) != -1) {&#10;                    outputStream.write(buffer, 0, bytesRead);&#10;                }&#10;&#10;                inputStream.close();&#10;                outputStream.close();&#10;&#10;                // Subir el archivo en el hilo principal&#10;                threadManager.executeOnMainThread(() -&gt; {&#10;                    uploadPhoto(photoFile);&#10;                });&#10;&#10;            } catch (Exception e) {&#10;                Log.e(TAG, &quot;Error al copiar archivo: &quot; + e.getMessage());&#10;                threadManager.executeOnMainThread(() -&gt; {&#10;                    loadingDialog.dismiss();&#10;                    Toast.makeText(requireContext(), &quot;Error al procesar la imagen&quot;, Toast.LENGTH_SHORT).show();&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void uploadPhoto(File photoFile) {&#10;        String token = sessionManager.getToken();&#10;        if (token == null) {&#10;            loadingDialog.dismiss();&#10;            Toast.makeText(requireContext(), &quot;Error: Sesión no válida&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        authRepository.uploadProfilePhoto(token, photoFile, new Callback&lt;UploadPhotoResponse&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;UploadPhotoResponse&gt; call, Response&lt;UploadPhotoResponse&gt; response) {&#10;                loadingDialog.dismiss();&#10;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    UploadPhotoResponse uploadResponse = response.body();&#10;                    Toast.makeText(requireContext(), &quot;Foto subida exitosamente&quot;, Toast.LENGTH_SHORT).show();&#10;&#10;                    // Actualizar la imagen inmediatamente&#10;                    if (uploadResponse.getPhotoUrl() != null) {&#10;                        loadProfilePhoto(uploadResponse.getPhotoUrl());&#10;                    }&#10;&#10;                    // Recargar el perfil completo&#10;                    loadUserProfile();&#10;                } else {&#10;                    Toast.makeText(requireContext(), &quot;Error al subir la foto&quot;, Toast.LENGTH_SHORT).show();&#10;                }&#10;&#10;                // Eliminar el archivo temporal&#10;                if (photoFile.exists()) {&#10;                    photoFile.delete();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;UploadPhotoResponse&gt; call, Throwable t) {&#10;                loadingDialog.dismiss();&#10;                Toast.makeText(requireContext(), &quot;Error de conexión&quot;, Toast.LENGTH_SHORT).show();&#10;&#10;                // Eliminar el archivo temporal&#10;                if (photoFile.exists()) {&#10;                    photoFile.delete();&#10;                }&#10;            }&#10;        });&#10;    }&#10;&#10;    private void deleteProfilePhoto() {&#10;        loadingDialog.show(&quot;Eliminando foto...&quot;);&#10;&#10;        String token = sessionManager.getToken();&#10;        if (token == null) {&#10;            loadingDialog.dismiss();&#10;            Toast.makeText(requireContext(), &quot;Error: Sesión no válida&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        authRepository.deleteProfilePhoto(token, new Callback&lt;DeletePhotoResponse&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;DeletePhotoResponse&gt; call, Response&lt;DeletePhotoResponse&gt; response) {&#10;                loadingDialog.dismiss();&#10;&#10;                if (response.isSuccessful()) {&#10;                    Toast.makeText(requireContext(), &quot;Foto eliminada exitosamente&quot;, Toast.LENGTH_SHORT).show();&#10;&#10;                    // Mostrar imagen por defecto&#10;                    imageProfilePhoto.setImageResource(android.R.drawable.ic_menu_camera);&#10;&#10;                    // Recargar el perfil&#10;                    loadUserProfile();&#10;                } else {&#10;                    Toast.makeText(requireContext(), &quot;Error al eliminar la foto&quot;, Toast.LENGTH_SHORT).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;DeletePhotoResponse&gt; call, Throwable t) {&#10;                loadingDialog.dismiss();&#10;                Toast.makeText(requireContext(), &quot;Error de conexión&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void loadProfilePhoto(String photoUrl) {&#10;        if (photoUrl != null &amp;&amp; !photoUrl.isEmpty()) {&#10;            Glide.with(this)&#10;                    .load(photoUrl)&#10;                    .diskCacheStrategy(DiskCacheStrategy.NONE)&#10;                    .skipMemoryCache(true)&#10;                    .placeholder(android.R.drawable.ic_menu_camera)&#10;                    .error(android.R.drawable.ic_menu_camera)&#10;                    .into(imageProfilePhoto);&#10;        } else {&#10;            imageProfilePhoto.setImageResource(android.R.drawable.ic_menu_camera);&#10;        }&#10;    }&#10;&#10;    private void loadUserProfile() {&#10;        loadingDialog.show(&quot;Cargando perfil...&quot;);&#10;&#10;        final String token = sessionManager.getToken();&#10;        final int userId = sessionManager.getUserId();&#10;&#10;        if (token == null || userId == -1) {&#10;            loadingDialog.dismiss();&#10;            Toast.makeText(requireContext(), &quot;Error: Sesión no válida&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        // Cargar sports y locations primero&#10;        loadLookupsData(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                // Una vez cargados los lookups, cargar el perfil&#10;                authRepository.getProfile(token, new Callback&lt;GetProfileResponse&gt;() {&#10;                    @Override&#10;                    public void onResponse(Call&lt;GetProfileResponse&gt; call, Response&lt;GetProfileResponse&gt; response) {&#10;                        loadingDialog.dismiss();&#10;&#10;                        if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                            GetProfileResponse profileResponse = response.body();&#10;                            if (profileResponse.getProfile() != null) {&#10;                                currentProfile = profileResponse.getProfile();&#10;                                currentProfileType = profileResponse.getProfileType(); // Guardar el tipo de perfil&#10;                                displayProfileData();&#10;                            } else {&#10;                                Toast.makeText(requireContext(), &quot;Error: Perfil no encontrado&quot;, Toast.LENGTH_SHORT).show();&#10;                            }&#10;                        } else {&#10;                            Log.e(TAG, &quot;Error al cargar perfil: &quot; + response.code());&#10;                            Toast.makeText(requireContext(), &quot;Error al cargar el perfil&quot;, Toast.LENGTH_SHORT).show();&#10;                        }&#10;                    }&#10;&#10;                    @Override&#10;                    public void onFailure(Call&lt;GetProfileResponse&gt; call, Throwable t) {&#10;                        loadingDialog.dismiss();&#10;                        Toast.makeText(requireContext(), &quot;Error de conexión&quot;, Toast.LENGTH_SHORT).show();&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void loadLookupsData(final Runnable onComplete) {&#10;        // Cargar deportes&#10;        lookupRepository.getSports(new Callback&lt;List&lt;Sport&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;List&lt;Sport&gt;&gt; call, Response&lt;List&lt;Sport&gt;&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    sportList = response.body();&#10;                    checkLookupsLoaded(onComplete);&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;List&lt;Sport&gt;&gt; call, Throwable t) {&#10;                // Error al cargar sports&#10;            }&#10;        });&#10;&#10;        // Cargar ubicaciones&#10;        lookupRepository.getLocations(new Callback&lt;List&lt;Location&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;List&lt;Location&gt;&gt; call, Response&lt;List&lt;Location&gt;&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    locationList = response.body();&#10;                    checkLookupsLoaded(onComplete);&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;List&lt;Location&gt;&gt; call, Throwable t) {&#10;                Log.e(TAG, &quot;Error al cargar locations: &quot; + t.getMessage());&#10;            }&#10;        });&#10;    }&#10;&#10;    private void checkLookupsLoaded(Runnable onComplete) {&#10;        if (sportList != null &amp;&amp; locationList != null &amp;&amp; onComplete != null) {&#10;            onComplete.run();&#10;        }&#10;    }&#10;&#10;    private void displayProfileData() {&#10;        if (currentProfile == null) return;&#10;&#10;        // Cargar foto de perfil&#10;        loadProfilePhoto(currentProfile.getPhotoUrl());&#10;&#10;        String email = sessionManager.getEmail();&#10;        String profileType = currentProfileType; // Usar el profileType guardado del nivel superior&#10;&#10;        textUserEmail.setText(&quot;Email: &quot; + (email != null ? email : &quot;No disponible&quot;));&#10;&#10;        // Traducir el tipo de perfil&#10;        String profileTypeText = &quot;No disponible&quot;;&#10;        if (profileType != null) {&#10;            switch (profileType.toLowerCase()) {&#10;                case &quot;athlete&quot;:&#10;                    profileTypeText = &quot;Atleta&quot;;&#10;                    break;&#10;                case &quot;agent&quot;:&#10;                    profileTypeText = &quot;Agente&quot;;&#10;                    break;&#10;                case &quot;team&quot;:&#10;                    profileTypeText = &quot;Equipo&quot;;&#10;                    break;&#10;                default:&#10;                    profileTypeText = profileType;&#10;            }&#10;        }&#10;        textUserType.setText(&quot;Tipo: &quot; + profileTypeText);&#10;&#10;        // Información común&#10;        textUserName.setText(&quot;Nombre: &quot; + (currentProfile.getName() != null ? currentProfile.getName() : &quot;No disponible&quot;));&#10;&#10;        if (currentProfile.getLastName() != null &amp;&amp; !currentProfile.getLastName().isEmpty()) {&#10;            textUserLastName.setVisibility(View.VISIBLE);&#10;            textUserLastName.setText(&quot;Apellido: &quot; + currentProfile.getLastName());&#10;        }&#10;&#10;        // Ubicación&#10;        String locationText = &quot;No disponible&quot;;&#10;        if (currentProfile.getLocationId() != null &amp;&amp; locationList != null) {&#10;            for (Location location : locationList) {&#10;                if (location.getId() == currentProfile.getLocationId()) {&#10;                    locationText = location.toString();&#10;                    break;&#10;                }&#10;            }&#10;        }&#10;        textUserLocation.setText(&quot;Ubicación: &quot; + locationText);&#10;&#10;        // Deporte&#10;        String sportText = &quot;No disponible&quot;;&#10;        if (currentProfile.getSportId() != null &amp;&amp; sportList != null) {&#10;            for (Sport sport : sportList) {&#10;                if (sport.getId() == currentProfile.getSportId()) {&#10;                    sportText = sport.getName();&#10;                    break;&#10;                }&#10;            }&#10;        }&#10;        textUserSport.setText(&quot;Deporte: &quot; + sportText);&#10;&#10;        textUserPhone.setText(&quot;Teléfono: &quot; + (currentProfile.getPhoneNumber() != null ? currentProfile.getPhoneNumber() : &quot;No disponible&quot;));&#10;&#10;        if (currentProfile.getIgUser() != null &amp;&amp; !currentProfile.getIgUser().isEmpty()) {&#10;            textUserInstagram.setVisibility(View.VISIBLE);&#10;            textUserInstagram.setText(&quot;Instagram: &quot; + currentProfile.getIgUser());&#10;        }&#10;&#10;        if (currentProfile.getxUser() != null &amp;&amp; !currentProfile.getxUser().isEmpty()) {&#10;            textUserTwitter.setVisibility(View.VISIBLE);&#10;            textUserTwitter.setText(&quot;X (Twitter): &quot; + currentProfile.getxUser());&#10;        }&#10;&#10;        if (currentProfile.getDescription() != null &amp;&amp; !currentProfile.getDescription().isEmpty()) {&#10;            textUserDescription.setVisibility(View.VISIBLE);&#10;            textUserDescription.setText(&quot;Descripción: &quot; + currentProfile.getDescription());&#10;        }&#10;&#10;        // Campos específicos por tipo de perfil&#10;        if (&quot;athlete&quot;.equalsIgnoreCase(profileType)) {&#10;            if (currentProfile.getBirthdate() != null &amp;&amp; !currentProfile.getBirthdate().isEmpty()) {&#10;                textUserBirthdate.setVisibility(View.VISIBLE);&#10;                textUserBirthdate.setText(&quot;Fecha de nacimiento: &quot; + formatDate(currentProfile.getBirthdate()));&#10;            }&#10;&#10;            if (currentProfile.getHeight() != null &amp;&amp; !currentProfile.getHeight().isEmpty()) {&#10;                textUserHeight.setVisibility(View.VISIBLE);&#10;                textUserHeight.setText(&quot;Altura: &quot; + currentProfile.getHeight() + &quot; cm&quot;);&#10;            }&#10;&#10;            if (currentProfile.getWeight() != null &amp;&amp; !currentProfile.getWeight().isEmpty()) {&#10;                textUserWeight.setVisibility(View.VISIBLE);&#10;                textUserWeight.setText(&quot;Peso: &quot; + currentProfile.getWeight() + &quot; kg&quot;);&#10;            }&#10;        } else if (&quot;agent&quot;.equalsIgnoreCase(profileType)) {&#10;            if (currentProfile.getAgency() != null &amp;&amp; !currentProfile.getAgency().isEmpty()) {&#10;                textUserAgency.setVisibility(View.VISIBLE);&#10;                textUserAgency.setText(&quot;Agencia: &quot; + currentProfile.getAgency());&#10;            }&#10;        } else if (&quot;team&quot;.equalsIgnoreCase(profileType)) {&#10;            if (currentProfile.getJob() != null &amp;&amp; !currentProfile.getJob().isEmpty()) {&#10;                textUserJob.setVisibility(View.VISIBLE);&#10;                textUserJob.setText(&quot;Puesto: &quot; + currentProfile.getJob());&#10;            }&#10;        }&#10;    }&#10;&#10;    private String formatDate(String isoDate) {&#10;        // Convertir de YYYY-MM-DD a DD/MM/YYYY&#10;        if (isoDate != null &amp;&amp; isoDate.length() == 10) {&#10;            String[] parts = isoDate.split(&quot;-&quot;);&#10;            if (parts.length == 3) {&#10;                return parts[2] + &quot;/&quot; + parts[1] + &quot;/&quot; + parts[0];&#10;            }&#10;        }&#10;        return isoDate;&#10;    }&#10;&#10;    private void openEditProfile() {&#10;        Intent intent = new Intent(requireActivity(), ProfileFormActivity.class);&#10;        intent.putExtra(&quot;isEditMode&quot;, true);&#10;        intent.putExtra(&quot;profileType&quot;, currentProfileType);&#10;        startActivity(intent);&#10;    }&#10;&#10;    @Override&#10;    public void onResume() {&#10;        super.onResume();&#10;        // Recargar el perfil cuando volvemos a este fragment&#10;        if (currentProfile != null) {&#10;            loadUserProfile();&#10;        }&#10;        // Notificar que el fragmento está listo&#10;        if (getActivity() instanceof HomeActivity) {&#10;            ((HomeActivity) getActivity()).setFragmentLoading(false);&#10;        }&#10;    }&#10;&#10;    private void logoutUser() {&#10;        loadingDialog.show(&quot;Cerrando sesión...&quot;);&#10;        buttonLogout.setEnabled(false);&#10;&#10;        threadManager.executeInBackground(new Runnable() {&#10;            @Override&#10;            public void run() {&#10;                // Cerrar sesión&#10;                sessionManager.logout();&#10;&#10;                // Pequeño delay para dar feedback visual&#10;                try {&#10;                    Thread.sleep(500);&#10;                } catch (InterruptedException e) {&#10;                    e.printStackTrace();&#10;                }&#10;&#10;                // Redirigir a MainActivity en el hilo principal&#10;                threadManager.executeOnMainThread(new Runnable() {&#10;                    @Override&#10;                    public void run() {&#10;                        loadingDialog.dismiss();&#10;&#10;                        Intent intent = new Intent(requireActivity(), MainActivity.class);&#10;                        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);&#10;                        startActivity(intent);&#10;                        requireActivity().finish();&#10;                    }&#10;                });&#10;            }&#10;        });&#10;    }&#10;&#10;    private void handleSubscription() {&#10;        // Primero verificar el estado de suscripción del usuario&#10;        loadingDialog.show(&quot;Verificando suscripción...&quot;);&#10;&#10;        String token = sessionManager.getToken();&#10;        if (token == null) {&#10;            loadingDialog.dismiss();&#10;            Toast.makeText(requireContext(), &quot;Error: Sesión no válida&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        subscriptionRepository.getSubscriptionStatus(token, new Callback&lt;com.example.sportconnection.model.SubscriptionStatus&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;com.example.sportconnection.model.SubscriptionStatus&gt; call, Response&lt;com.example.sportconnection.model.SubscriptionStatus&gt; response) {&#10;                loadingDialog.dismiss();&#10;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    com.example.sportconnection.model.SubscriptionStatus status = response.body();&#10;&#10;                    if (status.isActive()) {&#10;                        // Usuario ya tiene suscripción activa&#10;                        showSubscriptionDetails(status);&#10;                    } else {&#10;                        // Usuario no tiene suscripción, mostrar planes disponibles&#10;                        showSubscriptionPlans();&#10;                    }&#10;                } else if (response.code() == 404) {&#10;                    // 404 significa que no tiene suscripción, mostrar planes&#10;                    showSubscriptionPlans();&#10;                } else {&#10;                    // Otro error&#10;                    String errorMsg = &quot;Error al verificar suscripción (Código: &quot; + response.code() + &quot;)&quot;;&#10;                    Log.e(TAG, errorMsg);&#10;                    Toast.makeText(requireContext(), errorMsg, Toast.LENGTH_SHORT).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;com.example.sportconnection.model.SubscriptionStatus&gt; call, Throwable t) {&#10;                loadingDialog.dismiss();&#10;                Log.e(TAG, &quot;Error de conexión al verificar suscripción: &quot; + t.getMessage());&#10;                Toast.makeText(requireContext(), &quot;Error de conexión: &quot; + t.getMessage(), Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void updateSubscriptionButton() {&#10;        String token = sessionManager.getToken();&#10;        if (token == null) {&#10;            return;&#10;        }&#10;&#10;        subscriptionRepository.getSubscriptionStatus(token, new Callback&lt;com.example.sportconnection.model.SubscriptionStatus&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;com.example.sportconnection.model.SubscriptionStatus&gt; call, Response&lt;com.example.sportconnection.model.SubscriptionStatus&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    com.example.sportconnection.model.SubscriptionStatus status = response.body();&#10;&#10;                    if (status.isActive()) {&#10;                        // Usuario tiene suscripción activa&#10;                        btnSubscribe.setText(&quot;Premium ✓&quot;);&#10;                        btnSubscribe.setBackgroundColor(getResources().getColor(android.R.color.holo_green_dark));&#10;                    } else {&#10;                        // Usuario no tiene suscripción&#10;                        btnSubscribe.setText(&quot;Suscribirse&quot;);&#10;                    }&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;com.example.sportconnection.model.SubscriptionStatus&gt; call, Throwable t) {&#10;                // Mantener texto por defecto&#10;            }&#10;        });&#10;    }&#10;&#10;    private void showSubscriptionDetails(com.example.sportconnection.model.SubscriptionStatus status) {&#10;        // Mostrar detalles de la suscripción actual&#10;        androidx.appcompat.app.AlertDialog.Builder builder = new androidx.appcompat.app.AlertDialog.Builder(requireContext());&#10;        builder.setTitle(&quot;Suscripción Activa&quot;);&#10;&#10;        com.example.sportconnection.model.SubscriptionStatus.SubscriptionDetails details = status.getSubscriptionDetails();&#10;        String message = &quot;Plan: &quot; + details.getPlanName() + &quot;\n&quot; +&#10;                        &quot;Estado: &quot; + details.getStatus() + &quot;\n&quot; +&#10;                        &quot;Válida hasta: &quot; + formatSubscriptionDate(details.getEndDate());&#10;&#10;        builder.setMessage(message);&#10;        builder.setPositiveButton(&quot;Aceptar&quot;, null);&#10;        builder.setNeutralButton(&quot;Renovar&quot;, (dialog, which) -&gt; {&#10;            // Permitir renovar/cambiar plan&#10;            showSubscriptionPlans();&#10;        });&#10;        builder.show();&#10;    }&#10;&#10;    private void showSubscriptionPlans() {&#10;        loadingDialog.show(&quot;Cargando planes...&quot;);&#10;&#10;        String token = sessionManager.getToken();&#10;        if (token == null) {&#10;            loadingDialog.dismiss();&#10;            Toast.makeText(requireContext(), &quot;Error: Sesión no válida&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        subscriptionRepository.getSubscriptionPlans(token, new Callback&lt;List&lt;com.example.sportconnection.model.SubscriptionPlan&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;List&lt;com.example.sportconnection.model.SubscriptionPlan&gt;&gt; call, Response&lt;List&lt;com.example.sportconnection.model.SubscriptionPlan&gt;&gt; response) {&#10;                loadingDialog.dismiss();&#10;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null &amp;&amp; !response.body().isEmpty()) {&#10;                    List&lt;com.example.sportconnection.model.SubscriptionPlan&gt; plans = response.body();&#10;                    displaySubscriptionPlansDialog(plans);&#10;                } else {&#10;                    Toast.makeText(requireContext(), &quot;No hay planes disponibles&quot;, Toast.LENGTH_SHORT).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;List&lt;com.example.sportconnection.model.SubscriptionPlan&gt;&gt; call, Throwable t) {&#10;                loadingDialog.dismiss();&#10;                Toast.makeText(requireContext(), &quot;Error al cargar planes&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void displaySubscriptionPlansDialog(List&lt;com.example.sportconnection.model.SubscriptionPlan&gt; plans) {&#10;        androidx.appcompat.app.AlertDialog.Builder builder = new androidx.appcompat.app.AlertDialog.Builder(requireContext());&#10;        builder.setTitle(&quot;Selecciona un Plan Premium&quot;);&#10;&#10;        String[] planNames = new String[plans.size()];&#10;        for (int i = 0; i &lt; plans.size(); i++) {&#10;            planNames[i] = plans.get(i).toString();&#10;        }&#10;&#10;        builder.setItems(planNames, (dialog, which) -&gt; {&#10;            com.example.sportconnection.model.SubscriptionPlan selectedPlan = plans.get(which);&#10;            createCheckoutSession(selectedPlan.getId());&#10;        });&#10;&#10;        builder.setNegativeButton(&quot;Cancelar&quot;, null);&#10;        builder.show();&#10;    }&#10;&#10;    private void createCheckoutSession(int planId) {&#10;        loadingDialog.show(&quot;Preparando pago...&quot;);&#10;&#10;        String token = sessionManager.getToken();&#10;        if (token == null) {&#10;            loadingDialog.dismiss();&#10;            Toast.makeText(requireContext(), &quot;Error: Sesión no válida&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        subscriptionRepository.createCheckoutSession(token, planId, new Callback&lt;com.example.sportconnection.model.CheckoutSessionResponse&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;com.example.sportconnection.model.CheckoutSessionResponse&gt; call, Response&lt;com.example.sportconnection.model.CheckoutSessionResponse&gt; response) {&#10;                loadingDialog.dismiss();&#10;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    com.example.sportconnection.model.CheckoutSessionResponse checkoutResponse = response.body();&#10;                    String checkoutUrl = checkoutResponse.getCheckoutUrl();&#10;&#10;                    // Abrir el navegador con la URL de checkout de Stripe&#10;                    openStripeCheckout(checkoutUrl);&#10;                } else {&#10;                    String errorMessage = &quot;Error al crear sesión de pago&quot;;&#10;                    if (response.code() == 400) {&#10;                        errorMessage = &quot;Ya tienes una suscripción activa&quot;;&#10;                    }&#10;                    Toast.makeText(requireContext(), errorMessage, Toast.LENGTH_SHORT).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;com.example.sportconnection.model.CheckoutSessionResponse&gt; call, Throwable t) {&#10;                loadingDialog.dismiss();&#10;                Toast.makeText(requireContext(), &quot;Error de conexión&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void openStripeCheckout(String checkoutUrl) {&#10;        try {&#10;            Intent browserIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(checkoutUrl));&#10;            startActivity(browserIntent);&#10;&#10;            Toast.makeText(requireContext(),&#10;                &quot;Completa el pago en el navegador. La suscripción se activará automáticamente.&quot;,&#10;                Toast.LENGTH_LONG).show();&#10;        } catch (Exception e) {&#10;            Log.e(TAG, &quot;Error al abrir navegador: &quot; + e.getMessage());&#10;            Toast.makeText(requireContext(), &quot;Error al abrir el navegador&quot;, Toast.LENGTH_SHORT).show();&#10;        }&#10;    }&#10;&#10;    private String formatSubscriptionDate(String isoDate) {&#10;        // Convertir fecha ISO a formato legible&#10;        if (isoDate != null &amp;&amp; isoDate.length() &gt;= 10) {&#10;            String datePart = isoDate.substring(0, 10);&#10;            String[] parts = datePart.split(&quot;-&quot;);&#10;            if (parts.length == 3) {&#10;                return parts[2] + &quot;/&quot; + parts[1] + &quot;/&quot; + parts[0];&#10;            }&#10;        }&#10;        return isoDate;&#10;    }&#10;&#10;    @Override&#10;    public void onDestroyView() {&#10;        super.onDestroyView();&#10;&#10;        // Cancelar llamadas API pendientes&#10;        if (currentProfileCall != null &amp;&amp; !currentProfileCall.isCanceled()) {&#10;            currentProfileCall.cancel();&#10;        }&#10;        if (currentUploadCall != null &amp;&amp; !currentUploadCall.isCanceled()) {&#10;            currentUploadCall.cancel();&#10;        }&#10;        if (currentDeleteCall != null &amp;&amp; !currentDeleteCall.isCanceled()) {&#10;            currentDeleteCall.cancel();&#10;        }&#10;        if (currentSportsCall != null &amp;&amp; !currentSportsCall.isCanceled()) {&#10;            currentSportsCall.cancel();&#10;        }&#10;        if (currentLocationsCall != null &amp;&amp; !currentLocationsCall.isCanceled()) {&#10;            currentLocationsCall.cancel();&#10;        }&#10;&#10;        // Cerrar el diálogo si está abierto&#10;        if (loadingDialog != null &amp;&amp; loadingDialog.isShowing()) {&#10;            loadingDialog.dismiss();&#10;        }&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.sportconnection.fragments;&#13;&#10;&#13;&#10;import android.Manifest;&#13;&#10;import android.app.Activity;&#13;&#10;import android.content.Intent;&#13;&#10;import android.content.pm.PackageManager;&#13;&#10;import android.net.Uri;&#13;&#10;import android.os.Build;&#13;&#10;import android.os.Bundle;&#13;&#10;import android.provider.MediaStore;&#13;&#10;import android.util.Log;&#13;&#10;import android.view.LayoutInflater;&#13;&#10;import android.view.View;&#13;&#10;import android.view.ViewGroup;&#13;&#10;import android.widget.Button;&#13;&#10;import android.widget.ImageView;&#13;&#10;import android.widget.TextView;&#13;&#10;import android.widget.Toast;&#13;&#10;&#13;&#10;import androidx.activity.result.ActivityResultLauncher;&#13;&#10;import androidx.activity.result.contract.ActivityResultContracts;&#13;&#10;import androidx.annotation.NonNull;&#13;&#10;import androidx.annotation.Nullable;&#13;&#10;import androidx.core.content.ContextCompat;&#13;&#10;import androidx.fragment.app.Fragment;&#13;&#10;&#13;&#10;import com.bumptech.glide.Glide;&#13;&#10;import com.bumptech.glide.load.engine.DiskCacheStrategy;&#13;&#10;import com.example.sportconnection.HomeActivity;&#13;&#10;import com.example.sportconnection.MainActivity;&#13;&#10;import com.example.sportconnection.ProfileFormActivity;&#13;&#10;import com.example.sportconnection.R;&#13;&#10;import com.example.sportconnection.model.DeletePhotoResponse;&#13;&#10;import com.example.sportconnection.model.Location;&#13;&#10;import com.example.sportconnection.model.GetProfileResponse;&#13;&#10;import com.example.sportconnection.model.Sport;&#13;&#10;import com.example.sportconnection.model.UploadPhotoResponse;&#13;&#10;import com.example.sportconnection.repository.AuthRepository;&#13;&#10;import com.example.sportconnection.repository.LookupRepository;&#13;&#10;import com.example.sportconnection.repository.SubscriptionRepository;&#13;&#10;import com.example.sportconnection.utils.LoadingDialog;&#13;&#10;import com.example.sportconnection.utils.SessionManager;&#13;&#10;import com.example.sportconnection.utils.ThreadManager;&#13;&#10;&#13;&#10;import java.io.File;&#13;&#10;import java.io.FileOutputStream;&#13;&#10;import java.io.InputStream;&#13;&#10;import java.util.List;&#13;&#10;&#13;&#10;import retrofit2.Call;&#13;&#10;import retrofit2.Callback;&#13;&#10;import retrofit2.Response;&#13;&#10;&#13;&#10;public class ProfileFragment extends Fragment {&#13;&#10;    private static final String TAG = &quot;ProfileFragment&quot;;&#13;&#10;    private static final int REQUEST_PERMISSION_READ_STORAGE = 100;&#13;&#10;&#13;&#10;    private ImageView imageProfilePhoto;&#13;&#10;    private Button buttonChangePhoto;&#13;&#10;    private TextView textUserEmail;&#13;&#10;    private TextView textUserType;&#13;&#10;    private TextView textUserName;&#13;&#10;    private TextView textUserLastName;&#13;&#10;    private TextView textUserBirthdate;&#13;&#10;    private TextView textUserHeight;&#13;&#10;    private TextView textUserWeight;&#13;&#10;    private TextView textUserLocation;&#13;&#10;    private TextView textUserSport;&#13;&#10;    private TextView textUserPhone;&#13;&#10;    private TextView textUserInstagram;&#13;&#10;    private TextView textUserTwitter;&#13;&#10;    private TextView textUserAgency;&#13;&#10;    private TextView textUserJob;&#13;&#10;    private TextView textUserDescription;&#13;&#10;    private Button buttonEditProfile;&#13;&#10;    private Button buttonLogout;&#13;&#10;    private Button btnSubscribe;&#13;&#10;&#13;&#10;    private SessionManager sessionManager;&#13;&#10;    private AuthRepository authRepository;&#13;&#10;    private LookupRepository lookupRepository;&#13;&#10;    private SubscriptionRepository subscriptionRepository;&#13;&#10;    private LoadingDialog loadingDialog;&#13;&#10;    private ThreadManager threadManager;&#13;&#10;&#13;&#10;    private GetProfileResponse.ProfileData currentProfile;&#13;&#10;    private String currentProfileType; // Tipo de perfil del nivel superior de la respuesta&#13;&#10;    private List&lt;Sport&gt; sportList;&#13;&#10;    private List&lt;Location&gt; locationList;&#13;&#10;&#13;&#10;    // API Calls tracking&#13;&#10;    private Call&lt;GetProfileResponse&gt; currentProfileCall;&#13;&#10;    private Call&lt;UploadPhotoResponse&gt; currentUploadCall;&#13;&#10;    private Call&lt;DeletePhotoResponse&gt; currentDeleteCall;&#13;&#10;    private Call&lt;List&lt;Sport&gt;&gt; currentSportsCall;&#13;&#10;    private Call&lt;List&lt;Location&gt;&gt; currentLocationsCall;&#13;&#10;&#13;&#10;    // Launcher para seleccionar imagen&#13;&#10;    private ActivityResultLauncher&lt;Intent&gt; pickImageLauncher;&#13;&#10;    // Launcher para permisos&#13;&#10;    private ActivityResultLauncher&lt;String&gt; requestPermissionLauncher;&#13;&#10;&#13;&#10;    @Nullable&#13;&#10;    @Override&#13;&#10;    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {&#13;&#10;        View view = inflater.inflate(R.layout.fragment_profile, container, false);&#13;&#10;&#13;&#10;        // Inicializar launchers&#13;&#10;        initializeLaunchers();&#13;&#10;&#13;&#10;        // Inicializar vistas&#13;&#10;        imageProfilePhoto = view.findViewById(R.id.imageProfilePhoto);&#13;&#10;        buttonChangePhoto = view.findViewById(R.id.buttonChangePhoto);&#13;&#10;        textUserEmail = view.findViewById(R.id.textUserEmail);&#13;&#10;        textUserType = view.findViewById(R.id.textUserType);&#13;&#10;        textUserName = view.findViewById(R.id.textUserName);&#13;&#10;        textUserLastName = view.findViewById(R.id.textUserLastName);&#13;&#10;        textUserBirthdate = view.findViewById(R.id.textUserBirthdate);&#13;&#10;        textUserHeight = view.findViewById(R.id.textUserHeight);&#13;&#10;        textUserWeight = view.findViewById(R.id.textUserWeight);&#13;&#10;        textUserLocation = view.findViewById(R.id.textUserLocation);&#13;&#10;        textUserSport = view.findViewById(R.id.textUserSport);&#13;&#10;        textUserPhone = view.findViewById(R.id.textUserPhone);&#13;&#10;        textUserInstagram = view.findViewById(R.id.textUserInstagram);&#13;&#10;        textUserTwitter = view.findViewById(R.id.textUserTwitter);&#13;&#10;        textUserAgency = view.findViewById(R.id.textUserAgency);&#13;&#10;        textUserJob = view.findViewById(R.id.textUserJob);&#13;&#10;        textUserDescription = view.findViewById(R.id.textUserDescription);&#13;&#10;        buttonEditProfile = view.findViewById(R.id.buttonEditProfile);&#13;&#10;        buttonLogout = view.findViewById(R.id.buttonLogout);&#13;&#10;        btnSubscribe = view.findViewById(R.id.btnSubscribe);&#13;&#10;&#13;&#10;        // Inicializar utilidades&#13;&#10;        sessionManager = new SessionManager(requireContext());&#13;&#10;        authRepository = new AuthRepository();&#13;&#10;        lookupRepository = new LookupRepository();&#13;&#10;        subscriptionRepository = new SubscriptionRepository();&#13;&#10;        loadingDialog = new LoadingDialog(requireContext());&#13;&#10;        threadManager = ThreadManager.getInstance();&#13;&#10;&#13;&#10;        // Cargar información del usuario&#13;&#10;        loadUserProfile();&#13;&#10;&#13;&#10;        // Cargar estado de suscripción para actualizar el botón&#13;&#10;        updateSubscriptionButton();&#13;&#10;&#13;&#10;        // Configurar botón de cambiar foto&#13;&#10;        buttonChangePhoto.setOnClickListener(new View.OnClickListener() {&#13;&#10;            @Override&#13;&#10;            public void onClick(View v) {&#13;&#10;                showPhotoOptions();&#13;&#10;            }&#13;&#10;        });&#13;&#10;&#13;&#10;        // Configurar botón de editar perfil&#13;&#10;        buttonEditProfile.setOnClickListener(new View.OnClickListener() {&#13;&#10;            @Override&#13;&#10;            public void onClick(View v) {&#13;&#10;                if (currentProfile != null) {&#13;&#10;                    openEditProfile();&#13;&#10;                } else {&#13;&#10;                    Toast.makeText(requireContext(), &quot;Cargando información del perfil...&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                }&#13;&#10;            }&#13;&#10;        });&#13;&#10;&#13;&#10;        // Configurar botón de cerrar sesión&#13;&#10;        buttonLogout.setOnClickListener(new View.OnClickListener() {&#13;&#10;            @Override&#13;&#10;            public void onClick(View v) {&#13;&#10;                logoutUser();&#13;&#10;            }&#13;&#10;        });&#13;&#10;&#13;&#10;        // Configurar botón de suscripción&#13;&#10;        btnSubscribe.setOnClickListener(new View.OnClickListener() {&#13;&#10;            @Override&#13;&#10;            public void onClick(View v) {&#13;&#10;                // Acción para el botón de suscripción&#13;&#10;                handleSubscription();&#13;&#10;            }&#13;&#10;        });&#13;&#10;&#13;&#10;        return view;&#13;&#10;    }&#13;&#10;&#13;&#10;&#13;&#10;    private void initializeLaunchers() {&#13;&#10;        // Launcher para seleccionar imagen&#13;&#10;        pickImageLauncher = registerForActivityResult(&#13;&#10;                new ActivityResultContracts.StartActivityForResult(),&#13;&#10;                result -&gt; {&#13;&#10;                    if (result.getResultCode() == Activity.RESULT_OK &amp;&amp; result.getData() != null) {&#13;&#10;                        Uri imageUri = result.getData().getData();&#13;&#10;                        if (imageUri != null) {&#13;&#10;                            uploadPhotoFromUri(imageUri);&#13;&#10;                        }&#13;&#10;                    }&#13;&#10;                }&#13;&#10;        );&#13;&#10;&#13;&#10;        // Launcher para permisos&#13;&#10;        requestPermissionLauncher = registerForActivityResult(&#13;&#10;                new ActivityResultContracts.RequestPermission(),&#13;&#10;                isGranted -&gt; {&#13;&#10;                    if (isGranted) {&#13;&#10;                        openImagePicker();&#13;&#10;                    } else {&#13;&#10;                        Toast.makeText(requireContext(), &quot;Permiso denegado&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                    }&#13;&#10;                }&#13;&#10;        );&#13;&#10;    }&#13;&#10;&#13;&#10;    private void showPhotoOptions() {&#13;&#10;        // Mostrar opciones para cambiar o eliminar foto&#13;&#10;        androidx.appcompat.app.AlertDialog.Builder builder = new androidx.appcompat.app.AlertDialog.Builder(requireContext());&#13;&#10;        builder.setTitle(&quot;Foto de perfil&quot;);&#13;&#10;&#13;&#10;        String[] options;&#13;&#10;        if (currentProfile != null &amp;&amp; currentProfile.getPhotoUrl() != null &amp;&amp; !currentProfile.getPhotoUrl().isEmpty()) {&#13;&#10;            options = new String[]{&quot;Cambiar foto&quot;, &quot;Eliminar foto&quot;, &quot;Cancelar&quot;};&#13;&#10;        } else {&#13;&#10;            options = new String[]{&quot;Subir foto&quot;, &quot;Cancelar&quot;};&#13;&#10;        }&#13;&#10;&#13;&#10;        builder.setItems(options, (dialog, which) -&gt; {&#13;&#10;            if (options[which].equals(&quot;Cambiar foto&quot;) || options[which].equals(&quot;Subir foto&quot;)) {&#13;&#10;                checkPermissionAndOpenPicker();&#13;&#10;            } else if (options[which].equals(&quot;Eliminar foto&quot;)) {&#13;&#10;                deleteProfilePhoto();&#13;&#10;            }&#13;&#10;        });&#13;&#10;&#13;&#10;        builder.show();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void checkPermissionAndOpenPicker() {&#13;&#10;        // En Android 13+ (API 33+) no se necesita permiso para leer imágenes seleccionadas por el usuario&#13;&#10;        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.TIRAMISU) {&#13;&#10;            openImagePicker();&#13;&#10;        } else {&#13;&#10;            // Para versiones anteriores, verificar permiso de lectura&#13;&#10;            if (ContextCompat.checkSelfPermission(requireContext(), Manifest.permission.READ_EXTERNAL_STORAGE)&#13;&#10;                    == PackageManager.PERMISSION_GRANTED) {&#13;&#10;                openImagePicker();&#13;&#10;            } else {&#13;&#10;                requestPermissionLauncher.launch(Manifest.permission.READ_EXTERNAL_STORAGE);&#13;&#10;            }&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void openImagePicker() {&#13;&#10;        Intent intent = new Intent(Intent.ACTION_PICK, MediaStore.Images.Media.EXTERNAL_CONTENT_URI);&#13;&#10;        intent.setType(&quot;image/*&quot;);&#13;&#10;        pickImageLauncher.launch(intent);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void uploadPhotoFromUri(Uri imageUri) {&#13;&#10;        loadingDialog.show(&quot;Subiendo foto...&quot;);&#13;&#10;&#13;&#10;        threadManager.executeInBackground(() -&gt; {&#13;&#10;            try {&#13;&#10;                // Copiar el archivo a la caché de la app&#13;&#10;                File cacheDir = requireContext().getCacheDir();&#13;&#10;                File photoFile = new File(cacheDir, &quot;profile_photo_&quot; + System.currentTimeMillis() + &quot;.jpg&quot;);&#13;&#10;&#13;&#10;                InputStream inputStream = requireContext().getContentResolver().openInputStream(imageUri);&#13;&#10;                FileOutputStream outputStream = new FileOutputStream(photoFile);&#13;&#10;&#13;&#10;                byte[] buffer = new byte[4096];&#13;&#10;                int bytesRead;&#13;&#10;                while ((bytesRead = inputStream.read(buffer)) != -1) {&#13;&#10;                    outputStream.write(buffer, 0, bytesRead);&#13;&#10;                }&#13;&#10;&#13;&#10;                inputStream.close();&#13;&#10;                outputStream.close();&#13;&#10;&#13;&#10;                // Subir el archivo en el hilo principal&#13;&#10;                threadManager.executeOnMainThread(() -&gt; {&#13;&#10;                    uploadPhoto(photoFile);&#13;&#10;                });&#13;&#10;&#13;&#10;            } catch (Exception e) {&#13;&#10;                Log.e(TAG, &quot;Error al copiar archivo: &quot; + e.getMessage());&#13;&#10;                threadManager.executeOnMainThread(() -&gt; {&#13;&#10;                    loadingDialog.dismiss();&#13;&#10;                    Toast.makeText(requireContext(), &quot;Error al procesar la imagen&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                });&#13;&#10;            }&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void uploadPhoto(File photoFile) {&#13;&#10;        String token = sessionManager.getToken();&#13;&#10;        if (token == null) {&#13;&#10;            loadingDialog.dismiss();&#13;&#10;            Toast.makeText(requireContext(), &quot;Error: Sesión no válida&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        authRepository.uploadProfilePhoto(token, photoFile, new Callback&lt;UploadPhotoResponse&gt;() {&#13;&#10;            @Override&#13;&#10;            public void onResponse(Call&lt;UploadPhotoResponse&gt; call, Response&lt;UploadPhotoResponse&gt; response) {&#13;&#10;                loadingDialog.dismiss();&#13;&#10;&#13;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#13;&#10;                    UploadPhotoResponse uploadResponse = response.body();&#13;&#10;                    Toast.makeText(requireContext(), &quot;Foto subida exitosamente&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;&#13;&#10;                    // Actualizar la imagen inmediatamente&#13;&#10;                    if (uploadResponse.getPhotoUrl() != null) {&#13;&#10;                        loadProfilePhoto(uploadResponse.getPhotoUrl());&#13;&#10;                    }&#13;&#10;&#13;&#10;                    // Recargar el perfil completo&#13;&#10;                    loadUserProfile();&#13;&#10;                } else {&#13;&#10;                    Toast.makeText(requireContext(), &quot;Error al subir la foto&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                }&#13;&#10;&#13;&#10;                // Eliminar el archivo temporal&#13;&#10;                if (photoFile.exists()) {&#13;&#10;                    photoFile.delete();&#13;&#10;                }&#13;&#10;            }&#13;&#10;&#13;&#10;            @Override&#13;&#10;            public void onFailure(Call&lt;UploadPhotoResponse&gt; call, Throwable t) {&#13;&#10;                loadingDialog.dismiss();&#13;&#10;                Toast.makeText(requireContext(), &quot;Error de conexión&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;&#13;&#10;                // Eliminar el archivo temporal&#13;&#10;                if (photoFile.exists()) {&#13;&#10;                    photoFile.delete();&#13;&#10;                }&#13;&#10;            }&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void deleteProfilePhoto() {&#13;&#10;        loadingDialog.show(&quot;Eliminando foto...&quot;);&#13;&#10;&#13;&#10;        String token = sessionManager.getToken();&#13;&#10;        if (token == null) {&#13;&#10;            loadingDialog.dismiss();&#13;&#10;            Toast.makeText(requireContext(), &quot;Error: Sesión no válida&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        authRepository.deleteProfilePhoto(token, new Callback&lt;DeletePhotoResponse&gt;() {&#13;&#10;            @Override&#13;&#10;            public void onResponse(Call&lt;DeletePhotoResponse&gt; call, Response&lt;DeletePhotoResponse&gt; response) {&#13;&#10;                loadingDialog.dismiss();&#13;&#10;&#13;&#10;                if (response.isSuccessful()) {&#13;&#10;                    Toast.makeText(requireContext(), &quot;Foto eliminada exitosamente&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;&#13;&#10;                    // Mostrar imagen por defecto&#13;&#10;                    imageProfilePhoto.setImageResource(android.R.drawable.ic_menu_camera);&#13;&#10;&#13;&#10;                    // Recargar el perfil&#13;&#10;                    loadUserProfile();&#13;&#10;                } else {&#13;&#10;                    Toast.makeText(requireContext(), &quot;Error al eliminar la foto&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                }&#13;&#10;            }&#13;&#10;&#13;&#10;            @Override&#13;&#10;            public void onFailure(Call&lt;DeletePhotoResponse&gt; call, Throwable t) {&#13;&#10;                loadingDialog.dismiss();&#13;&#10;                Toast.makeText(requireContext(), &quot;Error de conexión&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            }&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void loadProfilePhoto(String photoUrl) {&#13;&#10;        if (photoUrl != null &amp;&amp; !photoUrl.isEmpty()) {&#13;&#10;            Glide.with(this)&#13;&#10;                    .load(photoUrl)&#13;&#10;                    .diskCacheStrategy(DiskCacheStrategy.NONE)&#13;&#10;                    .skipMemoryCache(true)&#13;&#10;                    .placeholder(android.R.drawable.ic_menu_camera)&#13;&#10;                    .error(android.R.drawable.ic_menu_camera)&#13;&#10;                    .into(imageProfilePhoto);&#13;&#10;        } else {&#13;&#10;            imageProfilePhoto.setImageResource(android.R.drawable.ic_menu_camera);&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void loadUserProfile() {&#13;&#10;        loadingDialog.show(&quot;Cargando perfil...&quot;);&#13;&#10;&#13;&#10;        final String token = sessionManager.getToken();&#13;&#10;        final int userId = sessionManager.getUserId();&#13;&#10;&#13;&#10;        if (token == null || userId == -1) {&#13;&#10;            loadingDialog.dismiss();&#13;&#10;            Toast.makeText(requireContext(), &quot;Error: Sesión no válida&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        // Cargar sports y locations primero&#13;&#10;        loadLookupsData(new Runnable() {&#13;&#10;            @Override&#13;&#10;            public void run() {&#13;&#10;                // Una vez cargados los lookups, cargar el perfil&#13;&#10;                authRepository.getProfile(token, new Callback&lt;GetProfileResponse&gt;() {&#13;&#10;                    @Override&#13;&#10;                    public void onResponse(Call&lt;GetProfileResponse&gt; call, Response&lt;GetProfileResponse&gt; response) {&#13;&#10;                        loadingDialog.dismiss();&#13;&#10;&#13;&#10;                        if (response.isSuccessful() &amp;&amp; response.body() != null) {&#13;&#10;                            GetProfileResponse profileResponse = response.body();&#13;&#10;                            if (profileResponse.getProfile() != null) {&#13;&#10;                                currentProfile = profileResponse.getProfile();&#13;&#10;                                currentProfileType = profileResponse.getProfileType(); // Guardar el tipo de perfil&#13;&#10;                                displayProfileData();&#13;&#10;                            } else {&#13;&#10;                                Toast.makeText(requireContext(), &quot;Error: Perfil no encontrado&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                            }&#13;&#10;                        } else {&#13;&#10;                            Log.e(TAG, &quot;Error al cargar perfil: &quot; + response.code());&#13;&#10;                            Toast.makeText(requireContext(), &quot;Error al cargar el perfil&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                        }&#13;&#10;                    }&#13;&#10;&#13;&#10;                    @Override&#13;&#10;                    public void onFailure(Call&lt;GetProfileResponse&gt; call, Throwable t) {&#13;&#10;                        loadingDialog.dismiss();&#13;&#10;                        Toast.makeText(requireContext(), &quot;Error de conexión&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                    }&#13;&#10;                });&#13;&#10;            }&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void loadLookupsData(final Runnable onComplete) {&#13;&#10;        // Cargar deportes&#13;&#10;        lookupRepository.getSports(new Callback&lt;List&lt;Sport&gt;&gt;() {&#13;&#10;            @Override&#13;&#10;            public void onResponse(Call&lt;List&lt;Sport&gt;&gt; call, Response&lt;List&lt;Sport&gt;&gt; response) {&#13;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#13;&#10;                    sportList = response.body();&#13;&#10;                    checkLookupsLoaded(onComplete);&#13;&#10;                }&#13;&#10;            }&#13;&#10;&#13;&#10;            @Override&#13;&#10;            public void onFailure(Call&lt;List&lt;Sport&gt;&gt; call, Throwable t) {&#13;&#10;                // Error al cargar sports&#13;&#10;            }&#13;&#10;        });&#13;&#10;&#13;&#10;        // Cargar ubicaciones&#13;&#10;        lookupRepository.getLocations(new Callback&lt;List&lt;Location&gt;&gt;() {&#13;&#10;            @Override&#13;&#10;            public void onResponse(Call&lt;List&lt;Location&gt;&gt; call, Response&lt;List&lt;Location&gt;&gt; response) {&#13;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#13;&#10;                    locationList = response.body();&#13;&#10;                    checkLookupsLoaded(onComplete);&#13;&#10;                }&#13;&#10;            }&#13;&#10;&#13;&#10;            @Override&#13;&#10;            public void onFailure(Call&lt;List&lt;Location&gt;&gt; call, Throwable t) {&#13;&#10;                Log.e(TAG, &quot;Error al cargar locations: &quot; + t.getMessage());&#13;&#10;            }&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void checkLookupsLoaded(Runnable onComplete) {&#13;&#10;        if (sportList != null &amp;&amp; locationList != null &amp;&amp; onComplete != null) {&#13;&#10;            onComplete.run();&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void displayProfileData() {&#13;&#10;        if (currentProfile == null) return;&#13;&#10;&#13;&#10;        // Cargar foto de perfil&#13;&#10;        loadProfilePhoto(currentProfile.getPhotoUrl());&#13;&#10;&#13;&#10;        String email = sessionManager.getEmail();&#13;&#10;        String profileType = currentProfileType; // Usar el profileType guardado del nivel superior&#13;&#10;&#13;&#10;        textUserEmail.setText(&quot;Email: &quot; + (email != null ? email : &quot;No disponible&quot;));&#13;&#10;&#13;&#10;        // Traducir el tipo de perfil&#13;&#10;        String profileTypeText = &quot;No disponible&quot;;&#13;&#10;        if (profileType != null) {&#13;&#10;            switch (profileType.toLowerCase()) {&#13;&#10;                case &quot;athlete&quot;:&#13;&#10;                    profileTypeText = &quot;Atleta&quot;;&#13;&#10;                    break;&#13;&#10;                case &quot;agent&quot;:&#13;&#10;                    profileTypeText = &quot;Agente&quot;;&#13;&#10;                    break;&#13;&#10;                case &quot;team&quot;:&#13;&#10;                    profileTypeText = &quot;Equipo&quot;;&#13;&#10;                    break;&#13;&#10;                default:&#13;&#10;                    profileTypeText = profileType;&#13;&#10;            }&#13;&#10;        }&#13;&#10;        textUserType.setText(&quot;Tipo: &quot; + profileTypeText);&#13;&#10;&#13;&#10;        // Información común&#13;&#10;        textUserName.setText(&quot;Nombre: &quot; + (currentProfile.getName() != null ? currentProfile.getName() : &quot;No disponible&quot;));&#13;&#10;&#13;&#10;        if (currentProfile.getLastName() != null &amp;&amp; !currentProfile.getLastName().isEmpty()) {&#13;&#10;            textUserLastName.setVisibility(View.VISIBLE);&#13;&#10;            textUserLastName.setText(&quot;Apellido: &quot; + currentProfile.getLastName());&#13;&#10;        }&#13;&#10;&#13;&#10;        // Ubicación&#13;&#10;        String locationText = &quot;No disponible&quot;;&#13;&#10;        if (currentProfile.getLocationId() != null &amp;&amp; locationList != null) {&#13;&#10;            for (Location location : locationList) {&#13;&#10;                if (location.getId() == currentProfile.getLocationId()) {&#13;&#10;                    locationText = location.toString();&#13;&#10;                    break;&#13;&#10;                }&#13;&#10;            }&#13;&#10;        }&#13;&#10;        textUserLocation.setText(&quot;Ubicación: &quot; + locationText);&#13;&#10;&#13;&#10;        // Deporte&#13;&#10;        String sportText = &quot;No disponible&quot;;&#13;&#10;        if (currentProfile.getSportId() != null &amp;&amp; sportList != null) {&#13;&#10;            for (Sport sport : sportList) {&#13;&#10;                if (sport.getId() == currentProfile.getSportId()) {&#13;&#10;                    sportText = sport.getName();&#13;&#10;                    break;&#13;&#10;                }&#13;&#10;            }&#13;&#10;        }&#13;&#10;        textUserSport.setText(&quot;Deporte: &quot; + sportText);&#13;&#10;&#13;&#10;        textUserPhone.setText(&quot;Teléfono: &quot; + (currentProfile.getPhoneNumber() != null ? currentProfile.getPhoneNumber() : &quot;No disponible&quot;));&#13;&#10;&#13;&#10;        if (currentProfile.getIgUser() != null &amp;&amp; !currentProfile.getIgUser().isEmpty()) {&#13;&#10;            textUserInstagram.setVisibility(View.VISIBLE);&#13;&#10;            textUserInstagram.setText(&quot;Instagram: &quot; + currentProfile.getIgUser());&#13;&#10;        }&#13;&#10;&#13;&#10;        if (currentProfile.getxUser() != null &amp;&amp; !currentProfile.getxUser().isEmpty()) {&#13;&#10;            textUserTwitter.setVisibility(View.VISIBLE);&#13;&#10;            textUserTwitter.setText(&quot;X (Twitter): &quot; + currentProfile.getxUser());&#13;&#10;        }&#13;&#10;&#13;&#10;        if (currentProfile.getDescription() != null &amp;&amp; !currentProfile.getDescription().isEmpty()) {&#13;&#10;            textUserDescription.setVisibility(View.VISIBLE);&#13;&#10;            textUserDescription.setText(&quot;Descripción: &quot; + currentProfile.getDescription());&#13;&#10;        }&#13;&#10;&#13;&#10;        // Campos específicos por tipo de perfil&#13;&#10;        if (&quot;athlete&quot;.equalsIgnoreCase(profileType)) {&#13;&#10;            if (currentProfile.getBirthdate() != null &amp;&amp; !currentProfile.getBirthdate().isEmpty()) {&#13;&#10;                textUserBirthdate.setVisibility(View.VISIBLE);&#13;&#10;                textUserBirthdate.setText(&quot;Fecha de nacimiento: &quot; + formatDate(currentProfile.getBirthdate()));&#13;&#10;            }&#13;&#10;&#13;&#10;            if (currentProfile.getHeight() != null &amp;&amp; !currentProfile.getHeight().isEmpty()) {&#13;&#10;                textUserHeight.setVisibility(View.VISIBLE);&#13;&#10;                textUserHeight.setText(&quot;Altura: &quot; + currentProfile.getHeight() + &quot; cm&quot;);&#13;&#10;            }&#13;&#10;&#13;&#10;            if (currentProfile.getWeight() != null &amp;&amp; !currentProfile.getWeight().isEmpty()) {&#13;&#10;                textUserWeight.setVisibility(View.VISIBLE);&#13;&#10;                textUserWeight.setText(&quot;Peso: &quot; + currentProfile.getWeight() + &quot; kg&quot;);&#13;&#10;            }&#13;&#10;        } else if (&quot;agent&quot;.equalsIgnoreCase(profileType)) {&#13;&#10;            if (currentProfile.getAgency() != null &amp;&amp; !currentProfile.getAgency().isEmpty()) {&#13;&#10;                textUserAgency.setVisibility(View.VISIBLE);&#13;&#10;                textUserAgency.setText(&quot;Agencia: &quot; + currentProfile.getAgency());&#13;&#10;            }&#13;&#10;        } else if (&quot;team&quot;.equalsIgnoreCase(profileType)) {&#13;&#10;            if (currentProfile.getJob() != null &amp;&amp; !currentProfile.getJob().isEmpty()) {&#13;&#10;                textUserJob.setVisibility(View.VISIBLE);&#13;&#10;                textUserJob.setText(&quot;Puesto: &quot; + currentProfile.getJob());&#13;&#10;            }&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private String formatDate(String isoDate) {&#13;&#10;        // Convertir de YYYY-MM-DD a DD/MM/YYYY&#13;&#10;        if (isoDate != null &amp;&amp; isoDate.length() == 10) {&#13;&#10;            String[] parts = isoDate.split(&quot;-&quot;);&#13;&#10;            if (parts.length == 3) {&#13;&#10;                return parts[2] + &quot;/&quot; + parts[1] + &quot;/&quot; + parts[0];&#13;&#10;            }&#13;&#10;        }&#13;&#10;        return isoDate;&#13;&#10;    }&#13;&#10;&#13;&#10;    private void openEditProfile() {&#13;&#10;        Intent intent = new Intent(requireActivity(), ProfileFormActivity.class);&#13;&#10;        intent.putExtra(&quot;isEditMode&quot;, true);&#13;&#10;        intent.putExtra(&quot;profileType&quot;, currentProfileType);&#13;&#10;        startActivity(intent);&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    public void onResume() {&#13;&#10;        super.onResume();&#13;&#10;        // Recargar el perfil cuando volvemos a este fragment&#13;&#10;        if (currentProfile != null) {&#13;&#10;            loadUserProfile();&#13;&#10;        }&#13;&#10;        // Notificar que el fragmento está listo&#13;&#10;        if (getActivity() instanceof HomeActivity) {&#13;&#10;            ((HomeActivity) getActivity()).setFragmentLoading(false);&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void logoutUser() {&#13;&#10;        loadingDialog.show(&quot;Cerrando sesión...&quot;);&#13;&#10;        buttonLogout.setEnabled(false);&#13;&#10;&#13;&#10;        threadManager.executeInBackground(new Runnable() {&#13;&#10;            @Override&#13;&#10;            public void run() {&#13;&#10;                // Cerrar sesión&#13;&#10;                sessionManager.logout();&#13;&#10;&#13;&#10;                // Pequeño delay para dar feedback visual&#13;&#10;                try {&#13;&#10;                    Thread.sleep(500);&#13;&#10;                } catch (InterruptedException e) {&#13;&#10;                    e.printStackTrace();&#13;&#10;                }&#13;&#10;&#13;&#10;                // Redirigir a MainActivity en el hilo principal&#13;&#10;                threadManager.executeOnMainThread(new Runnable() {&#13;&#10;                    @Override&#13;&#10;                    public void run() {&#13;&#10;                        loadingDialog.dismiss();&#13;&#10;&#13;&#10;                        Intent intent = new Intent(requireActivity(), MainActivity.class);&#13;&#10;                        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);&#13;&#10;                        startActivity(intent);&#13;&#10;                        requireActivity().finish();&#13;&#10;                    }&#13;&#10;                });&#13;&#10;            }&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void handleSubscription() {&#13;&#10;        // Primero verificar el estado de suscripción del usuario&#13;&#10;        loadingDialog.show(&quot;Verificando suscripción...&quot;);&#13;&#10;&#13;&#10;        String token = sessionManager.getToken();&#13;&#10;        if (token == null) {&#13;&#10;            loadingDialog.dismiss();&#13;&#10;            Toast.makeText(requireContext(), &quot;Error: Sesión no válida&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        subscriptionRepository.getSubscriptionStatus(token, new Callback&lt;com.example.sportconnection.model.SubscriptionStatus&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;com.example.sportconnection.model.SubscriptionStatus&gt; call, Response&lt;com.example.sportconnection.model.SubscriptionStatus&gt; response) {&#10;                loadingDialog.dismiss();&#10;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    com.example.sportconnection.model.SubscriptionStatus status = response.body();&#10;&#10;                    if (status.isActive()) {&#10;                        // Usuario ya tiene suscripción activa&#10;                        showSubscriptionDetails(status);&#10;                    } else {&#10;                        // Usuario no tiene suscripción, mostrar planes disponibles&#10;                        showSubscriptionPlans();&#10;                    }&#10;                } else if (response.code() == 404) {&#10;                    // 404 significa que no tiene suscripción, mostrar planes&#10;                    showSubscriptionPlans();&#10;                } else {&#10;                    // Otro error&#10;                    String errorMsg = &quot;Error al verificar suscripción (Código: &quot; + response.code() + &quot;)&quot;;&#10;                    Log.e(TAG, errorMsg);&#10;                    Toast.makeText(requireContext(), errorMsg, Toast.LENGTH_SHORT).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;com.example.sportconnection.model.SubscriptionStatus&gt; call, Throwable t) {&#10;                loadingDialog.dismiss();&#10;                Log.e(TAG, &quot;Error de conexión al verificar suscripción: &quot; + t.getMessage());&#10;                Toast.makeText(requireContext(), &quot;Error de conexión: &quot; + t.getMessage(), Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void updateSubscriptionButton() {&#13;&#10;        String token = sessionManager.getToken();&#13;&#10;        if (token == null) {&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        subscriptionRepository.getSubscriptionStatus(token, new Callback&lt;com.example.sportconnection.model.SubscriptionStatus&gt;() {&#13;&#10;            @Override&#13;&#10;            public void onResponse(Call&lt;com.example.sportconnection.model.SubscriptionStatus&gt; call, Response&lt;com.example.sportconnection.model.SubscriptionStatus&gt; response) {&#13;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#13;&#10;                    com.example.sportconnection.model.SubscriptionStatus status = response.body();&#13;&#10;&#13;&#10;                    if (status.isActive()) {&#13;&#10;                        // Usuario tiene suscripción activa&#13;&#10;                        btnSubscribe.setText(&quot;Premium ✓&quot;);&#13;&#10;                        btnSubscribe.setBackgroundColor(getResources().getColor(android.R.color.holo_green_dark));&#13;&#10;                    } else {&#13;&#10;                        // Usuario no tiene suscripción&#13;&#10;                        btnSubscribe.setText(&quot;Suscribirse&quot;);&#13;&#10;                    }&#13;&#10;                }&#13;&#10;            }&#13;&#10;&#13;&#10;            @Override&#13;&#10;            public void onFailure(Call&lt;com.example.sportconnection.model.SubscriptionStatus&gt; call, Throwable t) {&#13;&#10;                // Mantener texto por defecto&#13;&#10;            }&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void showSubscriptionDetails(com.example.sportconnection.model.SubscriptionStatus status) {&#13;&#10;        // Mostrar detalles de la suscripción actual&#13;&#10;        androidx.appcompat.app.AlertDialog.Builder builder = new androidx.appcompat.app.AlertDialog.Builder(requireContext());&#13;&#10;        builder.setTitle(&quot;Suscripción Activa&quot;);&#13;&#10;&#13;&#10;        com.example.sportconnection.model.SubscriptionStatus.SubscriptionDetails details = status.getSubscriptionDetails();&#13;&#10;        String message = &quot;Plan: &quot; + details.getPlanName() + &quot;\n&quot; +&#13;&#10;                        &quot;Estado: &quot; + details.getStatus() + &quot;\n&quot; +&#13;&#10;                        &quot;Válida hasta: &quot; + formatSubscriptionDate(details.getEndDate());&#13;&#10;&#13;&#10;        builder.setMessage(message);&#13;&#10;        builder.setPositiveButton(&quot;Aceptar&quot;, null);&#13;&#10;        builder.setNeutralButton(&quot;Renovar&quot;, (dialog, which) -&gt; {&#13;&#10;            // Permitir renovar/cambiar plan&#13;&#10;            showSubscriptionPlans();&#13;&#10;        });&#13;&#10;        builder.show();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void showSubscriptionPlans() {&#13;&#10;        loadingDialog.show(&quot;Cargando planes...&quot;);&#13;&#10;&#13;&#10;        String token = sessionManager.getToken();&#13;&#10;        if (token == null) {&#13;&#10;            loadingDialog.dismiss();&#13;&#10;            Toast.makeText(requireContext(), &quot;Error: Sesión no válida&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        subscriptionRepository.getSubscriptionPlans(token, new Callback&lt;List&lt;com.example.sportconnection.model.SubscriptionPlan&gt;&gt;() {&#13;&#10;            @Override&#13;&#10;            public void onResponse(Call&lt;List&lt;com.example.sportconnection.model.SubscriptionPlan&gt;&gt; call, Response&lt;List&lt;com.example.sportconnection.model.SubscriptionPlan&gt;&gt; response) {&#13;&#10;                loadingDialog.dismiss();&#13;&#10;&#13;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null &amp;&amp; !response.body().isEmpty()) {&#13;&#10;                    List&lt;com.example.sportconnection.model.SubscriptionPlan&gt; plans = response.body();&#13;&#10;                    displaySubscriptionPlansDialog(plans);&#13;&#10;                } else {&#13;&#10;                    Toast.makeText(requireContext(), &quot;No hay planes disponibles&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                }&#13;&#10;            }&#13;&#10;&#13;&#10;            @Override&#13;&#10;            public void onFailure(Call&lt;List&lt;com.example.sportconnection.model.SubscriptionPlan&gt;&gt; call, Throwable t) {&#13;&#10;                loadingDialog.dismiss();&#13;&#10;                Toast.makeText(requireContext(), &quot;Error al cargar planes&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            }&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void displaySubscriptionPlansDialog(List&lt;com.example.sportconnection.model.SubscriptionPlan&gt; plans) {&#13;&#10;        androidx.appcompat.app.AlertDialog.Builder builder = new androidx.appcompat.app.AlertDialog.Builder(requireContext());&#13;&#10;        builder.setTitle(&quot;Selecciona un Plan Premium&quot;);&#13;&#10;&#13;&#10;        String[] planNames = new String[plans.size()];&#13;&#10;        for (int i = 0; i &lt; plans.size(); i++) {&#13;&#10;            planNames[i] = plans.get(i).toString();&#13;&#10;        }&#13;&#10;&#13;&#10;        builder.setItems(planNames, (dialog, which) -&gt; {&#13;&#10;            com.example.sportconnection.model.SubscriptionPlan selectedPlan = plans.get(which);&#13;&#10;            createCheckoutSession(selectedPlan.getId());&#13;&#10;        });&#13;&#10;&#13;&#10;        builder.setNegativeButton(&quot;Cancelar&quot;, null);&#13;&#10;        builder.show();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void createCheckoutSession(int planId) {&#13;&#10;        loadingDialog.show(&quot;Preparando pago...&quot;);&#13;&#10;&#13;&#10;        String token = sessionManager.getToken();&#13;&#10;        if (token == null) {&#13;&#10;            loadingDialog.dismiss();&#13;&#10;            Toast.makeText(requireContext(), &quot;Error: Sesión no válida&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        subscriptionRepository.createCheckoutSession(token, planId, new Callback&lt;com.example.sportconnection.model.CheckoutSessionResponse&gt;() {&#13;&#10;            @Override&#13;&#10;            public void onResponse(Call&lt;com.example.sportconnection.model.CheckoutSessionResponse&gt; call, Response&lt;com.example.sportconnection.model.CheckoutSessionResponse&gt; response) {&#13;&#10;                loadingDialog.dismiss();&#13;&#10;&#13;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#13;&#10;                    com.example.sportconnection.model.CheckoutSessionResponse checkoutResponse = response.body();&#13;&#10;                    String checkoutUrl = checkoutResponse.getCheckoutUrl();&#13;&#10;&#13;&#10;                    // Abrir el navegador con la URL de checkout de Stripe&#13;&#10;                    openStripeCheckout(checkoutUrl);&#13;&#10;                } else {&#13;&#10;                    String errorMessage = &quot;Error al crear sesión de pago&quot;;&#13;&#10;                    if (response.code() == 400) {&#13;&#10;                        errorMessage = &quot;Ya tienes una suscripción activa&quot;;&#13;&#10;                    }&#13;&#10;                    Toast.makeText(requireContext(), errorMessage, Toast.LENGTH_SHORT).show();&#13;&#10;                }&#13;&#10;            }&#13;&#10;&#13;&#10;            @Override&#13;&#10;            public void onFailure(Call&lt;com.example.sportconnection.model.CheckoutSessionResponse&gt; call, Throwable t) {&#13;&#10;                loadingDialog.dismiss();&#13;&#10;                Toast.makeText(requireContext(), &quot;Error de conexión&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            }&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void openStripeCheckout(String checkoutUrl) {&#13;&#10;        try {&#13;&#10;            Intent browserIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(checkoutUrl));&#13;&#10;            startActivity(browserIntent);&#13;&#10;&#13;&#10;            Toast.makeText(requireContext(),&#13;&#10;                &quot;Completa el pago en el navegador. La suscripción se activará automáticamente.&quot;,&#13;&#10;                Toast.LENGTH_LONG).show();&#13;&#10;        } catch (Exception e) {&#13;&#10;            Log.e(TAG, &quot;Error al abrir navegador: &quot; + e.getMessage());&#13;&#10;            Toast.makeText(requireContext(), &quot;Error al abrir el navegador&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private String formatSubscriptionDate(String isoDate) {&#13;&#10;        // Convertir fecha ISO a formato legible&#13;&#10;        if (isoDate != null &amp;&amp; isoDate.length() &gt;= 10) {&#13;&#10;            String datePart = isoDate.substring(0, 10);&#13;&#10;            String[] parts = datePart.split(&quot;-&quot;);&#13;&#10;            if (parts.length == 3) {&#13;&#10;                return parts[2] + &quot;/&quot; + parts[1] + &quot;/&quot; + parts[0];&#13;&#10;            }&#13;&#10;        }&#13;&#10;        return isoDate;&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    public void onDestroyView() {&#13;&#10;        super.onDestroyView();&#13;&#10;&#13;&#10;        // Cancelar llamadas API pendientes&#13;&#10;        if (currentProfileCall != null &amp;&amp; !currentProfileCall.isCanceled()) {&#13;&#10;            currentProfileCall.cancel();&#13;&#10;        }&#13;&#10;        if (currentUploadCall != null &amp;&amp; !currentUploadCall.isCanceled()) {&#13;&#10;            currentUploadCall.cancel();&#13;&#10;        }&#13;&#10;        if (currentDeleteCall != null &amp;&amp; !currentDeleteCall.isCanceled()) {&#13;&#10;            currentDeleteCall.cancel();&#13;&#10;        }&#13;&#10;        if (currentSportsCall != null &amp;&amp; !currentSportsCall.isCanceled()) {&#13;&#10;            currentSportsCall.cancel();&#13;&#10;        }&#13;&#10;        if (currentLocationsCall != null &amp;&amp; !currentLocationsCall.isCanceled()) {&#13;&#10;            currentLocationsCall.cancel();&#13;&#10;        }&#13;&#10;&#13;&#10;        // Cerrar el diálogo si está abierto&#13;&#10;        if (loadingDialog != null &amp;&amp; loadingDialog.isShowing()) {&#13;&#10;            loadingDialog.dismiss();&#13;&#10;        }&#13;&#10;    }&#13;&#10;}&#13;&#10;&#13;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/model/CreatePostResponse.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/model/CreatePostResponse.java" />
              <option name="originalContent" value="package com.example.sportconnection.model;&#10;&#10;import com.google.gson.annotations.SerializedName;&#10;&#10;public class CreatePostResponse {&#10;    @SerializedName(&quot;message&quot;)&#10;    private String message;&#10;&#10;    @SerializedName(&quot;post&quot;)&#10;    private Post post;&#10;&#10;    public String getMessage() {&#10;        return message;&#10;    }&#10;&#10;    public void setMessage(String message) {&#10;        this.message = message;&#10;    }&#10;&#10;    public Post getPost() {&#10;        return post;&#10;    }&#10;&#10;    public void setPost(Post post) {&#10;        this.post = post;&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.sportconnection.model;&#10;&#10;import com.google.gson.annotations.SerializedName;&#10;&#10;public class CreatePostResponse {&#10;    @SerializedName(&quot;message&quot;)&#10;    private String message;&#10;&#10;    @SerializedName(&quot;post&quot;)&#10;    private Post post;&#10;&#10;    public String getMessage() {&#10;        return message;&#10;    }&#10;&#10;    public void setMessage(String message) {&#10;        this.message = message;&#10;    }&#10;&#10;    public Post getPost() {&#10;        return post;&#10;    }&#10;&#10;    public void setPost(Post post) {&#10;        this.post = post;&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/model/GetProfileResponse.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/model/GetProfileResponse.java" />
              <option name="originalContent" value="package com.example.sportconnection.model;&#10;&#10;import com.google.gson.annotations.SerializedName;&#10;&#10;public class GetProfileResponse {&#10;    @SerializedName(&quot;user_id&quot;)&#10;    private int userId;&#10;&#10;    @SerializedName(value = &quot;profileType&quot;, alternate = {&quot;profile_type&quot;})&#10;    private String profileType;&#10;&#10;    private ProfileData profile;&#10;&#10;    private Relationship relationship;&#10;&#10;    @SerializedName(&quot;limited_view&quot;)&#10;    private boolean limitedView;&#10;&#10;    public int getUserId() {&#10;        return userId;&#10;    }&#10;&#10;    public String getProfileType() {&#10;        return profileType;&#10;    }&#10;&#10;    public ProfileData getProfile() {&#10;        return profile;&#10;    }&#10;&#10;    public Relationship getRelationship() {&#10;        return relationship;&#10;    }&#10;&#10;    public boolean isLimitedView() {&#10;        return limitedView;&#10;    }&#10;&#10;    public static class Relationship {&#10;        @SerializedName(&quot;has_interaction&quot;)&#10;        private boolean hasInteraction;&#10;&#10;        @SerializedName(&quot;has_match&quot;)&#10;        private boolean hasMatch;&#10;&#10;        @SerializedName(&quot;can_view_full_profile&quot;)&#10;        private boolean canViewFullProfile;&#10;&#10;        public boolean isHasInteraction() {&#10;            return hasInteraction;&#10;        }&#10;&#10;        public boolean isHasMatch() {&#10;            return hasMatch;&#10;        }&#10;&#10;        public boolean isCanViewFullProfile() {&#10;            return canViewFullProfile;&#10;        }&#10;    }&#10;&#10;    public static class ProfileData {&#10;        private int id;&#10;&#10;        @SerializedName(&quot;user_id&quot;)&#10;        private int userId;&#10;&#10;        @SerializedName(&quot;profile_type&quot;)&#10;        private String profileType;&#10;&#10;        private String name;&#10;&#10;        @SerializedName(&quot;last_name&quot;)&#10;        private String lastName;&#10;&#10;        private String description;&#10;&#10;        @SerializedName(&quot;location_id&quot;)&#10;        private Integer locationId;&#10;&#10;        @SerializedName(&quot;sport_id&quot;)&#10;        private Integer sportId;&#10;&#10;        @SerializedName(&quot;phone_number&quot;)&#10;        private String phoneNumber;&#10;&#10;        @SerializedName(&quot;ig_user&quot;)&#10;        private String igUser;&#10;&#10;        @SerializedName(&quot;x_user&quot;)&#10;        private String xUser;&#10;&#10;        private String birthdate;&#10;        private String height;&#10;        private String weight;&#10;        private String agency;&#10;        private String job;&#10;&#10;        @SerializedName(&quot;photo_url&quot;)&#10;        private String photoUrl;&#10;&#10;        @SerializedName(&quot;created_at&quot;)&#10;        private String createdAt;&#10;&#10;        // Objetos relacionados&#10;        private Sport sport;&#10;        private Location location;&#10;&#10;        // Getters&#10;        public int getId() {&#10;            return id;&#10;        }&#10;&#10;        public int getUserId() {&#10;            return userId;&#10;        }&#10;&#10;        public String getProfileType() {&#10;            return profileType;&#10;        }&#10;&#10;        public String getName() {&#10;            return name;&#10;        }&#10;&#10;        public String getLastName() {&#10;            return lastName;&#10;        }&#10;&#10;        public String getDescription() {&#10;            return description;&#10;        }&#10;&#10;        public Integer getLocationId() {&#10;            return locationId;&#10;        }&#10;&#10;        public Integer getSportId() {&#10;            return sportId;&#10;        }&#10;&#10;        public String getPhoneNumber() {&#10;            return phoneNumber;&#10;        }&#10;&#10;        public String getIgUser() {&#10;            return igUser;&#10;        }&#10;&#10;        public String getxUser() {&#10;            return xUser;&#10;        }&#10;&#10;        public String getBirthdate() {&#10;            return birthdate;&#10;        }&#10;&#10;        public String getHeight() {&#10;            return height;&#10;        }&#10;&#10;        public String getWeight() {&#10;            return weight;&#10;        }&#10;&#10;        public String getAgency() {&#10;            return agency;&#10;        }&#10;&#10;        public String getJob() {&#10;            return job;&#10;        }&#10;&#10;        public String getPhotoUrl() {&#10;            return photoUrl;&#10;        }&#10;&#10;        public String getCreatedAt() {&#10;            return createdAt;&#10;        }&#10;&#10;        public Sport getSport() {&#10;            return sport;&#10;        }&#10;&#10;        public Location getLocation() {&#10;            return location;&#10;        }&#10;    }&#10;&#10;    // Métodos auxiliares para acceder a datos del perfil más fácilmente&#10;    public String getName() {&#10;        return profile != null ? profile.getName() : null;&#10;    }&#10;&#10;    public String getJob() {&#10;        return profile != null ? profile.getJob() : null;&#10;    }&#10;&#10;    public String getDescription() {&#10;        return profile != null ? profile.getDescription() : null;&#10;    }&#10;&#10;    public String getPhotoUrl() {&#10;        return profile != null ? profile.getPhotoUrl() : null;&#10;    }&#10;&#10;    public String getPhoneNumber() {&#10;        return profile != null ? profile.getPhoneNumber() : null;&#10;    }&#10;&#10;    public String getIgUser() {&#10;        return profile != null ? profile.getIgUser() : null;&#10;    }&#10;&#10;    public String getXUser() {&#10;        return profile != null ? profile.getxUser() : null;&#10;    }&#10;&#10;    public Location getLocation() {&#10;        return profile != null ? profile.getLocation() : null;&#10;    }&#10;&#10;    public Sport getSport() {&#10;        return profile != null ? profile.getSport() : null;&#10;    }&#10;&#10;    public boolean isHasMatch() {&#10;        return relationship != null &amp;&amp; relationship.isHasMatch();&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.sportconnection.model;&#13;&#10;&#13;&#10;import com.google.gson.annotations.SerializedName;&#13;&#10;&#13;&#10;public class GetProfileResponse {&#10;    @SerializedName(&quot;user_id&quot;)&#10;    private int userId;&#10;&#10;    @SerializedName(value = &quot;profileType&quot;, alternate = {&quot;profile_type&quot;})&#10;    private String profileType;&#10;&#10;    private ProfileData profile;&#13;&#10;&#13;&#10;    private Relationship relationship;&#13;&#10;&#13;&#10;    @SerializedName(&quot;limited_view&quot;)&#13;&#10;    private boolean limitedView;&#13;&#10;&#13;&#10;    public int getUserId() {&#13;&#10;        return userId;&#13;&#10;    }&#13;&#10;&#13;&#10;    public String getProfileType() {&#13;&#10;        return profileType;&#13;&#10;    }&#13;&#10;&#13;&#10;    public ProfileData getProfile() {&#13;&#10;        return profile;&#13;&#10;    }&#13;&#10;&#13;&#10;    public Relationship getRelationship() {&#13;&#10;        return relationship;&#13;&#10;    }&#13;&#10;&#13;&#10;    public boolean isLimitedView() {&#13;&#10;        return limitedView;&#13;&#10;    }&#13;&#10;&#13;&#10;    public static class Relationship {&#13;&#10;        @SerializedName(&quot;has_interaction&quot;)&#13;&#10;        private boolean hasInteraction;&#13;&#10;&#13;&#10;        @SerializedName(&quot;has_match&quot;)&#13;&#10;        private boolean hasMatch;&#13;&#10;&#13;&#10;        @SerializedName(&quot;can_view_full_profile&quot;)&#13;&#10;        private boolean canViewFullProfile;&#13;&#10;&#13;&#10;        public boolean isHasInteraction() {&#13;&#10;            return hasInteraction;&#13;&#10;        }&#13;&#10;&#13;&#10;        public boolean isHasMatch() {&#13;&#10;            return hasMatch;&#13;&#10;        }&#13;&#10;&#13;&#10;        public boolean isCanViewFullProfile() {&#13;&#10;            return canViewFullProfile;&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    public static class ProfileData {&#13;&#10;        private int id;&#13;&#10;&#13;&#10;        @SerializedName(&quot;user_id&quot;)&#13;&#10;        private int userId;&#13;&#10;&#13;&#10;        @SerializedName(&quot;profile_type&quot;)&#13;&#10;        private String profileType;&#13;&#10;&#13;&#10;        private String name;&#13;&#10;&#13;&#10;        @SerializedName(&quot;last_name&quot;)&#13;&#10;        private String lastName;&#13;&#10;&#13;&#10;        private String description;&#13;&#10;&#13;&#10;        @SerializedName(&quot;location_id&quot;)&#13;&#10;        private Integer locationId;&#13;&#10;&#13;&#10;        @SerializedName(&quot;sport_id&quot;)&#13;&#10;        private Integer sportId;&#13;&#10;&#13;&#10;        @SerializedName(&quot;phone_number&quot;)&#13;&#10;        private String phoneNumber;&#13;&#10;&#13;&#10;        @SerializedName(&quot;ig_user&quot;)&#13;&#10;        private String igUser;&#13;&#10;&#13;&#10;        @SerializedName(&quot;x_user&quot;)&#13;&#10;        private String xUser;&#13;&#10;&#13;&#10;        private String birthdate;&#13;&#10;        private String height;&#13;&#10;        private String weight;&#13;&#10;        private String agency;&#13;&#10;        private String job;&#13;&#10;&#13;&#10;        @SerializedName(&quot;photo_url&quot;)&#13;&#10;        private String photoUrl;&#13;&#10;&#13;&#10;        @SerializedName(&quot;created_at&quot;)&#13;&#10;        private String createdAt;&#13;&#10;&#13;&#10;        // Objetos relacionados&#13;&#10;        private Sport sport;&#13;&#10;        private Location location;&#13;&#10;&#13;&#10;        // Getters&#13;&#10;        public int getId() {&#13;&#10;            return id;&#13;&#10;        }&#13;&#10;&#13;&#10;        public int getUserId() {&#13;&#10;            return userId;&#13;&#10;        }&#13;&#10;&#13;&#10;        public String getProfileType() {&#13;&#10;            return profileType;&#13;&#10;        }&#13;&#10;&#13;&#10;        public String getName() {&#13;&#10;            return name;&#13;&#10;        }&#13;&#10;&#13;&#10;        public String getLastName() {&#13;&#10;            return lastName;&#13;&#10;        }&#13;&#10;&#13;&#10;        public String getDescription() {&#13;&#10;            return description;&#13;&#10;        }&#13;&#10;&#13;&#10;        public Integer getLocationId() {&#13;&#10;            return locationId;&#13;&#10;        }&#13;&#10;&#13;&#10;        public Integer getSportId() {&#13;&#10;            return sportId;&#13;&#10;        }&#13;&#10;&#13;&#10;        public String getPhoneNumber() {&#13;&#10;            return phoneNumber;&#13;&#10;        }&#13;&#10;&#13;&#10;        public String getIgUser() {&#13;&#10;            return igUser;&#13;&#10;        }&#13;&#10;&#13;&#10;        public String getxUser() {&#13;&#10;            return xUser;&#13;&#10;        }&#13;&#10;&#13;&#10;        public String getBirthdate() {&#13;&#10;            return birthdate;&#13;&#10;        }&#13;&#10;&#13;&#10;        public String getHeight() {&#13;&#10;            return height;&#13;&#10;        }&#13;&#10;&#13;&#10;        public String getWeight() {&#13;&#10;            return weight;&#13;&#10;        }&#13;&#10;&#13;&#10;        public String getAgency() {&#13;&#10;            return agency;&#13;&#10;        }&#13;&#10;&#13;&#10;        public String getJob() {&#13;&#10;            return job;&#13;&#10;        }&#13;&#10;&#13;&#10;        public String getPhotoUrl() {&#13;&#10;            return photoUrl;&#13;&#10;        }&#13;&#10;&#13;&#10;        public String getCreatedAt() {&#13;&#10;            return createdAt;&#13;&#10;        }&#13;&#10;&#13;&#10;        public Sport getSport() {&#13;&#10;            return sport;&#13;&#10;        }&#13;&#10;&#13;&#10;        public Location getLocation() {&#13;&#10;            return location;&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    // Métodos auxiliares para acceder a datos del perfil más fácilmente&#13;&#10;    public String getName() {&#13;&#10;        return profile != null ? profile.getName() : null;&#13;&#10;    }&#13;&#10;&#13;&#10;    public String getJob() {&#13;&#10;        return profile != null ? profile.getJob() : null;&#13;&#10;    }&#13;&#10;&#13;&#10;    public String getDescription() {&#13;&#10;        return profile != null ? profile.getDescription() : null;&#13;&#10;    }&#13;&#10;&#13;&#10;    public String getPhotoUrl() {&#13;&#10;        return profile != null ? profile.getPhotoUrl() : null;&#13;&#10;    }&#13;&#10;&#13;&#10;    public String getPhoneNumber() {&#13;&#10;        return profile != null ? profile.getPhoneNumber() : null;&#13;&#10;    }&#13;&#10;&#13;&#10;    public String getIgUser() {&#13;&#10;        return profile != null ? profile.getIgUser() : null;&#13;&#10;    }&#13;&#10;&#13;&#10;    public String getXUser() {&#13;&#10;        return profile != null ? profile.getxUser() : null;&#13;&#10;    }&#13;&#10;&#13;&#10;    public Location getLocation() {&#13;&#10;        return profile != null ? profile.getLocation() : null;&#13;&#10;    }&#13;&#10;&#13;&#10;    public Sport getSport() {&#13;&#10;        return profile != null ? profile.getSport() : null;&#13;&#10;    }&#13;&#10;&#13;&#10;    public boolean isHasMatch() {&#13;&#10;        return relationship != null &amp;&amp; relationship.isHasMatch();&#13;&#10;    }&#13;&#10;}&#13;&#10;&#13;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/model/Post.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/model/Post.java" />
              <option name="originalContent" value="package com.example.sportconnection.model;&#10;&#10;import com.google.gson.annotations.SerializedName;&#10;&#10;public class Post {&#10;    @SerializedName(&quot;id&quot;)&#10;    private int id;&#10;&#10;    @SerializedName(&quot;user_id&quot;)&#10;    private int userId;&#10;&#10;    @SerializedName(&quot;text&quot;)&#10;    private String text;&#10;&#10;    @SerializedName(&quot;url&quot;)&#10;    private String url;&#10;&#10;    @SerializedName(&quot;created_at&quot;)&#10;    private String createdAt;&#10;&#10;    @SerializedName(&quot;user&quot;)&#10;    private PostUser user;&#10;&#10;    // Constructor vacío&#10;    public Post() {&#10;    }&#10;&#10;    // Getters y Setters&#10;    public int getId() {&#10;        return id;&#10;    }&#10;&#10;    public void setId(int id) {&#10;        this.id = id;&#10;    }&#10;&#10;    public int getUserId() {&#10;        return userId;&#10;    }&#10;&#10;    public void setUserId(int userId) {&#10;        this.userId = userId;&#10;    }&#10;&#10;    public String getText() {&#10;        return text;&#10;    }&#10;&#10;    public void setText(String text) {&#10;        this.text = text;&#10;    }&#10;&#10;    public String getUrl() {&#10;        return url;&#10;    }&#10;&#10;    public void setUrl(String url) {&#10;        this.url = url;&#10;    }&#10;&#10;    public String getCreatedAt() {&#10;        return createdAt;&#10;    }&#10;&#10;    public void setCreatedAt(String createdAt) {&#10;        this.createdAt = createdAt;&#10;    }&#10;&#10;    public PostUser getUser() {&#10;        return user;&#10;    }&#10;&#10;    public void setUser(PostUser user) {&#10;        this.user = user;&#10;    }&#10;&#10;    // Clase interna para el usuario del post&#10;    public static class PostUser {&#10;        @SerializedName(&quot;id&quot;)&#10;        private int id;&#10;&#10;        @SerializedName(&quot;email&quot;)&#10;        private String email;&#10;&#10;        @SerializedName(&quot;role&quot;)&#10;        private String role;&#10;&#10;        @SerializedName(&quot;name&quot;)&#10;        private String name;&#10;&#10;        @SerializedName(&quot;last_name&quot;)&#10;        private String lastName;&#10;&#10;        @SerializedName(&quot;photo_url&quot;)&#10;        private String photoUrl;&#10;&#10;        public int getId() {&#10;            return id;&#10;        }&#10;&#10;        public void setId(int id) {&#10;            this.id = id;&#10;        }&#10;&#10;        public String getEmail() {&#10;            return email;&#10;        }&#10;&#10;        public void setEmail(String email) {&#10;            this.email = email;&#10;        }&#10;&#10;        public String getRole() {&#10;            return role;&#10;        }&#10;&#10;        public void setRole(String role) {&#10;            this.role = role;&#10;        }&#10;&#10;        public String getName() {&#10;            return name;&#10;        }&#10;&#10;        public void setName(String name) {&#10;            this.name = name;&#10;        }&#10;&#10;        public String getLastName() {&#10;            return lastName;&#10;        }&#10;&#10;        public void setLastName(String lastName) {&#10;            this.lastName = lastName;&#10;        }&#10;&#10;        public String getPhotoUrl() {&#10;            return photoUrl;&#10;        }&#10;&#10;        public void setPhotoUrl(String photoUrl) {&#10;            this.photoUrl = photoUrl;&#10;        }&#10;&#10;        // Método auxiliar para obtener el nombre completo&#10;        public String getFullName() {&#10;            if (name != null &amp;&amp; !name.trim().isEmpty() &amp;&amp; lastName != null &amp;&amp; !lastName.trim().isEmpty()) {&#10;                return name + &quot; &quot; + lastName;&#10;            } else if (name != null &amp;&amp; !name.trim().isEmpty()) {&#10;                return name;&#10;            } else if (lastName != null &amp;&amp; !lastName.trim().isEmpty()) {&#10;                return lastName;&#10;            } else if (email != null &amp;&amp; !email.trim().isEmpty()) {&#10;                // Extraer un nombre del email (parte antes del @)&#10;                String username = email.split(&quot;@&quot;)[0];&#10;                // Capitalizar primera letra y reemplazar puntos/guiones con espacios&#10;                username = username.replace(&quot;.&quot;, &quot; &quot;).replace(&quot;_&quot;, &quot; &quot;).replace(&quot;-&quot;, &quot; &quot;);&#10;                // Capitalizar cada palabra&#10;                String[] words = username.split(&quot; &quot;);&#10;                StringBuilder result = new StringBuilder();&#10;                for (String word : words) {&#10;                    if (word.length() &gt; 0) {&#10;                        result.append(Character.toUpperCase(word.charAt(0)));&#10;                        if (word.length() &gt; 1) {&#10;                            result.append(word.substring(1).toLowerCase());&#10;                        }&#10;                        result.append(&quot; &quot;);&#10;                    }&#10;                }&#10;                return result.toString().trim();&#10;            } else {&#10;                return &quot;Usuario desconocido&quot;;&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.sportconnection.model;&#10;&#10;import com.google.gson.annotations.SerializedName;&#10;&#10;public class Post {&#10;    @SerializedName(&quot;id&quot;)&#10;    private int id;&#10;&#10;    @SerializedName(&quot;user_id&quot;)&#10;    private int userId;&#10;&#10;    @SerializedName(&quot;text&quot;)&#10;    private String text;&#10;&#10;    @SerializedName(&quot;url&quot;)&#10;    private String url;&#10;&#10;    @SerializedName(&quot;created_at&quot;)&#10;    private String createdAt;&#10;&#10;    @SerializedName(&quot;user&quot;)&#10;    private PostUser user;&#10;&#10;    // Constructor vacío&#10;    public Post() {&#10;    }&#10;&#10;    // Getters y Setters&#10;    public int getId() {&#10;        return id;&#10;    }&#10;&#10;    public void setId(int id) {&#10;        this.id = id;&#10;    }&#10;&#10;    public int getUserId() {&#10;        return userId;&#10;    }&#10;&#10;    public void setUserId(int userId) {&#10;        this.userId = userId;&#10;    }&#10;&#10;    public String getText() {&#10;        return text;&#10;    }&#10;&#10;    public void setText(String text) {&#10;        this.text = text;&#10;    }&#10;&#10;    public String getUrl() {&#10;        return url;&#10;    }&#10;&#10;    public void setUrl(String url) {&#10;        this.url = url;&#10;    }&#10;&#10;    public String getCreatedAt() {&#10;        return createdAt;&#10;    }&#10;&#10;    public void setCreatedAt(String createdAt) {&#10;        this.createdAt = createdAt;&#10;    }&#10;&#10;    public PostUser getUser() {&#10;        return user;&#10;    }&#10;&#10;    public void setUser(PostUser user) {&#10;        this.user = user;&#10;    }&#10;&#10;    // Clase interna para el usuario del post&#10;    public static class PostUser {&#10;        @SerializedName(&quot;id&quot;)&#10;        private int id;&#10;&#10;        @SerializedName(&quot;email&quot;)&#10;        private String email;&#10;&#10;        @SerializedName(&quot;role&quot;)&#10;        private String role;&#10;&#10;        @SerializedName(&quot;name&quot;)&#10;        private String name;&#10;&#10;        @SerializedName(&quot;last_name&quot;)&#10;        private String lastName;&#10;&#10;        @SerializedName(&quot;photo_url&quot;)&#10;        private String photoUrl;&#10;&#10;        public int getId() {&#10;            return id;&#10;        }&#10;&#10;        public void setId(int id) {&#10;            this.id = id;&#10;        }&#10;&#10;        public String getEmail() {&#10;            return email;&#10;        }&#10;&#10;        public void setEmail(String email) {&#10;            this.email = email;&#10;        }&#10;&#10;        public String getRole() {&#10;            return role;&#10;        }&#10;&#10;        public void setRole(String role) {&#10;            this.role = role;&#10;        }&#10;&#10;        public String getName() {&#10;            return name;&#10;        }&#10;&#10;        public void setName(String name) {&#10;            this.name = name;&#10;        }&#10;&#10;        public String getLastName() {&#10;            return lastName;&#10;        }&#10;&#10;        public void setLastName(String lastName) {&#10;            this.lastName = lastName;&#10;        }&#10;&#10;        public String getPhotoUrl() {&#10;            return photoUrl;&#10;        }&#10;&#10;        public void setPhotoUrl(String photoUrl) {&#10;            this.photoUrl = photoUrl;&#10;        }&#10;&#10;        // Método auxiliar para obtener el nombre completo&#10;        public String getFullName() {&#10;            if (name != null &amp;&amp; !name.trim().isEmpty() &amp;&amp; lastName != null &amp;&amp; !lastName.trim().isEmpty()) {&#10;                return name + &quot; &quot; + lastName;&#10;            } else if (name != null &amp;&amp; !name.trim().isEmpty()) {&#10;                return name;&#10;            } else if (lastName != null &amp;&amp; !lastName.trim().isEmpty()) {&#10;                return lastName;&#10;            } else if (email != null &amp;&amp; !email.trim().isEmpty()) {&#10;                // Extraer un nombre del email (parte antes del @)&#10;                String username = email.split(&quot;@&quot;)[0];&#10;                // Capitalizar primera letra y reemplazar puntos/guiones con espacios&#10;                username = username.replace(&quot;.&quot;, &quot; &quot;).replace(&quot;_&quot;, &quot; &quot;).replace(&quot;-&quot;, &quot; &quot;);&#10;                // Capitalizar cada palabra&#10;                String[] words = username.split(&quot; &quot;);&#10;                StringBuilder result = new StringBuilder();&#10;                for (String word : words) {&#10;                    if (word.length() &gt; 0) {&#10;                        result.append(Character.toUpperCase(word.charAt(0)));&#10;                        if (word.length() &gt; 1) {&#10;                            result.append(word.substring(1).toLowerCase());&#10;                        }&#10;                        result.append(&quot; &quot;);&#10;                    }&#10;                }&#10;                return result.toString().trim();&#10;            } else {&#10;                return &quot;Usuario desconocido&quot;;&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/model/RegisterRequest.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/model/RegisterRequest.java" />
              <option name="updatedContent" value="package com.example.sportconnection.model;&#10;&#10;public class RegisterRequest {&#10;    private String email;&#10;    private String password;&#10;&#10;    public RegisterRequest(String email, String password) {&#10;        this.email = email;&#10;        this.password = password;&#10;    }&#10;&#10;    public String getEmail() {&#10;        return email;&#10;    }&#10;&#10;    public void setEmail(String email) {&#10;        this.email = email;&#10;    }&#10;&#10;    public String getPassword() {&#10;        return password;&#10;    }&#10;&#10;    public void setPassword(String password) {&#10;        this.password = password;&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/model/RegisterResponse.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/model/RegisterResponse.java" />
              <option name="updatedContent" value="package com.example.sportconnection.model;&#10;&#10;public class RegisterResponse {&#10;    private boolean success;&#10;    private String message;&#10;    private String token;&#10;    private int userId;&#10;&#10;    public boolean isSuccess() {&#10;        return success;&#10;    }&#10;&#10;    public void setSuccess(boolean success) {&#10;        this.success = success;&#10;    }&#10;&#10;    public String getMessage() {&#10;        return message;&#10;    }&#10;&#10;    public void setMessage(String message) {&#10;        this.message = message;&#10;    }&#10;&#10;    public String getToken() {&#10;        return token;&#10;    }&#10;&#10;    public void setToken(String token) {&#10;        this.token = token;&#10;    }&#10;&#10;    public int getUserId() {&#10;        return userId;&#10;    }&#10;&#10;    public void setUserId(int userId) {&#10;        this.userId = userId;&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/network/ApiService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/network/ApiService.java" />
              <option name="originalContent" value="package com.example.sportconnection.network;&#10;&#10;import com.example.sportconnection.model.LoginRequest;&#10;import com.example.sportconnection.model.LoginResponse;&#10;import com.example.sportconnection.model.SignupRequest;&#10;import com.example.sportconnection.model.SignupResponse;&#10;import com.example.sportconnection.model.ProfileRequest;&#10;import com.example.sportconnection.model.ProfileResponse;&#10;import com.example.sportconnection.model.GetProfileResponse;&#10;import com.example.sportconnection.model.UpdateProfileRequest;&#10;import com.example.sportconnection.model.Sport;&#10;import com.example.sportconnection.model.Location;&#10;import com.example.sportconnection.model.GoogleSignInRequest;&#10;import com.example.sportconnection.model.UploadPhotoResponse;&#10;import com.example.sportconnection.model.DeletePhotoResponse;&#10;import com.example.sportconnection.model.Post;&#10;import com.example.sportconnection.model.CreatePostRequest;&#10;import com.example.sportconnection.model.CreatePostResponse;&#10;import com.example.sportconnection.model.MyPostsResponse;&#10;import com.example.sportconnection.model.DiscoverResponse;&#10;import com.example.sportconnection.model.SwipeRequest;&#10;import com.example.sportconnection.model.SwipeResponse;&#10;import com.example.sportconnection.model.MatchesResponse;&#10;import com.example.sportconnection.model.SubscriptionPlan;&#10;import com.example.sportconnection.model.CreateCheckoutRequest;&#10;import com.example.sportconnection.model.CheckoutSessionResponse;&#10;import com.example.sportconnection.model.SubscriptionStatus;&#10;&#10;import java.util.List;&#10;&#10;import okhttp3.MultipartBody;&#10;import retrofit2.Call;&#10;import retrofit2.http.Body;&#10;import retrofit2.http.DELETE;&#10;import retrofit2.http.GET;&#10;import retrofit2.http.Header;&#10;import retrofit2.http.Multipart;&#10;import retrofit2.http.POST;&#10;import retrofit2.http.PUT;&#10;import retrofit2.http.Part;&#10;&#10;public interface ApiService {&#10;&#10;    // Endpoints de autenticación&#10;    @POST(&quot;/auth/signup&quot;)&#10;    Call&lt;SignupResponse&gt; signup(@Body SignupRequest request);&#10;&#10;    @POST(&quot;/auth/login&quot;)&#10;    Call&lt;LoginResponse&gt; login(@Body LoginRequest request);&#10;&#10;    // Endpoint de Google Sign-In (único para login y signup)&#10;    @POST(&quot;/auth/google&quot;)&#10;    Call&lt;LoginResponse&gt; googleSignIn(@Body GoogleSignInRequest request);&#10;&#10;    // Endpoints de perfil&#10;    @POST(&quot;/auth/complete-profile&quot;)&#10;    Call&lt;ProfileResponse&gt; createProfile(&#10;            @Header(&quot;Authorization&quot;) String token,&#10;            @Body ProfileRequest request&#10;    );&#10;&#10;    @GET(&quot;/profile/me&quot;)&#10;    Call&lt;GetProfileResponse&gt; getProfile(&#10;            @Header(&quot;Authorization&quot;) String token&#10;    );&#10;&#10;    @GET(&quot;/profile/{userId}&quot;)&#10;    Call&lt;GetProfileResponse&gt; getUserProfile(&#10;            @Header(&quot;Authorization&quot;) String token,&#10;            @retrofit2.http.Path(&quot;userId&quot;) int userId&#10;    );&#10;&#10;    @PUT(&quot;/profile/me&quot;)&#10;    Call&lt;ProfileResponse&gt; updateProfile(&#10;            @Header(&quot;Authorization&quot;) String token,&#10;            @Body UpdateProfileRequest request&#10;    );&#10;&#10;    // Endpoints de lookup (deportes y ubicaciones)&#10;    @GET(&quot;/lookup/sports&quot;)&#10;    Call&lt;List&lt;Sport&gt;&gt; getSports();&#10;&#10;    @GET(&quot;/lookup/locations&quot;)&#10;    Call&lt;List&lt;Location&gt;&gt; getLocations();&#10;&#10;    // Endpoints de foto de perfil&#10;    @Multipart&#10;    @POST(&quot;/profile-photo/upload&quot;)&#10;    Call&lt;UploadPhotoResponse&gt; uploadProfilePhoto(&#10;            @Header(&quot;Authorization&quot;) String token,&#10;            @Part MultipartBody.Part photo&#10;    );&#10;&#10;    @DELETE(&quot;/profile-photo/delete&quot;)&#10;    Call&lt;DeletePhotoResponse&gt; deleteProfilePhoto(&#10;            @Header(&quot;Authorization&quot;) String token&#10;    );&#10;&#10;    // Endpoints de publicaciones&#10;    @POST(&quot;/posts&quot;)&#10;    Call&lt;CreatePostResponse&gt; createPost(&#10;            @Header(&quot;Authorization&quot;) String token,&#10;            @Body CreatePostRequest request&#10;    );&#10;&#10;    @GET(&quot;/posts&quot;)&#10;    Call&lt;List&lt;Post&gt;&gt; getAllPosts();&#10;&#10;    @GET(&quot;/posts/my-posts&quot;)&#10;    Call&lt;MyPostsResponse&gt; getMyPosts(&#10;            @Header(&quot;Authorization&quot;) String token&#10;    );&#10;&#10;    @DELETE(&quot;/posts/{id}&quot;)&#10;    Call&lt;Void&gt; deletePost(&#10;            @Header(&quot;Authorization&quot;) String token,&#10;            @retrofit2.http.Path(&quot;id&quot;) int postId&#10;    );&#10;&#10;    // Endpoints de swipe y matches&#10;    @GET(&quot;/swipe/discover&quot;)&#10;    Call&lt;DiscoverResponse&gt; getDiscoverUsers(&#10;            @Header(&quot;Authorization&quot;) String token,&#10;            @retrofit2.http.Query(&quot;profile_type_filter&quot;) String profileTypeFilter,&#10;            @retrofit2.http.Query(&quot;limit&quot;) Integer limit&#10;    );&#10;&#10;    @POST(&quot;/swipe&quot;)&#10;    Call&lt;SwipeResponse&gt; swipe(&#10;            @Header(&quot;Authorization&quot;) String token,&#10;            @Body SwipeRequest request&#10;    );&#10;&#10;    @GET(&quot;/swipe/matches&quot;)&#10;    Call&lt;MatchesResponse&gt; getMatches(&#10;            @Header(&quot;Authorization&quot;) String token&#10;    );&#10;&#10;    // Endpoints de suscripción&#10;    @GET(&quot;/subscriptions/plans&quot;)&#10;    Call&lt;List&lt;SubscriptionPlan&gt;&gt; getSubscriptionPlans(&#10;            @Header(&quot;Authorization&quot;) String token&#10;    );&#10;&#10;    @POST(&quot;/subscriptions/create-checkout-session&quot;)&#10;    Call&lt;CheckoutSessionResponse&gt; createCheckoutSession(&#10;            @Header(&quot;Authorization&quot;) String token,&#10;            @Body CreateCheckoutRequest request&#10;    );&#10;&#10;    @GET(&quot;/subscriptions/status&quot;)&#10;    Call&lt;SubscriptionStatus&gt; getSubscriptionStatus(&#10;            @Header(&quot;Authorization&quot;) String token&#10;    );&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.sportconnection.network;&#13;&#10;&#13;&#10;import com.example.sportconnection.model.LoginRequest;&#13;&#10;import com.example.sportconnection.model.LoginResponse;&#13;&#10;import com.example.sportconnection.model.SignupRequest;&#13;&#10;import com.example.sportconnection.model.SignupResponse;&#13;&#10;import com.example.sportconnection.model.ProfileRequest;&#13;&#10;import com.example.sportconnection.model.ProfileResponse;&#13;&#10;import com.example.sportconnection.model.GetProfileResponse;&#13;&#10;import com.example.sportconnection.model.UpdateProfileRequest;&#13;&#10;import com.example.sportconnection.model.Sport;&#13;&#10;import com.example.sportconnection.model.Location;&#13;&#10;import com.example.sportconnection.model.GoogleSignInRequest;&#13;&#10;import com.example.sportconnection.model.UploadPhotoResponse;&#13;&#10;import com.example.sportconnection.model.DeletePhotoResponse;&#13;&#10;import com.example.sportconnection.model.Post;&#13;&#10;import com.example.sportconnection.model.CreatePostRequest;&#13;&#10;import com.example.sportconnection.model.CreatePostResponse;&#13;&#10;import com.example.sportconnection.model.MyPostsResponse;&#13;&#10;import com.example.sportconnection.model.DiscoverResponse;&#13;&#10;import com.example.sportconnection.model.SwipeRequest;&#13;&#10;import com.example.sportconnection.model.SwipeResponse;&#13;&#10;import com.example.sportconnection.model.MatchesResponse;&#13;&#10;import com.example.sportconnection.model.SubscriptionPlan;&#13;&#10;import com.example.sportconnection.model.CreateCheckoutRequest;&#13;&#10;import com.example.sportconnection.model.CheckoutSessionResponse;&#13;&#10;import com.example.sportconnection.model.SubscriptionStatus;&#13;&#10;&#13;&#10;import java.util.List;&#13;&#10;&#13;&#10;import okhttp3.MultipartBody;&#13;&#10;import retrofit2.Call;&#13;&#10;import retrofit2.http.Body;&#13;&#10;import retrofit2.http.DELETE;&#13;&#10;import retrofit2.http.GET;&#13;&#10;import retrofit2.http.Header;&#13;&#10;import retrofit2.http.Multipart;&#13;&#10;import retrofit2.http.POST;&#13;&#10;import retrofit2.http.PUT;&#13;&#10;import retrofit2.http.Part;&#13;&#10;&#13;&#10;public interface ApiService {&#13;&#10;&#13;&#10;    // Endpoints de autenticación&#13;&#10;    @POST(&quot;/auth/signup&quot;)&#13;&#10;    Call&lt;SignupResponse&gt; signup(@Body SignupRequest request);&#13;&#10;&#13;&#10;    @POST(&quot;/auth/login&quot;)&#13;&#10;    Call&lt;LoginResponse&gt; login(@Body LoginRequest request);&#13;&#10;&#13;&#10;    // Endpoint de Google Sign-In (único para login y signup)&#13;&#10;    @POST(&quot;/auth/google&quot;)&#13;&#10;    Call&lt;LoginResponse&gt; googleSignIn(@Body GoogleSignInRequest request);&#13;&#10;&#13;&#10;    // Endpoints de perfil&#13;&#10;    @POST(&quot;/auth/complete-profile&quot;)&#13;&#10;    Call&lt;ProfileResponse&gt; createProfile(&#13;&#10;            @Header(&quot;Authorization&quot;) String token,&#13;&#10;            @Body ProfileRequest request&#13;&#10;    );&#13;&#10;&#13;&#10;    @GET(&quot;/profile/me&quot;)&#13;&#10;    Call&lt;GetProfileResponse&gt; getProfile(&#13;&#10;            @Header(&quot;Authorization&quot;) String token&#13;&#10;    );&#13;&#10;&#13;&#10;    @GET(&quot;/profile/{userId}&quot;)&#13;&#10;    Call&lt;GetProfileResponse&gt; getUserProfile(&#13;&#10;            @Header(&quot;Authorization&quot;) String token,&#13;&#10;            @retrofit2.http.Path(&quot;userId&quot;) int userId&#13;&#10;    );&#13;&#10;&#13;&#10;    @PUT(&quot;/profile/me&quot;)&#13;&#10;    Call&lt;ProfileResponse&gt; updateProfile(&#13;&#10;            @Header(&quot;Authorization&quot;) String token,&#13;&#10;            @Body UpdateProfileRequest request&#13;&#10;    );&#13;&#10;&#13;&#10;    // Endpoints de lookup (deportes y ubicaciones)&#13;&#10;    @GET(&quot;/lookup/sports&quot;)&#13;&#10;    Call&lt;List&lt;Sport&gt;&gt; getSports();&#13;&#10;&#13;&#10;    @GET(&quot;/lookup/locations&quot;)&#13;&#10;    Call&lt;List&lt;Location&gt;&gt; getLocations();&#13;&#10;&#13;&#10;    // Endpoints de foto de perfil&#13;&#10;    @Multipart&#13;&#10;    @POST(&quot;/profile-photo/upload&quot;)&#13;&#10;    Call&lt;UploadPhotoResponse&gt; uploadProfilePhoto(&#13;&#10;            @Header(&quot;Authorization&quot;) String token,&#13;&#10;            @Part MultipartBody.Part photo&#13;&#10;    );&#13;&#10;&#13;&#10;    @DELETE(&quot;/profile-photo/delete&quot;)&#13;&#10;    Call&lt;DeletePhotoResponse&gt; deleteProfilePhoto(&#13;&#10;            @Header(&quot;Authorization&quot;) String token&#13;&#10;    );&#13;&#10;&#13;&#10;    // Endpoints de publicaciones&#13;&#10;    @POST(&quot;/posts&quot;)&#13;&#10;    Call&lt;CreatePostResponse&gt; createPost(&#13;&#10;            @Header(&quot;Authorization&quot;) String token,&#13;&#10;            @Body CreatePostRequest request&#13;&#10;    );&#13;&#10;&#13;&#10;    @GET(&quot;/posts&quot;)&#13;&#10;    Call&lt;List&lt;Post&gt;&gt; getAllPosts();&#13;&#10;&#13;&#10;    @GET(&quot;/posts/my-posts&quot;)&#13;&#10;    Call&lt;MyPostsResponse&gt; getMyPosts(&#13;&#10;            @Header(&quot;Authorization&quot;) String token&#13;&#10;    );&#13;&#10;&#13;&#10;    @DELETE(&quot;/posts/{id}&quot;)&#13;&#10;    Call&lt;Void&gt; deletePost(&#13;&#10;            @Header(&quot;Authorization&quot;) String token,&#13;&#10;            @retrofit2.http.Path(&quot;id&quot;) int postId&#13;&#10;    );&#13;&#10;&#13;&#10;    // Endpoints de swipe y matches&#13;&#10;    @GET(&quot;/swipe/discover&quot;)&#13;&#10;    Call&lt;DiscoverResponse&gt; getDiscoverUsers(&#13;&#10;            @Header(&quot;Authorization&quot;) String token,&#13;&#10;            @retrofit2.http.Query(&quot;profile_type_filter&quot;) String profileTypeFilter,&#13;&#10;            @retrofit2.http.Query(&quot;limit&quot;) Integer limit&#13;&#10;    );&#13;&#10;&#13;&#10;    @POST(&quot;/swipe&quot;)&#13;&#10;    Call&lt;SwipeResponse&gt; swipe(&#13;&#10;            @Header(&quot;Authorization&quot;) String token,&#13;&#10;            @Body SwipeRequest request&#13;&#10;    );&#13;&#10;&#13;&#10;    @GET(&quot;/swipe/matches&quot;)&#13;&#10;    Call&lt;MatchesResponse&gt; getMatches(&#13;&#10;            @Header(&quot;Authorization&quot;) String token&#13;&#10;    );&#13;&#10;&#13;&#10;    // Endpoints de suscripción&#10;    @GET(&quot;/subscriptions/plans&quot;)&#10;    Call&lt;List&lt;SubscriptionPlan&gt;&gt; getSubscriptionPlans(&#10;            @Header(&quot;Authorization&quot;) String token&#10;    );&#10;&#10;    @POST(&quot;/subscriptions/create-checkout-session&quot;)&#10;    Call&lt;CheckoutSessionResponse&gt; createCheckoutSession(&#10;            @Header(&quot;Authorization&quot;) String token,&#10;            @Body CreateCheckoutRequest request&#10;    );&#10;&#10;    @GET(&quot;/subscriptions/status&quot;)&#10;    Call&lt;SubscriptionStatus&gt; getSubscriptionStatus(&#10;            @Header(&quot;Authorization&quot;) String token&#10;    );&#10;}&#13;&#10;&#13;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/repository/AuthRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/repository/AuthRepository.java" />
              <option name="originalContent" value="package com.example.sportconnection.repository;&#10;&#10;import com.example.sportconnection.model.LoginRequest;&#10;import com.example.sportconnection.model.LoginResponse;&#10;import com.example.sportconnection.model.SignupRequest;&#10;import com.example.sportconnection.model.ProfileRequest;&#10;import com.example.sportconnection.model.ProfileResponse;&#10;import com.example.sportconnection.model.GetProfileResponse;&#10;import com.example.sportconnection.model.UpdateProfileRequest;&#10;import com.example.sportconnection.model.SignupResponse;&#10;import com.example.sportconnection.model.GoogleSignInRequest;&#10;import com.example.sportconnection.model.UploadPhotoResponse;&#10;import com.example.sportconnection.model.DeletePhotoResponse;&#10;import com.example.sportconnection.network.ApiClient;&#10;import com.example.sportconnection.network.ApiService;&#10;&#10;import java.io.File;&#10;&#10;import okhttp3.MediaType;&#10;import okhttp3.MultipartBody;&#10;import okhttp3.RequestBody;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;&#10;public class AuthRepository {&#10;    private final ApiService apiService;&#10;&#10;    public AuthRepository() {&#10;        apiService = ApiClient.getClient().create(ApiService.class);&#10;    }&#10;&#10;    // Registro de usuario&#10;    public void signup(String email, String password, Callback&lt;SignupResponse&gt; callback) {&#10;        SignupRequest request = new SignupRequest(email, password);&#10;        Call&lt;SignupResponse&gt; call = apiService.signup(request);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Login de usuario&#10;    public void login(String email, String password, Callback&lt;LoginResponse&gt; callback) {&#10;        LoginRequest request = new LoginRequest(email, password);&#10;        Call&lt;LoginResponse&gt; call = apiService.login(request);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Google Sign-In (unificado para login y signup)&#10;    public void googleSignIn(String idToken, Callback&lt;LoginResponse&gt; callback) {&#10;        GoogleSignInRequest request = new GoogleSignInRequest(idToken);&#10;        Call&lt;LoginResponse&gt; call = apiService.googleSignIn(request);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Crear perfil&#10;    public void createProfile(String token, ProfileRequest request, Callback&lt;ProfileResponse&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;        Call&lt;ProfileResponse&gt; call = apiService.createProfile(authHeader, request);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Obtener perfil&#10;    public void getProfile(String token, Callback&lt;GetProfileResponse&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;        Call&lt;GetProfileResponse&gt; call = apiService.getProfile(authHeader);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Actualizar perfil&#10;    public void updateProfile(String token, UpdateProfileRequest request, Callback&lt;ProfileResponse&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;        Call&lt;ProfileResponse&gt; call = apiService.updateProfile(authHeader, request);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Subir foto de perfil&#10;    public void uploadProfilePhoto(String token, File photoFile, Callback&lt;UploadPhotoResponse&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;&#10;        // Crear RequestBody para el archivo&#10;        RequestBody requestFile = RequestBody.create(MediaType.parse(&quot;image/*&quot;), photoFile);&#10;&#10;        // Crear MultipartBody.Part para enviar el archivo&#10;        MultipartBody.Part photoPart = MultipartBody.Part.createFormData(&quot;photo&quot;, photoFile.getName(), requestFile);&#10;&#10;        Call&lt;UploadPhotoResponse&gt; call = apiService.uploadProfilePhoto(authHeader, photoPart);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Eliminar foto de perfil&#10;    public void deleteProfilePhoto(String token, Callback&lt;DeletePhotoResponse&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;        Call&lt;DeletePhotoResponse&gt; call = apiService.deleteProfilePhoto(authHeader);&#10;        call.enqueue(callback);&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.sportconnection.repository;&#10;&#10;import com.example.sportconnection.model.LoginRequest;&#10;import com.example.sportconnection.model.LoginResponse;&#10;import com.example.sportconnection.model.SignupRequest;&#10;import com.example.sportconnection.model.ProfileRequest;&#10;import com.example.sportconnection.model.ProfileResponse;&#10;import com.example.sportconnection.model.GetProfileResponse;&#10;import com.example.sportconnection.model.UpdateProfileRequest;&#10;import com.example.sportconnection.model.SignupResponse;&#10;import com.example.sportconnection.model.GoogleSignInRequest;&#10;import com.example.sportconnection.model.UploadPhotoResponse;&#10;import com.example.sportconnection.model.DeletePhotoResponse;&#10;import com.example.sportconnection.network.ApiClient;&#10;import com.example.sportconnection.network.ApiService;&#10;&#10;import java.io.File;&#10;&#10;import okhttp3.MediaType;&#10;import okhttp3.MultipartBody;&#10;import okhttp3.RequestBody;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;&#10;public class AuthRepository {&#10;    private final ApiService apiService;&#10;&#10;    public AuthRepository() {&#10;        apiService = ApiClient.getClient().create(ApiService.class);&#10;    }&#10;&#10;    // Registro de usuario&#10;    public void signup(String email, String password, Callback&lt;SignupResponse&gt; callback) {&#10;        SignupRequest request = new SignupRequest(email, password);&#10;        Call&lt;SignupResponse&gt; call = apiService.signup(request);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Login de usuario&#10;    public void login(String email, String password, Callback&lt;LoginResponse&gt; callback) {&#10;        LoginRequest request = new LoginRequest(email, password);&#10;        Call&lt;LoginResponse&gt; call = apiService.login(request);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Google Sign-In (unificado para login y signup)&#10;    public void googleSignIn(String idToken, Callback&lt;LoginResponse&gt; callback) {&#10;        GoogleSignInRequest request = new GoogleSignInRequest(idToken);&#10;        Call&lt;LoginResponse&gt; call = apiService.googleSignIn(request);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Crear perfil&#10;    public void createProfile(String token, ProfileRequest request, Callback&lt;ProfileResponse&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;        Call&lt;ProfileResponse&gt; call = apiService.createProfile(authHeader, request);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Obtener perfil&#10;    public void getProfile(String token, Callback&lt;GetProfileResponse&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;        Call&lt;GetProfileResponse&gt; call = apiService.getProfile(authHeader);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Actualizar perfil&#10;    public void updateProfile(String token, UpdateProfileRequest request, Callback&lt;ProfileResponse&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;        Call&lt;ProfileResponse&gt; call = apiService.updateProfile(authHeader, request);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Subir foto de perfil&#10;    public void uploadProfilePhoto(String token, File photoFile, Callback&lt;UploadPhotoResponse&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;&#10;        // Crear RequestBody para el archivo&#10;        RequestBody requestFile = RequestBody.create(MediaType.parse(&quot;image/*&quot;), photoFile);&#10;&#10;        // Crear MultipartBody.Part para enviar el archivo&#10;        MultipartBody.Part photoPart = MultipartBody.Part.createFormData(&quot;photo&quot;, photoFile.getName(), requestFile);&#10;&#10;        Call&lt;UploadPhotoResponse&gt; call = apiService.uploadProfilePhoto(authHeader, photoPart);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Eliminar foto de perfil&#10;    public void deleteProfilePhoto(String token, Callback&lt;DeletePhotoResponse&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;        Call&lt;DeletePhotoResponse&gt; call = apiService.deleteProfilePhoto(authHeader);&#10;        call.enqueue(callback);&#10;    }&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/repository/PostRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/repository/PostRepository.java" />
              <option name="originalContent" value="package com.example.sportconnection.repository;&#10;&#10;import android.util.Log;&#10;&#10;import com.example.sportconnection.model.CreatePostRequest;&#10;import com.example.sportconnection.model.CreatePostResponse;&#10;import com.example.sportconnection.model.MyPostsResponse;&#10;import com.example.sportconnection.model.Post;&#10;import com.example.sportconnection.network.ApiClient;&#10;import com.example.sportconnection.network.ApiService;&#10;&#10;import java.util.List;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class PostRepository {&#10;    private static final String TAG = &quot;PostRepository&quot;;&#10;    private final ApiService apiService;&#10;&#10;    public PostRepository() {&#10;        this.apiService = ApiClient.getApiService();&#10;    }&#10;&#10;    public interface PostsCallback {&#10;        void onSuccess(List&lt;Post&gt; posts);&#10;        void onError(String message);&#10;    }&#10;&#10;    public interface CreatePostCallback {&#10;        void onSuccess(Post post);&#10;        void onError(String message);&#10;    }&#10;&#10;    public interface DeletePostCallback {&#10;        void onSuccess();&#10;        void onError(String message);&#10;    }&#10;&#10;    // Obtener todas las publicaciones&#10;    public void getAllPosts(PostsCallback callback) {&#10;        apiService.getAllPosts().enqueue(new Callback&lt;List&lt;Post&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;List&lt;Post&gt;&gt; call, Response&lt;List&lt;Post&gt;&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    callback.onSuccess(response.body());&#10;                } else {&#10;                    callback.onError(&quot;Error al obtener las publicaciones&quot;);&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;List&lt;Post&gt;&gt; call, Throwable t) {&#10;                Log.e(TAG, &quot;Error: &quot; + t.getMessage());&#10;                callback.onError(&quot;Error de conexión: &quot; + t.getMessage());&#10;            }&#10;        });&#10;    }&#10;&#10;    // Obtener mis publicaciones&#10;    public void getMyPosts(String token, PostsCallback callback) {&#10;        apiService.getMyPosts(&quot;Bearer &quot; + token).enqueue(new Callback&lt;MyPostsResponse&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;MyPostsResponse&gt; call, Response&lt;MyPostsResponse&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    callback.onSuccess(response.body().getPosts());&#10;                } else {&#10;                    callback.onError(&quot;Error al obtener tus publicaciones&quot;);&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;MyPostsResponse&gt; call, Throwable t) {&#10;                Log.e(TAG, &quot;Error: &quot; + t.getMessage());&#10;                callback.onError(&quot;Error de conexión: &quot; + t.getMessage());&#10;            }&#10;        });&#10;    }&#10;&#10;    // Crear una publicación&#10;    public void createPost(String token, String text, String url, CreatePostCallback callback) {&#10;        CreatePostRequest request = new CreatePostRequest(text, url);&#10;        apiService.createPost(&quot;Bearer &quot; + token, request).enqueue(new Callback&lt;CreatePostResponse&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;CreatePostResponse&gt; call, Response&lt;CreatePostResponse&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    callback.onSuccess(response.body().getPost());&#10;                } else {&#10;                    callback.onError(&quot;Error al crear la publicación&quot;);&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;CreatePostResponse&gt; call, Throwable t) {&#10;                Log.e(TAG, &quot;Error: &quot; + t.getMessage());&#10;                callback.onError(&quot;Error de conexión: &quot; + t.getMessage());&#10;            }&#10;        });&#10;    }&#10;&#10;    // Eliminar una publicación&#10;    public void deletePost(String token, int postId, DeletePostCallback callback) {&#10;        apiService.deletePost(&quot;Bearer &quot; + token, postId).enqueue(new Callback&lt;Void&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;Void&gt; call, Response&lt;Void&gt; response) {&#10;                if (response.isSuccessful()) {&#10;                    callback.onSuccess();&#10;                } else {&#10;                    callback.onError(&quot;Error al eliminar la publicación&quot;);&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;Void&gt; call, Throwable t) {&#10;                callback.onError(&quot;Error de conexión: &quot; + t.getMessage());&#10;            }&#10;        });&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.sportconnection.repository;&#13;&#10;&#13;&#10;import android.util.Log;&#13;&#10;&#13;&#10;import com.example.sportconnection.model.CreatePostRequest;&#13;&#10;import com.example.sportconnection.model.CreatePostResponse;&#13;&#10;import com.example.sportconnection.model.MyPostsResponse;&#13;&#10;import com.example.sportconnection.model.Post;&#13;&#10;import com.example.sportconnection.network.ApiClient;&#13;&#10;import com.example.sportconnection.network.ApiService;&#13;&#10;&#13;&#10;import java.util.List;&#13;&#10;&#13;&#10;import retrofit2.Call;&#13;&#10;import retrofit2.Callback;&#13;&#10;import retrofit2.Response;&#13;&#10;&#13;&#10;public class PostRepository {&#13;&#10;    private static final String TAG = &quot;PostRepository&quot;;&#13;&#10;    private final ApiService apiService;&#13;&#10;&#13;&#10;    public PostRepository() {&#13;&#10;        this.apiService = ApiClient.getApiService();&#13;&#10;    }&#13;&#10;&#13;&#10;    public interface PostsCallback {&#13;&#10;        void onSuccess(List&lt;Post&gt; posts);&#13;&#10;        void onError(String message);&#13;&#10;    }&#13;&#10;&#13;&#10;    public interface CreatePostCallback {&#13;&#10;        void onSuccess(Post post);&#13;&#10;        void onError(String message);&#13;&#10;    }&#13;&#10;&#13;&#10;    public interface DeletePostCallback {&#13;&#10;        void onSuccess();&#13;&#10;        void onError(String message);&#13;&#10;    }&#13;&#10;&#13;&#10;    // Obtener todas las publicaciones&#13;&#10;    public void getAllPosts(PostsCallback callback) {&#13;&#10;        apiService.getAllPosts().enqueue(new Callback&lt;List&lt;Post&gt;&gt;() {&#13;&#10;            @Override&#13;&#10;            public void onResponse(Call&lt;List&lt;Post&gt;&gt; call, Response&lt;List&lt;Post&gt;&gt; response) {&#13;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#13;&#10;                    callback.onSuccess(response.body());&#13;&#10;                } else {&#13;&#10;                    callback.onError(&quot;Error al obtener las publicaciones&quot;);&#13;&#10;                }&#13;&#10;            }&#13;&#10;&#13;&#10;            @Override&#13;&#10;            public void onFailure(Call&lt;List&lt;Post&gt;&gt; call, Throwable t) {&#13;&#10;                Log.e(TAG, &quot;Error: &quot; + t.getMessage());&#13;&#10;                callback.onError(&quot;Error de conexión: &quot; + t.getMessage());&#13;&#10;            }&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    // Obtener mis publicaciones&#13;&#10;    public void getMyPosts(String token, PostsCallback callback) {&#13;&#10;        apiService.getMyPosts(&quot;Bearer &quot; + token).enqueue(new Callback&lt;MyPostsResponse&gt;() {&#13;&#10;            @Override&#13;&#10;            public void onResponse(Call&lt;MyPostsResponse&gt; call, Response&lt;MyPostsResponse&gt; response) {&#13;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#13;&#10;                    callback.onSuccess(response.body().getPosts());&#13;&#10;                } else {&#13;&#10;                    callback.onError(&quot;Error al obtener tus publicaciones&quot;);&#13;&#10;                }&#13;&#10;            }&#13;&#10;&#13;&#10;            @Override&#13;&#10;            public void onFailure(Call&lt;MyPostsResponse&gt; call, Throwable t) {&#13;&#10;                Log.e(TAG, &quot;Error: &quot; + t.getMessage());&#13;&#10;                callback.onError(&quot;Error de conexión: &quot; + t.getMessage());&#13;&#10;            }&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    // Crear una publicación&#13;&#10;    public void createPost(String token, String text, String url, CreatePostCallback callback) {&#13;&#10;        CreatePostRequest request = new CreatePostRequest(text, url);&#13;&#10;        apiService.createPost(&quot;Bearer &quot; + token, request).enqueue(new Callback&lt;CreatePostResponse&gt;() {&#13;&#10;            @Override&#13;&#10;            public void onResponse(Call&lt;CreatePostResponse&gt; call, Response&lt;CreatePostResponse&gt; response) {&#13;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#13;&#10;                    callback.onSuccess(response.body().getPost());&#13;&#10;                } else {&#13;&#10;                    callback.onError(&quot;Error al crear la publicación&quot;);&#13;&#10;                }&#13;&#10;            }&#13;&#10;&#13;&#10;            @Override&#13;&#10;            public void onFailure(Call&lt;CreatePostResponse&gt; call, Throwable t) {&#13;&#10;                Log.e(TAG, &quot;Error: &quot; + t.getMessage());&#13;&#10;                callback.onError(&quot;Error de conexión: &quot; + t.getMessage());&#13;&#10;            }&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    // Eliminar una publicación&#13;&#10;    public void deletePost(String token, int postId, DeletePostCallback callback) {&#13;&#10;        apiService.deletePost(&quot;Bearer &quot; + token, postId).enqueue(new Callback&lt;Void&gt;() {&#13;&#10;            @Override&#13;&#10;            public void onResponse(Call&lt;Void&gt; call, Response&lt;Void&gt; response) {&#13;&#10;                if (response.isSuccessful()) {&#13;&#10;                    callback.onSuccess();&#13;&#10;                } else {&#13;&#10;                    callback.onError(&quot;Error al eliminar la publicación&quot;);&#13;&#10;                }&#13;&#10;            }&#13;&#10;&#13;&#10;            @Override&#10;            public void onFailure(Call&lt;Void&gt; call, Throwable t) {&#10;                callback.onError(&quot;Error de conexión: &quot; + t.getMessage());&#10;            }&#10;        });&#10;    }&#13;&#10;}&#13;&#10;&#13;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/repository/SubscriptionRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/sportconnection/repository/SubscriptionRepository.java" />
              <option name="originalContent" value="package com.example.sportconnection.repository;&#10;&#10;import com.example.sportconnection.model.CheckoutSessionResponse;&#10;import com.example.sportconnection.model.CreateCheckoutRequest;&#10;import com.example.sportconnection.model.SubscriptionPlan;&#10;import com.example.sportconnection.model.SubscriptionStatus;&#10;import com.example.sportconnection.network.ApiClient;&#10;import com.example.sportconnection.network.ApiService;&#10;&#10;import java.util.List;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;&#10;public class SubscriptionRepository {&#10;&#10;    private final ApiService apiService;&#10;&#10;    public SubscriptionRepository() {&#10;        this.apiService = ApiClient.getClient().create(ApiService.class);&#10;    }&#10;&#10;    // Obtener planes de suscripción disponibles&#10;    public void getSubscriptionPlans(String token, Callback&lt;List&lt;SubscriptionPlan&gt;&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;        Call&lt;List&lt;SubscriptionPlan&gt;&gt; call = apiService.getSubscriptionPlans(authHeader);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Crear sesión de checkout de Stripe&#10;    public void createCheckoutSession(String token, int planId, Callback&lt;CheckoutSessionResponse&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;        CreateCheckoutRequest request = new CreateCheckoutRequest(planId);&#10;        Call&lt;CheckoutSessionResponse&gt; call = apiService.createCheckoutSession(authHeader, request);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Obtener estado de suscripción del usuario&#10;    public void getSubscriptionStatus(String token, Callback&lt;SubscriptionStatus&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;        Call&lt;SubscriptionStatus&gt; call = apiService.getSubscriptionStatus(authHeader);&#10;        call.enqueue(callback);&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.sportconnection.repository;&#10;&#10;import com.example.sportconnection.model.CheckoutSessionResponse;&#10;import com.example.sportconnection.model.CreateCheckoutRequest;&#10;import com.example.sportconnection.model.SubscriptionPlan;&#10;import com.example.sportconnection.model.SubscriptionStatus;&#10;import com.example.sportconnection.network.ApiClient;&#10;import com.example.sportconnection.network.ApiService;&#10;&#10;import java.util.List;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;&#10;public class SubscriptionRepository {&#10;&#10;    private final ApiService apiService;&#10;&#10;    public SubscriptionRepository() {&#10;        this.apiService = ApiClient.getClient().create(ApiService.class);&#10;    }&#10;&#10;    // Obtener planes de suscripción disponibles&#10;    public void getSubscriptionPlans(String token, Callback&lt;List&lt;SubscriptionPlan&gt;&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;        Call&lt;List&lt;SubscriptionPlan&gt;&gt; call = apiService.getSubscriptionPlans(authHeader);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Crear sesión de checkout de Stripe&#10;    public void createCheckoutSession(String token, int planId, Callback&lt;CheckoutSessionResponse&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;        CreateCheckoutRequest request = new CreateCheckoutRequest(planId);&#10;        Call&lt;CheckoutSessionResponse&gt; call = apiService.createCheckoutSession(authHeader, request);&#10;        call.enqueue(callback);&#10;    }&#10;&#10;    // Obtener estado de suscripción del usuario&#10;    public void getSubscriptionStatus(String token, Callback&lt;SubscriptionStatus&gt; callback) {&#10;        String authHeader = &quot;Bearer &quot; + token;&#10;        Call&lt;SubscriptionStatus&gt; call = apiService.getSubscriptionStatus(authHeader);&#10;        call.enqueue(callback);&#10;    }&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/layout/activity_create_post.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/layout/activity_create_post.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;ScrollView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;match_parent&quot;&#10;    android:fillViewport=&quot;true&quot;&gt;&#10;&#10;&lt;androidx.constraintlayout.widget.ConstraintLayout&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;wrap_content&quot;&#10;    android:padding=&quot;25dp&quot;&gt;&#10;&#10;    &lt;!-- Barra superior --&gt;&#10;    &lt;LinearLayout&#10;        android:id=&quot;@+id/topBar&quot;&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:orientation=&quot;horizontal&quot;&#10;        android:gravity=&quot;center_vertical&quot;&#10;        app:layout_constraintTop_toTopOf=&quot;parent&quot;&gt;&#10;&#10;        &lt;ImageButton&#10;            android:id=&quot;@+id/btnClose&quot;&#10;            android:layout_width=&quot;48dp&quot;&#10;            android:layout_height=&quot;48dp&quot;&#10;            android:background=&quot;?attr/selectableItemBackgroundBorderless&quot;&#10;            android:src=&quot;@android:drawable/ic_menu_close_clear_cancel&quot;&#10;            android:contentDescription=&quot;Cerrar&quot; /&gt;&#10;&#10;        &lt;TextView&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_weight=&quot;1&quot;&#10;            android:text=&quot;Nueva publicación&quot;&#10;            android:textSize=&quot;20sp&quot;&#10;            android:textStyle=&quot;bold&quot;&#10;            android:gravity=&quot;center&quot; /&gt;&#10;&#10;        &lt;Button&#10;            android:id=&quot;@+id/btnPublish&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;Publicar&quot;&#10;            android:textAllCaps=&quot;false&quot;&#10;            style=&quot;@style/Widget.Material3.Button&quot; /&gt;&#10;    &lt;/LinearLayout&gt;&#10;&#10;    &lt;!-- Campo de texto para el contenido --&gt;&#10;    &lt;com.google.android.material.textfield.TextInputLayout&#10;        android:id=&quot;@+id/textInputLayout&quot;&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;0dp&quot;&#10;        android:layout_marginTop=&quot;14dp&quot;&#10;        android:layout_marginBottom=&quot;14dp&quot;&#10;        app:layout_constraintTop_toBottomOf=&quot;@id/topBar&quot;&#10;        app:layout_constraintBottom_toTopOf=&quot;@id/urlInputLayout&quot;&#10;        app:hintEnabled=&quot;false&quot;&gt;&#10;&#10;        &lt;com.google.android.material.textfield.TextInputEditText&#10;            android:id=&quot;@+id/editTextContent&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;match_parent&quot;&#10;            android:hint=&quot;¿Qué está pasando?&quot;&#10;            android:gravity=&quot;top|start&quot;&#10;            android:inputType=&quot;textMultiLine|textCapSentences&quot;&#10;            android:maxLength=&quot;500&quot;&#10;            android:background=&quot;@null&quot;&#10;            android:padding=&quot;8dp&quot; /&gt;&#10;    &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;    &lt;!-- Campo de URL (opcional) --&gt;&#10;    &lt;com.google.android.material.textfield.TextInputLayout&#10;        android:id=&quot;@+id/urlInputLayout&quot;&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:layout_marginBottom=&quot;16dp&quot;&#10;        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;&#10;        app:hintEnabled=&quot;true&quot;&#10;        style=&quot;@style/Widget.Material3.TextInputLayout.OutlinedBox&quot;&gt;&#10;&#10;        &lt;com.google.android.material.textfield.TextInputEditText&#10;            android:id=&quot;@+id/editTextUrl&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:hint=&quot;URL (opcional)&quot;&#10;            android:inputType=&quot;textUri&quot;&#10;            android:maxLines=&quot;1&quot; /&gt;&#10;    &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;&#10;&#10;&lt;/ScrollView&gt;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;ScrollView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;match_parent&quot;&#10;    android:fillViewport=&quot;true&quot;&gt;&#10;&#10;&lt;androidx.constraintlayout.widget.ConstraintLayout&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;wrap_content&quot;&#10;    android:padding=&quot;25dp&quot;&gt;&#10;&#10;    &lt;!-- Barra superior --&gt;&#10;    &lt;LinearLayout&#10;        android:id=&quot;@+id/topBar&quot;&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:orientation=&quot;horizontal&quot;&#10;        android:gravity=&quot;center_vertical&quot;&#10;        app:layout_constraintTop_toTopOf=&quot;parent&quot;&gt;&#10;&#10;        &lt;ImageButton&#10;            android:id=&quot;@+id/btnClose&quot;&#10;            android:layout_width=&quot;48dp&quot;&#10;            android:layout_height=&quot;48dp&quot;&#10;            android:background=&quot;?attr/selectableItemBackgroundBorderless&quot;&#10;            android:src=&quot;@android:drawable/ic_menu_close_clear_cancel&quot;&#10;            android:contentDescription=&quot;Cerrar&quot; /&gt;&#10;&#10;        &lt;TextView&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_weight=&quot;1&quot;&#10;            android:text=&quot;Nueva publicación&quot;&#10;            android:textSize=&quot;20sp&quot;&#10;            android:textStyle=&quot;bold&quot;&#10;            android:gravity=&quot;center&quot; /&gt;&#10;&#10;        &lt;Button&#10;            android:id=&quot;@+id/btnPublish&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;Publicar&quot;&#10;            android:textAllCaps=&quot;false&quot;&#10;            style=&quot;@style/Widget.Material3.Button&quot; /&gt;&#10;    &lt;/LinearLayout&gt;&#10;&#10;    &lt;!-- Campo de texto para el contenido --&gt;&#10;    &lt;com.google.android.material.textfield.TextInputLayout&#10;        android:id=&quot;@+id/textInputLayout&quot;&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;0dp&quot;&#10;        android:layout_marginTop=&quot;14dp&quot;&#10;        android:layout_marginBottom=&quot;14dp&quot;&#10;        app:layout_constraintTop_toBottomOf=&quot;@id/topBar&quot;&#10;        app:layout_constraintBottom_toTopOf=&quot;@id/urlInputLayout&quot;&#10;        app:hintEnabled=&quot;false&quot;&gt;&#10;&#10;        &lt;com.google.android.material.textfield.TextInputEditText&#10;            android:id=&quot;@+id/editTextContent&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;match_parent&quot;&#10;            android:hint=&quot;¿Qué está pasando?&quot;&#10;            android:gravity=&quot;top|start&quot;&#10;            android:inputType=&quot;textMultiLine|textCapSentences&quot;&#10;            android:maxLength=&quot;500&quot;&#10;            android:background=&quot;@null&quot;&#10;            android:padding=&quot;8dp&quot; /&gt;&#10;    &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;    &lt;!-- Campo de URL (opcional) --&gt;&#10;    &lt;com.google.android.material.textfield.TextInputLayout&#10;        android:id=&quot;@+id/urlInputLayout&quot;&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:layout_marginBottom=&quot;16dp&quot;&#10;        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;&#10;        app:hintEnabled=&quot;true&quot;&#10;        style=&quot;@style/Widget.Material3.TextInputLayout.OutlinedBox&quot;&gt;&#10;&#10;        &lt;com.google.android.material.textfield.TextInputEditText&#10;            android:id=&quot;@+id/editTextUrl&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:hint=&quot;URL (opcional)&quot;&#10;            android:inputType=&quot;textUri&quot;&#10;            android:maxLines=&quot;1&quot; /&gt;&#10;    &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;&#10;&#10;&lt;/ScrollView&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/layout/activity_home.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/layout/activity_home.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;match_parent&quot;&#10;    tools:context=&quot;.HomeActivity&quot;&gt;&#10;&#10;    &lt;FrameLayout&#10;        android:id=&quot;@+id/fragmentContainer&quot;&#10;        android:layout_width=&quot;0dp&quot;&#10;        android:layout_height=&quot;0dp&quot;&#10;        app:layout_constraintBottom_toTopOf=&quot;@id/bottomNavigation&quot;&#10;        app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;        app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;        app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;&#10;&#10;    &lt;!-- Overlay de carga para bloquear navegación --&gt;&#10;    &lt;ProgressBar&#10;        android:id=&quot;@+id/loadingOverlay&quot;&#10;        android:layout_width=&quot;wrap_content&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:visibility=&quot;gone&quot;&#10;        android:elevation=&quot;10dp&quot;&#10;        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;&#10;        app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;        app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;        app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;&#10;&#10;    &lt;com.google.android.material.bottomnavigation.BottomNavigationView&#10;        android:id=&quot;@+id/bottomNavigation&quot;&#10;        android:layout_width=&quot;0dp&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:background=&quot;?android:attr/windowBackground&quot;&#10;        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;&#10;        app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;        app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;        app:menu=&quot;@menu/bottom_nav_menu&quot; /&gt;&#10;&#10;&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;&#10;&#10;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#13;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#13;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&#13;&#10;    android:layout_width=&quot;match_parent&quot;&#13;&#10;    android:layout_height=&quot;match_parent&quot;&#13;&#10;    tools:context=&quot;.HomeActivity&quot;&gt;&#13;&#10;&#13;&#10;    &lt;FrameLayout&#10;        android:id=&quot;@+id/fragmentContainer&quot;&#10;        android:layout_width=&quot;0dp&quot;&#10;        android:layout_height=&quot;0dp&quot;&#10;        app:layout_constraintBottom_toTopOf=&quot;@id/bottomNavigation&quot;&#10;        app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;        app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;        app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;&#10;&#10;    &lt;!-- Overlay de carga para bloquear navegación --&gt;&#10;    &lt;ProgressBar&#10;        android:id=&quot;@+id/loadingOverlay&quot;&#10;        android:layout_width=&quot;wrap_content&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:visibility=&quot;gone&quot;&#10;        android:elevation=&quot;10dp&quot;&#10;        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;&#10;        app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;        app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;        app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;&#10;&#10;    &lt;com.google.android.material.bottomnavigation.BottomNavigationView&#13;&#10;        android:id=&quot;@+id/bottomNavigation&quot;&#13;&#10;        android:layout_width=&quot;0dp&quot;&#13;&#10;        android:layout_height=&quot;wrap_content&quot;&#13;&#10;        android:background=&quot;?android:attr/windowBackground&quot;&#13;&#10;        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;&#13;&#10;        app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#13;&#10;        app:layout_constraintStart_toStartOf=&quot;parent&quot;&#13;&#10;        app:menu=&quot;@menu/bottom_nav_menu&quot; /&gt;&#13;&#10;&#13;&#10;&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;&#13;&#10;&#13;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/layout/activity_profile_form.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/layout/activity_profile_form.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;ScrollView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;match_parent&quot;&#10;    android:fillViewport=&quot;true&quot;&#10;    tools:context=&quot;.ProfileFormActivity&quot;&gt;&#10;&#10;    &lt;androidx.constraintlayout.widget.ConstraintLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:padding=&quot;24dp&quot;&gt;&#10;&#10;        &lt;TextView&#10;            android:id=&quot;@+id/titleProfileForm&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;Perfil de Atleta&quot;&#10;            android:textSize=&quot;24sp&quot;&#10;            android:textStyle=&quot;bold&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextName&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;24dp&quot;&#10;            android:hint=&quot;Nombre&quot;&#10;            android:inputType=&quot;textPersonName&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/titleProfileForm&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextLastName&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Apellido&quot;&#10;            android:inputType=&quot;textPersonName&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextName&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextBirthdate&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Fecha de nacimiento (DD/MM/AAAA)&quot;&#10;            android:inputType=&quot;none&quot;&#10;            android:focusable=&quot;false&quot;&#10;            android:focusableInTouchMode=&quot;false&quot;&#10;            android:clickable=&quot;true&quot;&#10;            android:drawableEnd=&quot;@android:drawable/ic_menu_today&quot;&#10;            android:drawablePadding=&quot;8dp&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextLastName&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextHeight&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Altura (cm)&quot;&#10;            android:inputType=&quot;numberDecimal&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextBirthdate&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextWeight&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Peso (kg)&quot;&#10;            android:inputType=&quot;numberDecimal&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextHeight&quot; /&gt;&#10;&#10;        &lt;TextView&#10;            android:id=&quot;@+id/labelLocation&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:text=&quot;Ubicación&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextWeight&quot; /&gt;&#10;&#10;        &lt;Spinner&#10;            android:id=&quot;@+id/spinnerLocation&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;48dp&quot;&#10;            android:layout_marginTop=&quot;4dp&quot;&#10;            android:minHeight=&quot;48dp&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/labelLocation&quot; /&gt;&#10;&#10;        &lt;TextView&#10;            android:id=&quot;@+id/labelSport&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:text=&quot;Deporte&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/spinnerLocation&quot; /&gt;&#10;&#10;        &lt;Spinner&#10;            android:id=&quot;@+id/spinnerSport&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;48dp&quot;&#10;            android:layout_marginTop=&quot;4dp&quot;&#10;            android:minHeight=&quot;48dp&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/labelSport&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextPhone&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Número de teléfono&quot;&#10;            android:inputType=&quot;phone&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/spinnerSport&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextInstagram&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Usuario de Instagram (Opcional)&quot;&#10;            android:inputType=&quot;text&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextPhone&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextTwitter&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Usuario de X (Twitter) (Opcional)&quot;&#10;            android:inputType=&quot;text&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextInstagram&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextDescription&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Descripción del perfil&quot;&#10;            android:inputType=&quot;textMultiLine&quot;&#10;            android:minLines=&quot;3&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextTwitter&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextAgency&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Agencia (Opcional)&quot;&#10;            android:inputType=&quot;text&quot;&#10;            android:visibility=&quot;gone&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextDescription&quot; /&gt;&#10;&#10;        &lt;Button&#10;            android:id=&quot;@+id/buttonComplete&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;24dp&quot;&#10;            android:layout_marginBottom=&quot;24dp&quot;&#10;            android:text=&quot;Completar Registro&quot;&#10;            app:layout_constraintBottom_toBottomOf=&quot;parent&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextAgency&quot; /&gt;&#10;&#10;    &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;&#10;&lt;/ScrollView&gt;&#10;&#10;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;ScrollView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;match_parent&quot;&#10;    android:fillViewport=&quot;true&quot;&#10;    tools:context=&quot;.ProfileFormActivity&quot;&gt;&#10;&#10;    &lt;androidx.constraintlayout.widget.ConstraintLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:padding=&quot;24dp&quot;&gt;&#10;&#10;        &lt;TextView&#10;            android:id=&quot;@+id/titleProfileForm&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;Perfil de Atleta&quot;&#10;            android:textSize=&quot;24sp&quot;&#10;            android:textStyle=&quot;bold&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextName&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;24dp&quot;&#10;            android:hint=&quot;Nombre&quot;&#10;            android:inputType=&quot;textPersonName&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/titleProfileForm&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextLastName&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Apellido&quot;&#10;            android:inputType=&quot;textPersonName&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextName&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextBirthdate&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Fecha de nacimiento (DD/MM/AAAA)&quot;&#10;            android:inputType=&quot;none&quot;&#10;            android:focusable=&quot;false&quot;&#10;            android:focusableInTouchMode=&quot;false&quot;&#10;            android:clickable=&quot;true&quot;&#10;            android:drawableEnd=&quot;@android:drawable/ic_menu_today&quot;&#10;            android:drawablePadding=&quot;8dp&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextLastName&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextHeight&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Altura (cm)&quot;&#10;            android:inputType=&quot;numberDecimal&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextBirthdate&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextWeight&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Peso (kg)&quot;&#10;            android:inputType=&quot;numberDecimal&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextHeight&quot; /&gt;&#10;&#10;        &lt;TextView&#10;            android:id=&quot;@+id/labelLocation&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:text=&quot;Ubicación&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextWeight&quot; /&gt;&#10;&#10;        &lt;Spinner&#10;            android:id=&quot;@+id/spinnerLocation&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;48dp&quot;&#10;            android:layout_marginTop=&quot;4dp&quot;&#10;            android:minHeight=&quot;48dp&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/labelLocation&quot; /&gt;&#10;&#10;        &lt;TextView&#10;            android:id=&quot;@+id/labelSport&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:text=&quot;Deporte&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/spinnerLocation&quot; /&gt;&#10;&#10;        &lt;Spinner&#10;            android:id=&quot;@+id/spinnerSport&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;48dp&quot;&#10;            android:layout_marginTop=&quot;4dp&quot;&#10;            android:minHeight=&quot;48dp&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/labelSport&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextPhone&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Número de teléfono&quot;&#10;            android:inputType=&quot;phone&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/spinnerSport&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextInstagram&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Usuario de Instagram (Opcional)&quot;&#10;            android:inputType=&quot;text&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextPhone&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextTwitter&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Usuario de X (Twitter) (Opcional)&quot;&#10;            android:inputType=&quot;text&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextInstagram&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextDescription&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Descripción del perfil&quot;&#10;            android:inputType=&quot;textMultiLine&quot;&#10;            android:minLines=&quot;3&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextTwitter&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/editTextAgency&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;16dp&quot;&#10;            android:hint=&quot;Agencia (Opcional)&quot;&#10;            android:inputType=&quot;text&quot;&#10;            android:visibility=&quot;gone&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextDescription&quot; /&gt;&#10;&#10;        &lt;Button&#10;            android:id=&quot;@+id/buttonComplete&quot;&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;24dp&quot;&#10;            android:layout_marginBottom=&quot;24dp&quot;&#10;            android:text=&quot;Completar Registro&quot;&#10;            app:layout_constraintBottom_toBottomOf=&quot;parent&quot;&#10;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;&#10;            app:layout_constraintStart_toStartOf=&quot;parent&quot;&#10;            app:layout_constraintTop_toBottomOf=&quot;@+id/editTextAgency&quot; /&gt;&#10;&#10;    &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;&#10;&lt;/ScrollView&gt;&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/layout/item_post.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/layout/item_post.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;com.google.android.material.card.MaterialCardView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;wrap_content&quot;&#10;    android:layout_margin=&quot;8dp&quot;&#10;    app:cardCornerRadius=&quot;12dp&quot;&#10;    app:cardElevation=&quot;2dp&quot;&#10;    app:strokeWidth=&quot;0dp&quot;&gt;&#10;&#10;    &lt;LinearLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:orientation=&quot;vertical&quot;&#10;        android:padding=&quot;16dp&quot;&gt;&#10;&#10;        &lt;!-- Cabecera con info del usuario --&gt;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&#10;            android:gravity=&quot;center_vertical&quot;&gt;&#10;&#10;            &lt;com.google.android.material.imageview.ShapeableImageView&#10;                android:id=&quot;@+id/userAvatar&quot;&#10;                android:layout_width=&quot;40dp&quot;&#10;                android:layout_height=&quot;40dp&quot;&#10;                android:scaleType=&quot;centerCrop&quot;&#10;                android:src=&quot;@drawable/ic_profile&quot;&#10;                android:contentDescription=&quot;Avatar del usuario&quot;&#10;                app:shapeAppearanceOverlay=&quot;@style/CircleImageView&quot;&#10;                app:strokeWidth=&quot;1dp&quot;&#10;                app:strokeColor=&quot;?attr/colorPrimary&quot; /&gt;&#10;&#10;            &lt;LinearLayout&#10;                android:layout_width=&quot;0dp&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_weight=&quot;1&quot;&#10;                android:layout_marginStart=&quot;12dp&quot;&#10;                android:orientation=&quot;vertical&quot;&gt;&#10;&#10;                &lt;TextView&#10;                    android:id=&quot;@+id/userName&quot;&#10;                    android:layout_width=&quot;wrap_content&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:text=&quot;Usuario&quot;&#10;                    android:textStyle=&quot;bold&quot;&#10;                    android:textSize=&quot;16sp&quot;&#10;                    android:textColor=&quot;?android:attr/textColorPrimary&quot; /&gt;&#10;&#10;                &lt;TextView&#10;                    android:id=&quot;@+id/postDate&quot;&#10;                    android:layout_width=&quot;wrap_content&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:text=&quot;Hace 2 horas&quot;&#10;                    android:textSize=&quot;12sp&quot;&#10;                    android:textColor=&quot;?android:attr/textColorSecondary&quot; /&gt;&#10;            &lt;/LinearLayout&gt;&#10;&#10;            &lt;ImageButton&#10;                android:id=&quot;@+id/btnDeletePost&quot;&#10;                android:layout_width=&quot;40dp&quot;&#10;                android:layout_height=&quot;40dp&quot;&#10;                android:background=&quot;?attr/selectableItemBackgroundBorderless&quot;&#10;                android:src=&quot;@android:drawable/ic_menu_delete&quot;&#10;                android:contentDescription=&quot;Eliminar publicación&quot;&#10;                android:visibility=&quot;gone&quot; /&gt;&#10;        &lt;/LinearLayout&gt;&#10;&#10;        &lt;!-- Contenido del post --&gt;&#10;        &lt;TextView&#10;            android:id=&quot;@+id/postText&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;12dp&quot;&#10;            android:text=&quot;Contenido de la publicación&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            android:textColor=&quot;?android:attr/textColorPrimary&quot; /&gt;&#10;&#10;        &lt;!-- URL del post (opcional) --&gt;&#10;        &lt;TextView&#10;            android:id=&quot;@+id/postUrl&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginTop=&quot;8dp&quot;&#10;            android:text=&quot;https://example.com&quot;&#10;            android:textSize=&quot;12sp&quot;&#10;            android:textColor=&quot;@android:color/holo_blue_dark&quot;&#10;            android:autoLink=&quot;web&quot;&#10;            android:visibility=&quot;gone&quot; /&gt;&#10;    &lt;/LinearLayout&gt;&#10;&lt;/com.google.android.material.card.MaterialCardView&gt;&#10;&#10;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;com.google.android.material.card.MaterialCardView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#13;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#13;&#10;    android:layout_width=&quot;match_parent&quot;&#13;&#10;    android:layout_height=&quot;wrap_content&quot;&#13;&#10;    android:layout_margin=&quot;8dp&quot;&#13;&#10;    app:cardCornerRadius=&quot;12dp&quot;&#13;&#10;    app:cardElevation=&quot;2dp&quot;&#13;&#10;    app:strokeWidth=&quot;0dp&quot;&gt;&#13;&#10;&#13;&#10;    &lt;LinearLayout&#13;&#10;        android:layout_width=&quot;match_parent&quot;&#13;&#10;        android:layout_height=&quot;wrap_content&quot;&#13;&#10;        android:orientation=&quot;vertical&quot;&#13;&#10;        android:padding=&quot;16dp&quot;&gt;&#13;&#10;&#13;&#10;        &lt;!-- Cabecera con info del usuario --&gt;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&#10;            android:gravity=&quot;center_vertical&quot;&gt;&#10;&#10;            &lt;com.google.android.material.imageview.ShapeableImageView&#10;                android:id=&quot;@+id/userAvatar&quot;&#10;                android:layout_width=&quot;40dp&quot;&#10;                android:layout_height=&quot;40dp&quot;&#10;                android:scaleType=&quot;centerCrop&quot;&#10;                android:src=&quot;@drawable/ic_profile&quot;&#10;                android:contentDescription=&quot;Avatar del usuario&quot;&#10;                app:shapeAppearanceOverlay=&quot;@style/CircleImageView&quot;&#10;                app:strokeWidth=&quot;1dp&quot;&#10;                app:strokeColor=&quot;?attr/colorPrimary&quot; /&gt;&#10;&#10;            &lt;LinearLayout&#10;                android:layout_width=&quot;0dp&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_weight=&quot;1&quot;&#10;                android:layout_marginStart=&quot;12dp&quot;&#10;                android:orientation=&quot;vertical&quot;&gt;&#10;&#10;                &lt;TextView&#10;                    android:id=&quot;@+id/userName&quot;&#10;                    android:layout_width=&quot;wrap_content&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:text=&quot;Usuario&quot;&#10;                    android:textStyle=&quot;bold&quot;&#10;                    android:textSize=&quot;16sp&quot;&#10;                    android:textColor=&quot;?android:attr/textColorPrimary&quot; /&gt;&#10;&#10;                &lt;TextView&#10;                    android:id=&quot;@+id/postDate&quot;&#10;                    android:layout_width=&quot;wrap_content&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:text=&quot;Hace 2 horas&quot;&#10;                    android:textSize=&quot;12sp&quot;&#10;                    android:textColor=&quot;?android:attr/textColorSecondary&quot; /&gt;&#10;            &lt;/LinearLayout&gt;&#13;&#10;&#13;&#10;            &lt;ImageButton&#13;&#10;                android:id=&quot;@+id/btnDeletePost&quot;&#13;&#10;                android:layout_width=&quot;40dp&quot;&#13;&#10;                android:layout_height=&quot;40dp&quot;&#13;&#10;                android:background=&quot;?attr/selectableItemBackgroundBorderless&quot;&#13;&#10;                android:src=&quot;@android:drawable/ic_menu_delete&quot;&#13;&#10;                android:contentDescription=&quot;Eliminar publicación&quot;&#13;&#10;                android:visibility=&quot;gone&quot; /&gt;&#13;&#10;        &lt;/LinearLayout&gt;&#13;&#10;&#13;&#10;        &lt;!-- Contenido del post --&gt;&#13;&#10;        &lt;TextView&#13;&#10;            android:id=&quot;@+id/postText&quot;&#13;&#10;            android:layout_width=&quot;match_parent&quot;&#13;&#10;            android:layout_height=&quot;wrap_content&quot;&#13;&#10;            android:layout_marginTop=&quot;12dp&quot;&#13;&#10;            android:text=&quot;Contenido de la publicación&quot;&#13;&#10;            android:textSize=&quot;14sp&quot;&#13;&#10;            android:textColor=&quot;?android:attr/textColorPrimary&quot; /&gt;&#13;&#10;&#13;&#10;        &lt;!-- URL del post (opcional) --&gt;&#13;&#10;        &lt;TextView&#13;&#10;            android:id=&quot;@+id/postUrl&quot;&#13;&#10;            android:layout_width=&quot;match_parent&quot;&#13;&#10;            android:layout_height=&quot;wrap_content&quot;&#13;&#10;            android:layout_marginTop=&quot;8dp&quot;&#13;&#10;            android:text=&quot;https://example.com&quot;&#13;&#10;            android:textSize=&quot;12sp&quot;&#13;&#10;            android:textColor=&quot;@android:color/holo_blue_dark&quot;&#13;&#10;            android:autoLink=&quot;web&quot;&#13;&#10;            android:visibility=&quot;gone&quot; /&gt;&#13;&#10;    &lt;/LinearLayout&gt;&#13;&#10;&lt;/com.google.android.material.card.MaterialCardView&gt;&#13;&#10;&#13;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/values/themes.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/values/themes.xml" />
              <option name="originalContent" value="&lt;resources xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;&#10;    &lt;!-- Base application theme. --&gt;&#10;    &lt;style name=&quot;Base.Theme.SportConnection&quot; parent=&quot;Theme.Material3.DayNight.NoActionBar&quot;&gt;&#10;        &lt;!-- Customize your light theme here. --&gt;&#10;        &lt;!-- &lt;item name=&quot;colorPrimary&quot;&gt;@color/my_light_primary&lt;/item&gt; --&gt;&#10;    &lt;/style&gt;&#10;&#10;    &lt;style name=&quot;Theme.SportConnection&quot; parent=&quot;Base.Theme.SportConnection&quot; /&gt;&#10;&#10;    &lt;!-- Estilo para imagen circular --&gt;&#10;    &lt;style name=&quot;CircleImageView&quot;&gt;&#10;        &lt;item name=&quot;cornerFamily&quot;&gt;rounded&lt;/item&gt;&#10;        &lt;item name=&quot;cornerSize&quot;&gt;50%&lt;/item&gt;&#10;    &lt;/style&gt;&#10;&lt;/resources&gt;" />
              <option name="updatedContent" value="&lt;resources xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;&#10;    &lt;!-- Base application theme. --&gt;&#10;    &lt;style name=&quot;Base.Theme.SportConnection&quot; parent=&quot;Theme.Material3.DayNight.NoActionBar&quot;&gt;&#10;        &lt;!-- Customize your light theme here. --&gt;&#10;        &lt;!-- &lt;item name=&quot;colorPrimary&quot;&gt;@color/my_light_primary&lt;/item&gt; --&gt;&#10;    &lt;/style&gt;&#10;&#10;    &lt;style name=&quot;Theme.SportConnection&quot; parent=&quot;Base.Theme.SportConnection&quot; /&gt;&#10;&#10;    &lt;!-- Estilo para imagen circular --&gt;&#10;    &lt;style name=&quot;CircleImageView&quot;&gt;&#10;        &lt;item name=&quot;cornerFamily&quot;&gt;rounded&lt;/item&gt;&#10;        &lt;item name=&quot;cornerSize&quot;&gt;50%&lt;/item&gt;&#10;    &lt;/style&gt;&#10;&lt;/resources&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>